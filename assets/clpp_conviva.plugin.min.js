/*! @castlabs/prestoplay 5.1.36, 05-02-2020 Copyright (c) 2020 castLabs GmbH, All Rights reserved */

(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define(['clpp'],factory);else if(typeof exports==="object")exports["clpp_conviva"]=factory();else root["clpp_conviva"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="/";return __webpack_require__(0)}({0:function(module,exports,__webpack_require__){module.exports=__webpack_require__(27)},27:function(module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["clpp_conviva"]=t():e["clpp_conviva"]=t()}(this,function(){return webpackJsonpclpp__name_([2],{0:function(e,t,i){var n=i(1),r=i(3),s=i(141),o=i(2),a=i(4).Logger,c=i(11).cl_Ue,u=o.plugins.clpp_conviva,l="clpp.player.plugins.conviva";n.definePlugin(u,t),t.registerPlugin=function(e,t,i){var n=e.cl_Fs,o=r.getSafeValue(n,"plugins.clpp_conviva");c("undefined"==typeof o,"Conviva plugin options not provided"),this.cl_Fn=new a(l),this.cl_Fn.debug("Registering Conviva plugin..."),this.cl_if=new s(i,o,this.cl_Fn);try{this.cl_if.setup()}catch(e){this.cl_Fn.info("Could not setup conviva plugin due to error",e),this.plugin.unregisterPlugin.call(this)}},t.unregisterPlugin=function(){this.cl_Fn.info("Unregistering Conviva plugin..."),this.cl_if&&(this.cl_if.release(),this.cl_if=void 0)}},140:function(e,t,i){var n=i(3),r=i(14),s=i(32),o=function(e,t){r.call(),this.cl_nf=null,this.cl_rf=null,this.cl_sf=new s(e,t),this.cl_af()};o.prototype=new r,o.prototype.constructor=o,o.prototype.cl_af=function(){var e=this,t=o.Payload;this.cl_sf.onPlayerCreated(function(i,n){var r=new t(n,i,null,null);this.cl_rf=i,this.cl_nf=n,e.trigger(o.EVENTS.PLAYER_CREATED,r)}),this.cl_sf.onPlayerLoad(function(i,n){var r=new t(n,i,null,null);this.cl_rf=i,this.cl_nf=n,e.trigger(o.EVENTS.PLAYER_LOAD,r)}),this.cl_sf.onInit(function(){var i=arguments[2],n=arguments[3],r=new t(n,i,null,null);return this.cl_rf=i,this.cl_nf=n,e.trigger(o.EVENTS.PLAYER_TECH_INIT,r),{}}),this.cl_sf.onLoadedMetaData(function(){var i=arguments[3],r=arguments[5],s=n.merge(i,r),a=new t(this.cl_nf,this.cl_rf,{},s);e.trigger(o.EVENTS.LOADED_METADATA,a)}),this.cl_sf.onPlayRequested(function(){var i=new t(this.cl_nf,this.cl_rf,{},null);e.trigger(o.EVENTS.PLAY_REQUESTED,i)}),this.cl_sf.onPlaying(function(){var i=new t(this.cl_nf,this.cl_rf,{},null);e.trigger(o.EVENTS.PLAYING,i)}),this.cl_sf.onPause(function(){var i=new t(this.cl_nf,this.cl_rf,{},null);e.trigger(o.EVENTS.PAUSED,i)}),this.cl_sf.onBitrateChanged(function(){var i=arguments[4],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.BITRATE_CHANGED,n)}),this.cl_sf.onBufferingStarted(function(){e.trigger(o.EVENTS.BUFFERING,{})}),this.cl_sf.onSeekingStarted(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.SEEKING_STARTED,n)}),this.cl_sf.onSeekingEnded(function(){e.trigger(o.EVENTS.SEEKING_ENDED,{})}),this.cl_sf.onStop(function(){e.trigger(o.EVENTS.AD_BREAK_READY,{})}),this.cl_sf.onDestroy(function(){var i=this.cl_nf.ended(),n=new t(this.cl_nf,this.cl_rf,{},null);i?e.trigger(o.EVENTS.ENDED,n):e.trigger(o.EVENTS.PLAYER_DESTROYED,n)}),this.cl_sf.onAdStarted(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.AD_STARTED,n)}),this.cl_sf.onAdPaused(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.AD_PAUSED,n)}),this.cl_sf.onAdResumed(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.AD_RESUMED,n)}),this.cl_sf.onAdClicked(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.AD_CLICKED,n)}),this.cl_sf.onAdFinished(function(){var i=arguments[3],n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.AD_ENDED,n)}),this.cl_sf.onCustomEventRequested(function(){var i={name:arguments[4],attributes:arguments[5]},n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.CUSTOM_EVENT,n)}),this.cl_sf.onAutoplayBlocked(function(){e.trigger(o.EVENTS.AUTOPLAY_BLOCKED,{})}),this.cl_sf.onError(function(){var i=arguments[3]||{},n=new t(this.cl_nf,this.cl_rf,{},null);n.eventValue=i,e.trigger(o.EVENTS.ERROR,n)}),this.cl_sf.start()},o.prototype.release=function(){this.cl_sf.stop()},o.Payload=function(e,t,i,n){this.player=e,this.playerConfig=t,this.analyticsSession=i,this.metadata=n,this.eventValue=null},o.EVENTS={PLAYER_CREATED:"PLAYER_CREATED",PLAY_REQUESTED:"PLAY_REQUESTED",PLAYER_TECH_INIT:"PLAYER_TECH_INIT",PLAYER_LOAD:"PLAYER_LOAD",LOADED_METADATA:"LOADED_METADATA",PLAYING:"PLAYING",PAUSED:"PAUSED",ENDED:"ENDED",AD_BREAK_READY:"AD_BREAK_READY",BITRATE_CHANGED:"BITRATE_CHANGED",BUFFERING:"BUFFERING",SEEKING_STARTED:"SEEKING_STARTED",SEEKING_ENDED:"SEEKING_ENDED",CUSTOM_EVENT:"CUSTOM_EVENT",AD_CLICKED:"AD_CLICKED",AD_STARTED:"AD_STARTED",AD_PAUSED:"AD_PAUSED",AD_RESUMED:"AD_RESUMED",AD_ENDED:"AD_ENDED",PLAYER_DESTROYED:"PLAYER_DESTROYED",ERROR:"ERROR",AUTOPLAY_BLOCKED:"AUTOPLAY_BLOCKED"},e.exports=o},141:function(e,t,i){var n=i(3),r=i(26).stringifyValuesIgnoreNull,s=i(3).isAutoplayBlockedError,o=i(142),a=i(140),c=i(143),u=i(149),l=i(150),d=i(145),_=i(148),h=i(147),f=i(146),p=i(144),g=a.EVENTS,E=function(e,t,i){this.cl_cf=new a(i.tag,e),this.cl_uf=new o.Context,this.cl_Fn=i,this.cl_Q=t,this.cl_lf=null,this.cl_df=c.Client.NO_SESSION_KEY,this.cl__f=null,this.cl_hf=null,this.cl_ff=null,this.cl_pf=null,this.cl_gf=[],this.cl_Ef=!1};E.prototype.cl_Af=function(e){var t=null;try{t=new c.ClientSettings(e.customerKey),e.serviceUrl&&(t.gatewayUrl=e.serviceUrl)}catch(e){this.cl_Fn.error("Invalid Conviva customer key",e)}return t},E.prototype.cl_mf=function(e){return e!==c.Client.NO_SESSION_KEY},E.prototype.cl_yf=function(){var e=new c.SystemSettings,t=new c.SystemInterface(new u,new l,new d,new _,new h(c),new f(c,this.cl_Fn.tag+".sdk"));e.logLevel=c.SystemSettings.LogLevel.DEBUG,e.allowUncaughtExceptions=!0,this.cl_pf=new c.SystemFactory(t,e)},E.prototype.cl_Sf=function(){null!==this.cl_pf&&(this.cl_pf.release(),this.cl_pf=null)},E.prototype.cl_vf=function(){var e=this.cl_Af(this.cl_Q);null!==e&&(this.cl_lf=e,this.cl_hf=new c.Client(e,this.cl_pf))},E.prototype.cl_Tf=function(){null!==this.cl_hf&&(this.cl_hf.release(),this.cl_hf=null)},E.prototype.cl_Cf=function(){this.cl_yf(),this.cl_vf()},E.prototype.cl_If=function(){this.cl_Tf(),this.cl_Sf()},E.prototype.cl_bf=function(e){var t=c.ContentMetadata.StreamType,i=o;this.cl_ff.assetName||(this.cl_ff.assetName=i.getAssetName(this.cl_Q)),this.cl_uf.playbackStarted||(this.cl_ff.viewerId=this.cl_Q.viewerId||e.viewerId||null,this.cl_ff.streamType=e.isLive||this.cl_Q.isLive?t.LIVE:t.VOD,this.cl_ff.applicationName=i.getApplicationName(e,this.cl_Q),this.cl_ff.duration=e.duration||this.cl_Q.duration,this.cl_ff.custom=r(i.getCustomTags(e,this.cl_Q))),this.cl_ff.streamUrl=e.manifestUri},E.prototype.cl_Rf=function(e){this.cl_ff||(this.cl_ff=new c.ContentMetadata),this.cl_bf({manifestUri:o.getLoadingManifestUri(e)})},E.prototype.cl_Pf=function(e){this.cl_mf(this.cl_df)&&this.cl_ff&&(this.cl_bf(e),this.cl_hf.updateContentMetadata(this.cl_df,this.cl_ff),this.cl_Fn.debug("Updated content metadata",this.cl_ff))},E.prototype.cl_Nf=function(e){this.cl_hf.adStart(this.cl_df,c.Client.AdStream.SEPARATE,c.Client.AdPlayer.SEPARATE,e),this.cl_hf.detachPlayer(this.cl_df),this.cl_uf.isAdBreak=!0},E.prototype.cl_Lf=function(){this.cl_hf.attachPlayer(this.cl_df,this.cl__f),this.cl_hf.adEnd(this.cl_df),this.cl_uf.isAdBreak=!1},E.prototype.cl_Df=function(e){var t=c.Client.AdPosition.POSTROLL;return 1===e?t=c.Client.AdPosition.PREROLL:2===e?t=c.Client.AdPosition.MIDROLL:3===e&&(t=c.Client.AdPosition.POSTROLL),t},E.prototype.cl_Of=function(e){var t=o,i=c.PlayerStateManager.PlayerState;this.cl_Rf(e),this.cl_df=this.cl_hf.createSession(this.cl_ff),this.cl__f=this.cl_hf.getPlayerStateManager(),this.cl__f.setClientMeasureInterface(new p(e,this.cl_Fn.tag)),this.cl_hf.attachPlayer(this.cl_df,this.cl__f),this.cl__f.setPlayerState(i.STOPPED),this.cl_Ef=!1,this.cl_gf.length>0&&(this.cl_Fn.debug("Report deferred events"),t.runDeffered(this.cl_gf)),this.cl_gf=[]},E.prototype.cl_wf=function(){if(null!==this.cl_hf&&this.cl_mf(this.cl_df)){var e=c.PlayerStateManager.PlayerState;this.cl_Fn.debug("Cleanup session id: "+this.cl_df),this.cl__f.setPlayerState(e.STOPPED),this.cl_hf.detachPlayer(this.cl_df),this.cl_hf.releasePlayerStateManager(this.cl__f),this.cl_hf.cleanupSession(this.cl_df),this.cl_Ef=!0,this.cl_df=c.Client.NO_SESSION_KEY,this.cl__f=null,this.cl_ff=null}},E.prototype.cl_kf=function(){this.cl_If(),this.cl_Cf()},E.prototype.cl_Mf=function(e){var t=e.player,i=e.playerConfig;this.cl_Fn.debug("Event: on player created",e),o.setContext(this.cl_uf,t,i)},E.prototype.cl_Uf=function(e){var t=e.player;this.cl_Fn.debug("Event: on player tech initialized"),this.cl_uf.imaConfigPresent&&t.getIMA().then(function(e){var t=e.getAdsManager();if(this.cl_uf.imaPlugin=e,t){var i=t.getCuePoints();this.cl_Fn.debug("Ads cue points: "+i)}}.bind(this)).catch(function(e){this.cl_Fn.debug("Error getting IMA",e)}.bind(this))},E.prototype.cl_xf=function(e){var t=e.player,i=this.cl_uf.autoplay;this.cl_Fn.debug("Event: on play requested"),this.cl_mf(this.cl_df)||i?this.cl_mf(this.cl_df)&&!this.cl_uf.autoplayAllowed&&this.cl_uf.isAdBreak&&(this.cl_Fn.debug("Resuming VST monitoring ..."),this.cl_Lf(),this.cl_uf.autoplayAllowed=!0):(this.cl_Fn.debug("Creating conviva session. On Play Requested / No autplay"),this.cl_Of(t))},E.prototype.cl_Ff=function(e){var t=e.playerConfig,i=e.player,r=o;this.cl_Fn.debug("Event: on player load request");var s=n.getSafeValue(t,"plugins.clpp_conviva"),a=n.merge(this.cl_Q,s);r.setContext(this.cl_uf,i,t);var c=this.cl_uf.autoplay;if(!this.cl_mf(this.cl_df)){var u=this.cl_lf;try{u=this.cl_Af(a),this.cl_Q=a,r.isClientSettingUpdated(this.cl_lf,u)&&(this.cl_Fn.debug("Client settings updated. Reinitializing Conviva"),this.cl_kf())}catch(e){this.cl_Fn.warn("Cannot create Conviva client settings. Ignoring newly loaded config")}c&&(this.cl_Fn.debug("Creating conviva session. On Player Load / Autoplay"),this.cl_Of(i))}},E.prototype.cl_Bf=function(e){var t=e.player;this.cl_Fn.debug("Event: on player destroyed"),this.cl_mf(this.cl_df)||this.cl_Ef||this.cl_Of(t),this.cl_wf()},E.prototype.cl_Vf=function(e){var t=e.metadata;this.cl_Fn.debug("Event: on metadata loaded",t,this.cl_Q),this.cl_mf(this.cl_df)?this.cl_Pf(t):(this.cl_Fn.debug("Add deferred"),this.cl_gf.push({scope:this,fn:this.cl_Vf,args:e}))},E.prototype.cl_yh=function(e){var t=c.PlayerStateManager.PlayerState,i=e.player,n=i.currentTime();this.cl_Fn.debug("Event: on player state is playing. Current Time: "+n),this.cl_mf(this.cl_df)&&(this.cl_uf.playbackStarted||(this.cl_uf.playbackStarted=!0),this.cl__f.setPlayerState(t.PLAYING))},E.prototype.cl_Yf=function(e){var t=c.PlayerStateManager.PlayerState,i=e.player,n=i.currentTime();this.cl_Fn.debug("Event: on player state is paused. Current Time: "+n),this.cl_mf(this.cl_df)&&this.cl__f.setPlayerState(t.PAUSED)},E.prototype.cl_qu=function(){this.cl_Fn.debug("Event: on player state playback ended"),this.cl_wf()},E.prototype.cl_Ks=function(e){var t=Math.round(e.eventValue/1e3),i=e.player.getActiveTrackByType("video")[0];this.cl_Fn.debug("Event: on bitrate changed"),this.cl_mf(this.cl_df)&&(this.cl__f.setBitrateKbps(t),i&&i.frameRate&&this.cl__f.setEncodedFrameRate(i.frameRate))},E.prototype.cl_Kf=function(){var e=c.PlayerStateManager.PlayerState;this.cl_Fn.debug("Event: on buffering"),this.cl_mf(this.cl_df)&&this.cl__f.setPlayerState(e.BUFFERING)},E.prototype.cl_no=function(e){var t=e.player,i=e.eventValue;this.cl_Fn.debug("Event: on seeking started"),!this.cl_mf(this.cl_df)&&this.cl_uf.playbackStarted&&(this.cl_Fn.debug("Creating conviva session (On Seek / Replay)"),this.cl_Of(t),this.cl_hf.updateContentMetadata(this.cl_df,this.cl_ff)),this.cl_mf(this.cl_df)&&this.cl__f.setPlayerSeekStart(Math.round(1e3*i))},E.prototype.cl_so=function(){this.cl_Fn.debug("Event: on seeking ended"),this.cl_mf(this.cl_df)&&this.cl__f.setPlayerSeekEnd()},E.prototype.cl_Gf=function(e){var t=e.eventValue;this.cl_Fn.debug("Event: on custom event"),this.cl_mf(this.cl_df)&&this.cl_hf.sendCustomEvent(this.cl_df,t.name,r(t.attributes))},E.prototype.cl_Hf=function(){this.cl_Fn.debug("Event: on ad break ready")},E.prototype.cl_ls=function(e){var t=c.Events,i=e.eventValue,n=o.getAdData(i,1),s=this.cl_Df(n.podIndex);this.cl_Fn.debug("Event: on ad started. Position: "+s),this.cl_Nf(s),this.cl_hf.sendCustomEvent(this.cl_df,t.POD_START,r(n))},E.prototype.cl_hs=function(e){var t="AD.PAUSED",i=e.eventValue,n=o.getAdData(i);this.cl_Fn.debug("Event: on ad paused"),this.cl_hf.sendCustomEvent(this.cl_df,t,r(n))},E.prototype.cl__s=function(e){var t="AD.RESUMED",i=e.eventValue,n=o.getAdData(i);this.cl_Fn.debug("Event: on ad resumed"),this.cl_hf.sendCustomEvent(this.cl_df,t,r(n))},E.prototype.cl_ms=function(e){var t="AD.CLICKED",i=e.eventValue,n=o.getAdData(i);this.cl_Fn.debug("Event: on ad clicked"),this.cl_hf.sendCustomEvent(this.cl_df,t,r(n))},E.prototype.cl_fs=function(e){var t=c.Events,i=e.eventValue;if(this.cl_Fn.debug("Event: on ad finished"),i){var n=o.getAdData(i,1);this.cl_hf.sendCustomEvent(this.cl_df,t.POD_END,r(n)),this.cl_Lf()}},E.prototype.cl_jn=function(){var e=!!this.cl_Q.reportAutoplayAsVSF,t=this.cl_mf(this.cl_df);this.cl_Fn.debug("Auto-play blocked. Paused VST monitoring. Valid session: "+t),t&&(this.cl_uf.autoplayAllowed=!1,this.cl_Nf(c.Client.AdPosition.PREROLL),e&&this.cl_hf.reportError(this.cl_df,"Auto-play request has been blocked by the user agent or the platform.",c.Client.ErrorSeverity.FATAL))},E.prototype.cl_Va=function(e){var t=e.eventValue,i=t.msg||t.message,n=!s(t);this.cl_Fn.debug("Event: on error",t),this.cl_mf(this.cl_df)&&n?this.cl_hf.reportError(this.cl_df,i,c.Client.ErrorSeverity.FATAL):(this.cl_Fn.debug("Add deferred"),this.cl_gf.push({scope:this,fn:this.cl_Va,args:e}))},E.prototype.cl_jf=function(){var e=this.cl_cf;e.on(g.PLAYER_CREATED,this.cl_Mf,this),e.on(g.PLAYER_TECH_INIT,this.cl_Uf,this),e.on(g.PLAY_REQUESTED,this.cl_xf,this),e.on(g.PLAYER_LOAD,this.cl_Ff,this),e.on(g.LOADED_METADATA,this.cl_Vf,this),e.on(g.PLAYING,this.cl_yh,this),e.on(g.PAUSED,this.cl_Yf,this),e.on(g.ENDED,this.cl_qu,this),e.on(g.AD_BREAK_READY,this.cl_Hf,this),e.on(g.BITRATE_CHANGED,this.cl_Ks,this),e.on(g.BUFFERING,this.cl_Kf,this),e.on(g.SEEKING_STARTED,this.cl_no,this),e.on(g.SEEKING_ENDED,this.cl_so,this),e.on(g.CUSTOM_EVENT,this.cl_Gf,this),e.on(g.AD_CLICKED,this.cl_ms,this),e.on(g.AD_STARTED,this.cl_ls,this),e.on(g.AD_PAUSED,this.cl_hs,this),e.on(g.AD_RESUMED,this.cl__s,this),e.on(g.AD_ENDED,this.cl_fs,this),e.on(g.PLAYER_DESTROYED,this.cl_Bf,this),e.on(g.ERROR,this.cl_Va,this),e.on(g.AUTOPLAY_BLOCKED,this.cl_jn,this)},E.prototype.cl_Wf=function(){this.cl_cf.offAll()},E.prototype.setup=function(){if(this.cl_jf(),this.cl_Cf(),!this.cl_hf)throw new Error("Could not create Conviva client")},E.prototype.release=function(){this.cl_cf.release(),this.cl_Wf(),this.cl_If()},e.exports=E},142:function(e,t,i){var n=i(3),r=function(){};r.runDeffered=function(e){e.forEach(function(e){var t=e.scope,i=e.fn,n=e.args;i.call(t,n)})},r.getAdData=function(e,t){var i=e.getAd(),n=i.getAdPodInfo(),r=i.getAdId(),s=i.getTitle(),o=i.getDuration(),a=void 0,c=void 0;if(n)switch(n.getTotalAds()>1&&(o=0),n.getPodIndex()){case 0:c="Pre-roll",a=1;break;case-1:c="Post-roll",a=3;break;default:c="Mid-roll",a=2}return{id:r,title:s,podDuration:o,podPosition:c,podIndex:a,absoluteIndex:t}},r.isImaConfigPresent=function(e){var t=n.getSafeValue(e,"plugins.clpp_ima");return!!t},r.getAutoplayConfig=function(e){var t=n.getSafeValue(e,"autoplay");return!!t},r.getApplicationName=function(e,t){var i="N/A";return t.applicationName?i=t.applicationName:e.applicationName&&(i=e.applicationName),i},r.getAssetName=function(e){var t="N/A";return e.assetName&&(t=e.assetName),t},r.getCustomTags=function(e,t){var i=n.getSafeValue(t,"tags"),r=n.getSafeValue(e,"tags"),s=n.merge(i,r);return s},r.setContext=function(e,t,i){var n=r;e.autoplay=n.getAutoplayConfig(i),e.imaConfigPresent=n.isImaConfigPresent(i),e.autoplayAllowed=!0,e.playbackStarted=!1,e.isAdBreak=!1},r.Context=function(){this.autoplay=!1,this.autoplayAllowed=!0,this.playbackStarted=!1,this.isAdBreak=!1,this.imaConfigPresent=!1,this.imaPlugin=null},r.isClientSettingUpdated=function(e,t){return e.customerKey!==t.customerKey||e.gatewayUrl!==t.gatewayUrl||e.heartbeatInterval!==t.heartbeatInterval},r.getLoadingManifestUri=function(e){var t=e.cl_Ia||null;return t&&t.sources&&t.sources.length>0?t.sources[0].src:""},e.exports=r},143:function(e,t){/*! (C) 2016 Conviva, Inc. All rights reserved. Confidential and proprietary. */
!function(i,n){if("function"==typeof define&&define.amd?define(n):"object"==typeof t&&(e.exports=n()),"undefined"!=typeof i){if(void 0!==i.Conviva)return;if(i.ConvivaLoading)return;i.ConvivaLoading=!0,i.Conviva=n(),delete i.ConvivaLoading}}(this,function(){var e={};return function(){"use strict";var t={};!function(){var i=e.Client=function(t,o){function c(e,t){if(!(e instanceof n))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(t instanceof s))throw new Error("systemFactory parameter should be an instance of SystemFactory.");(e.gatewayUrl==n.cl_Qf+n.defaultProductionGatewayDNS||e.gatewayUrl==n.cl_qf+n.defaultProductionGatewayDNS)&&(this.defaultGatewayURLError=!0),this.cl_zf=e.clone(),this.cl_pf=t,this.cl_pf.configure("SDK",this.cl_zf),this.cl_Xf=this.cl_pf.buildExceptionCatcher(),this.cl_Xf.runProtected("Client.init",function(){u.cl_ad=D.uinteger32(),u.cl_Fn=u.cl_pf.buildLogger(),u.cl_Fn.setModuleName("Client"),u.defaultGatewayURLError&&u.cl_Fn.info("Gateway URL should not be set to https://cws.conviva.com or http://cws.conviva.com, therefore this call is ignored"),u.cl_Fn.info("init(): url="+u.cl_zf.gatewayUrl+" customerKey="+u.cl_zf.customerKey),u.cl_Q=u.cl_pf.buildConfig(),u.cl_Q.load(),u.cl_Jf=u.cl_pf.buildSessionFactory(u,u.cl_zf,u.cl_Q),u.cl_Fn.info("init(): done.")},function(e){throw new Error("Client constructor failed: "+e.message)})}var u=this;this.defaultGatewayURLError=!1,this.cl_Fn=null,this.cl_Jf=null,this.cl_pf=null,this.cl_Zf=-1,this.cl_zf=null,this.cl_$f=null,this.cl_Xf=null,this.cl_Q=null,this.cl_ad=-1,this.cl_ep=!1,c.apply(this,arguments),this.release=function(){this.cl_ep||this.cl_Xf.runProtected("Client.release",function(){u.cl_Fn.info("release()"),u.cl_Jf.cleanup(),u.cl_Jf=null,u.cl_Zf=-1,u.cl_Fn=null,u.cl_ad=-1,u.cl_Xf=null,u.cl_zf=null,u.cl_$f=null,u.cl_pf=null,u.cl_ep=!0})},this.createSession=function(e){var t=i.NO_SESSION_KEY;return this.cl_ep?t:null==e||e instanceof r?(this.cl_Xf.runProtected("Client.createSession",function(){t=u.cl_Jf.makeVideoSession(e,y.SESSION_TYPE.VIDEO)}),t):(u.cl_Fn.error("createSession(): expecting an instance of ContentMetadata for contentMetadata parameter"),t)},this.createAdSession=function(e,t){var n=i.NO_SESSION_KEY;return this.cl_ep?n:null==t||t instanceof r?(this.cl_Xf.runProtected("Client.createAdSession",function(){var i=u.cl_Jf.getVideoSession(e);null!=i&&(null==t&&(t=new r),(null==t.applicationName||null==t.viewerId)&&(null==t.viewerId&&null!=i.cl_ff.viewerId&&(t.viewerId=i.cl_ff.viewerId),null==t.applicationName&&null!=i.cl_ff.applicationName&&(t.applicationName=i.cl_ff.applicationName)),t.custom["c3.csid"]=P.ToString(i.cl_ad)),n=u.cl_Jf.makeVideoSession(t,y.SESSION_TYPE.AD)}),n):(u.cl_Fn.error("createAdSession(): expecting an instance of ContentMetadata for adMetadata parameter"),n)},this.reportError=function(t,i,n){return this.cl_ep?void 0:P.isValidString(i)?n!==e.Client.ErrorSeverity.FATAL&&n!==e.Client.ErrorSeverity.WARNING?void this.cl_Fn.error("reportError(): invalid error severity: "+n):void this.cl_Xf.runProtected("Client.reportError",function(){var e=u.cl_Jf.getVideoSession(t);null!=e&&e.reportError(i,n)}):void this.cl_Fn.error("reportError(): invalid error message string: "+i)},this.updateContentMetadata=function(e,t){return this.cl_ep?void 0:t instanceof r?void this.cl_Xf.runProtected("Client.updateContentMetadata",function(){var i=u.cl_Jf.getVideoSession(e);if(null!=i){var n=t.clone();i.updateContentMetadata(n)}}):void u.cl_Fn.error("updateContentMetadata(): expecting an instance of ContentMetadata for contentMetadata parameter")},this.detachPlayer=function(e){this.cl_ep||this.cl_Xf.runProtected("Client.detachPlayer",function(){var t=u.cl_Jf.getVideoSession(e);null!=t&&t.detachPlayer()})},this.attachPlayer=function(e,t){return this.cl_ep?void 0:t instanceof a?void this.cl_Xf.runProtected("Client.attachPlayer",function(){var i=u.cl_Jf.getVideoSession(e);null!=i&&i.attachPlayer(t)}):void u.cl_Fn.error("attachPlayer(): expecting an instance of PlayerStateManager for playerStateManager parameter")},this.contentPreload=function(e){this.cl_ep||this.cl_Xf.runProtected("Client.contentPreload",function(){var t=u.cl_Jf.getVideoSession(e);null!=t&&t.contentPreload()})},this.contentStart=function(e){this.cl_ep||this.cl_Xf.runProtected("Client.contentStart",function(){var t=u.cl_Jf.getVideoSession(e);null!=t&&t.contentStart()})},this.sendCustomEvent=function(e,t,n){return this.cl_ep?void 0:P.isValidString(t)?void this.cl_Xf.runProtected("Client.sendCustomEvent",function(){if(e==i.NO_SESSION_KEY){if(u.cl_Zf<0){var s=new r;u.cl_Zf=u.cl_Jf.makeGlobalSession(s,null)}e=u.cl_Zf}var o=P.sanitizeStringToStringObject(n),a=u.cl_Jf.getSession(e);null!=a&&a.sendCustomEvent(t,o)}):void u.cl_Fn.error("sendCustomEvent(): eventName parameter must be a valid string.")},this.adStart=function(e,t,n,r){return this.cl_ep?void 0:t!==i.AdStream.CONTENT&&t!==i.AdStream.SEPARATE?void this.cl_Fn.error("adStart(): ignored, invalid value for adStream parameter: "+t):n!==i.AdPlayer.CONTENT&&n!==i.AdPlayer.SEPARATE?void this.cl_Fn.error("adStart(): ignored, invalid value for adPlayer parameter: "+n):r!==i.AdPosition.BUMPER&&r!==i.AdPosition.PREROLL&&r!==i.AdPosition.MIDROLL&&r!==i.AdPosition.POSTROLL?void this.cl_Fn.error("adStart(): ignored, invalid value for adPosition parameter: "+r):void this.cl_Xf.runProtected("Client.adStart",function(){var i=u.cl_Jf.getVideoSession(e);null!=i&&i.adStart(t,n,r)})},this.adEnd=function(e){this.cl_ep||this.cl_Xf.runProtected("Client.adEnd",function(){var t=u.cl_Jf.getVideoSession(e);null!=t&&t.adEnd()})},this.cleanupSession=function(e){return this.cl_ep?void 0:e===i.NO_SESSION_KEY?void this.cl_Fn.warning("cleanupSession(): ignored, can't cleanup Client.NO_SESSION_KEY"):void this.cl_Xf.runProtected("Client.cleanupSession",function(){var t=u.cl_Jf.getVideoSession(e);null!=t&&u.cl_Jf.cleanupSession(e)})},this.getAttachedPlayer=function(e){var t=null;return this.cl_ep?t:e===i.NO_SESSION_KEY?(this.cl_Fn.warning("getAttachedPlayer(): ignored for Client.NO_SESSION_KEY"),t):(this.cl_Xf.runProtected("Client.getAttachedPlayer",function(){var i=u.cl_Jf.getVideoSession(e);null!=i&&(t=i.getPlayerStateManager())}),t)},this.isPlayerAttached=function(e){return!this.cl_ep&&null!==this.getAttachedPlayer(e)},this.getPlayerStateManager=function(){if(this.cl_ep)throw new Error("This instance of Conviva.Client has been released.");return new a(this.cl_pf)},this.releasePlayerStateManager=function(e){if(this.cl_ep)throw new Error("This instance of Conviva.Client has been released.");this.cl_Xf.runProtected("Client.releasePlayerStateManager",function(){e instanceof a&&e.release()})},this.getSettings=function(){return this.cl_zf},this.getId=function(){return this.cl_ad}};i.version="2.151.0.36995",i.NO_SESSION_KEY=-2,i.AdPosition={BUMPER:"BUMPER",PREROLL:"PREROLL",MIDROLL:"MIDROLL",POSTROLL:"POSTROLL"},i.AdStream={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},i.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},i.ErrorSeverity={FATAL:0,WARNING:1},i.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},i.AdTechnology={CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},i.AdType={BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},i.AdServingType={INLINE:"Inline",WRAPPER:"Wrapper"},i.DeviceCategory={ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS"};var n=e.ClientSettings=function(e){function t(e){if(!P.isValidString(e))throw new Error("customerKey must be valid");this.customerKey=e}function i(e){if(P.isValidString(e)){var t=e.split("://");if("cws.conviva.com"!=t[1]&&("https"==t[0]||"http"==t[0]))return e}return"https://"+r.customerKey+"."+n.defaultProductionGatewayDNS}var r=this;this.cl_tp=null,P.defGet(this,"customerKey",function(){return this.cl_tp}),P.defSet(this,"customerKey",function(e){P.isValidString(e)&&(this.cl_tp=e)}),this.cl_ip=n.defaultProductionHeartbeatInterval,P.defGet(this,"heartbeatInterval",function(){return this.cl_ip}),P.defSet(this,"heartbeatInterval",function(e){if("number"==typeof e){var t=P.NumberToUnsignedInt(e);t===e&&(this.cl_ip=t)}}),this.cl_np=null,P.defGet(this,"gatewayUrl",function(){return this.cl_np}),P.defSet(this,"gatewayUrl",function(e){P.isValidString(e)&&(this.cl_np=e)}),t.apply(this,arguments),this.equals=function(e){return this.customerKey===e.customerKey&&this.gatewayUrl===e.gatewayUrl&&this.heartbeatInterval===e.heartbeatInterval},this.clone=function(){var e=new n(this.customerKey);return e.gatewayUrl=i(this.gatewayUrl),e.heartbeatInterval=this.heartbeatInterval,e}};n.defaultDevelopmentGatewayUrl="https://conviva.testonly.conviva.com",n.defaultProductionGatewayUrl="https://cws.conviva.com",n.defaultProductionGatewayDNS="cws.conviva.com",n.defaultDevelopmentGatewayDNS="conviva.testonly.conviva.com",n.cl_Qf="https://",n.cl_qf="http://",n.defaultDevelopmentHeartbeatInterval=5,n.defaultProductionHeartbeatInterval=20;var r=e.ContentMetadata=function(){function e(){return this.cl_rp}function t(e){"string"==typeof e&&(this.cl_rp=e)}function i(){return this.cl_sp}function n(e){"object"==typeof e&&(this.cl_sp=P.sanitizeStringToStringObject(e))}function s(){return this.cl_op}function o(e){"string"==typeof e&&(this.cl_op=e)}function a(){return this.cl_ap}function c(e){"string"==typeof e&&(this.cl_ap=e)}function u(){return this.cl_cp}function l(e){"string"==typeof e&&(this.cl_cp=e)}function d(){return this.cl_up}function _(e){"string"==typeof e&&(this.cl_up=e)}function h(){return this.cl_lp}function f(e){(e===r.StreamType.UNKNOWN||e===r.StreamType.VOD||e===r.StreamType.LIVE)&&(this.cl_lp=e)}function p(){return this.cl_Hl}function g(e){this.cl_Hl=O.sanitizeSpecialIntegerValue(e)}function E(){return this.cl_dp}function A(e){this.cl_dp=O.sanitizeSpecialIntegerValue(e)}function m(){}this.cl_rp=null,P.defGet(this,"assetName",e),P.defSet(this,"assetName",t),this.cl_sp={},P.defGet(this,"custom",i),P.defSet(this,"custom",n),this.cl_op=null,P.defGet(this,"defaultResource",s),P.defSet(this,"defaultResource",o),this.cl_ap=null,P.defGet(this,"viewerId",a),P.defSet(this,"viewerId",c),this.cl_cp=null,P.defGet(this,"applicationName",u),P.defSet(this,"applicationName",l),this.cl_up=null,P.defGet(this,"streamUrl",d),P.defSet(this,"streamUrl",_),this.cl_lp=r.StreamType.UNKNOWN,P.defGet(this,"streamType",h),P.defSet(this,"streamType",f),this.cl_Hl=-1,P.defGet(this,"duration",p),P.defSet(this,"duration",g),this.cl_dp=-1,P.defGet(this,"encodedFrameRate",E),P.defSet(this,"encodedFrameRate",A),m.apply(this,arguments),this.clone=function(){var e=new r;e.assetName=this.assetName,e.applicationName=this.applicationName,e.streamUrl=this.streamUrl,e.viewerId=this.viewerId,e.defaultResource=this.defaultResource,e.streamType=this.streamType,e.duration=this.duration,e.encodedFrameRate=this.encodedFrameRate;for(var t in this.custom)e.custom[t]=this.custom[t];return e}};r.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"};var s=(e.ErrorType={ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},e.Events={AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},e.SystemFactory=function(e,t){function i(e,t){if(!(e instanceof _))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this.cl__p=e,this.cl_hp=this.cl__p.cl_hp,this.cl_fp=this.cl__p.cl_fp,this.cl_pp=this.cl__p.cl_pp,this.cl_gp=this.cl__p.cl_gp,this.cl_Ep=this.cl__p.cl_Ep,this.cl_Ap=this.cl__p.cl_Ap,t instanceof o?this.cl_zf=t.clone():this.cl_zf=new o}var n=this;i.apply(this,arguments),this.configure=function(e,t){this.cl_mp=e,this.cl_yp=t},this.release=function(){this.cl__p.release(),this.cl__p=null,this.cl_mp=null,this.cl_zf=null,this.cl_Sp=null};var r={build:function(){return new k(n.cl_Ap,n.cl_hp,n.getSettings(),n.cl_Sp,n.cl_mp)}};this.buildLogger=function(){return r.build()},this.buildSessionFactory=function(e,t,i){return new v(e,t,i,this)},this.buildPing=function(){return new L(this.buildLogger(),this.buildHttpClient(),this.cl_yp)},this.buildCallbackWithTimeout=function(){return new T(this.buildTimer())},this.buildCallbackWithTimeoutNoPing=function(){var e=null,t=new b(this.buildLogger(),e,this.getSettings()),i=new F(this.buildLogger(),this.cl_fp,t);return new T(i)},this.buildHttpClient=function(){return new w(this.buildLogger(),this.cl_pp,this.buildCallbackWithTimeoutNoPing(),this.getSettings())},this.buildExceptionCatcher=function(){return new b(this.buildLogger(),this.buildPing(),this.getSettings())},this.buildTime=function(){return new x(this.cl_hp,this.buildLogger())},this.buildTimer=function(){return new F(this.buildLogger(),this.cl_fp,this.buildExceptionCatcher())},this.buildStorage=function(){return new M(this.buildLogger(),this.cl_gp,this.buildCallbackWithTimeout(),this.getSettings())},this.buildConfig=function(){return new C(this.buildLogger(),this.buildStorage(),this.buildJsonInterface())},this.buildSystemMetadata=function(){return new U(this.buildLogger(),this.cl_Ep,this.buildExceptionCatcher())},this.buildCwsProtocol=function(){return new E},this.buildGatewayControl=function(e){return new R(e,this.buildLogger(),this.buildHttpClient(),this.buildJsonInterface())},this.buildCwsSession=function(e,t,i){var n=this.buildGatewayControl(t);return new y(this.buildEventQueue(),e,t,this.buildLogger(),this.buildExceptionCatcher(),this.buildTimer(),n,this.buildCwsProtocol(),this.buildTime(),this.getLogBuffer(),i)},this.buildSession=function(e,t,i,n,r,s){var o=this.buildExceptionCatcher(),a=this.buildLogger(),c=t.clone(),u=this.buildCwsSession(e,c,i);return new S(n,r,s,i,this.buildSystemMetadata(),u,o,a)},this.buildEventQueue=function(){return new I},this.buildJsonInterface=function(){return new A},this.getLogBuffer=function(){return this.cl_Sp},this.getSettings=function(){return this.cl_zf},this.cl_Sp=new N}),o=e.SystemSettings=function(){function e(){}this.cl_vp=o.defaultProductionLogLevel,P.defGet(this,"logLevel",function(){return this.cl_vp}),P.defSet(this,"logLevel",function(e){if("number"==typeof e){var t=P.NumberToUnsignedInt(e);t===e&&t>=o.LogLevel.DEBUG&&t<=o.LogLevel.ERROR&&(this.cl_vp=t)}}),this.cl_Tp=o.defaultProductionAllowUncaughtExceptions,P.defGet(this,"allowUncaughtExceptions",function(){return this.cl_Tp}),P.defSet(this,"allowUncaughtExceptions",function(e){P.isBoolean(e)&&(this.cl_Tp=e)}),this.cl_Cp=o.defaultStorageTimeout,P.defGet(this,"storageTimeout",function(){return this.cl_Cp}),P.defSet(this,"storageTimeout",function(e){if("number"==typeof e){var t=P.NumberToUnsignedInt(e);t===e&&(this.cl_Cp=t)}}),this.cl_Ip=o.defaultHttpTimeout,P.defGet(this,"httpTimeout",function(){return this.cl_Ip}),P.defSet(this,"httpTimeout",function(e){if("number"==typeof e){var t=P.NumberToUnsignedInt(e);t===e&&(this.cl_Ip=t)}}),e.apply(this,arguments),this.equals=function(e){return this.logLevel===e.logLevel&&this.allowUncaughtExceptions===e.allowUncaughtExceptions&&this.storageTimeout===e.storageTimeout&&this.httpTimeout===e.httpTimeout},this.clone=function(){var e=new o;return e.logLevel=this.logLevel,e.allowUncaughtExceptions=this.allowUncaughtExceptions,e.storageTimeout=this.storageTimeout,e.httpTimeout=this.httpTimeout,e}};o.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},o.defaultDevelopmentLogLevel=o.LogLevel.DEBUG,o.defaultProductionLogLevel=o.LogLevel.ERROR,o.defaultDevelopmentAllowUncaughtExceptions=!0,o.defaultProductionAllowUncaughtExceptions=!1,o.defaultStorageTimeout=10,o.defaultHttpTimeout=10;var a=e.PlayerStateManager=function(i){function n(e){r.cl_pf=e,r.cl_Fn=r.cl_pf.buildLogger(),r.cl_Fn.setModuleName("PlayerStateManager"),r.cl_Xf=r.cl_pf.buildExceptionCatcher()}var r=this;r.cl_bp=null,r.cl_Rp=-2,r.cl_Pp=a.PlayerState.UNKNOWN,r.cl_Np={},r.cl_Lp=-2,r.cl_dp=-2,r.cl_Hl=-2,r.cl_Dp=null,r.cl_Op=null,r.cl_up=null,r.cl_wp=null,r.cl_kp=null,r.cl_Mp=-1,r.cl_Up=-1,r.cl_xp=null,r.cl_Fp=null,r.cl_Bp=null,r.cl_Vp=[],r.cl_ep=!1,this.release=function(){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.release",function(){null!=r.cl_bp&&r.cl_bp.onRelease(),r.removeMonitoringNotifier(),r.cl_pf=null,r.cl_Fn=null,r.cl_Xf=null,r.cl_ep=!0})},this.setPlayheadTime=function(e){},this.setBufferLength=function(e){},this.setRenderedFrameRate=function(e){},this.getEncodedFrameRate=function(){return r.cl_dp},this.setEncodedFrameRate=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setEncodedFrameRate",function(){var t=O.sanitizeSpecialIntegerValue(e);t>=-1&&(r.cl_dp=t,null!=r.cl_bp&&r.cl_bp.onEncodedFrameRateChange(r.cl_dp))})},this.getDuration=function(){return r.cl_Hl},this.setClientMeasureInterface=function(t){P.validateInterface(t,new e.ClientMeasureInterface,"ClientMeasureInterface"),this.cl_Yp=t},this.getPHT=function(){return this.cl_Yp&&"function"==typeof this.cl_Yp.getPHT?this.cl_Yp.getPHT():a.DEFAULT_PHT},this.getBufferLength=function(){return this.cl_Yp&&"function"==typeof this.cl_Yp.getBufferLength?this.cl_Yp.getBufferLength():a.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this.cl_Yp&&"function"==typeof this.cl_Yp.getSignalStrength?this.cl_Yp.getSignalStrength():a.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this.cl_Yp&&"function"==typeof this.cl_Yp.getRenderedFrameRate?this.cl_Yp.getRenderedFrameRate():a.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setDuration",function(){var t=O.sanitizeSpecialIntegerValue(e);t>=-1&&(r.cl_Hl=t,null!=r.cl_bp&&r.cl_bp.onContentLengthChange(r.cl_Hl))})},this.getStreamUrl=function(){return r.cl_up},this.setStreamUrl=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setStreamUrl",function(){null!=e&&(r.cl_up=e,null!=r.cl_bp&&r.cl_bp.onStreamUrlChange(r.cl_up))})},this.getModuleName=function(){return r.cl_wp},this.getModuleVersion=function(){return r.cl_kp},this.setModuleNameAndVersion=function(e,t){r.cl_wp=e,r.cl_kp=t},this.getPlayerType=function(){return r.cl_Op},this.setPlayerType=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setPlayerType",function(){r.cl_Op=e,null!=r.cl_bp&&r.cl_bp.onPlayerTypeChange(r.cl_Op)})},this.getPlayerVersion=function(){return r.cl_Dp},this.setPlayerVersion=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setPlayerVersion",function(){r.cl_Dp=e,null!=r.cl_bp&&r.cl_bp.onPlayerVersionChange(r.cl_Dp)})},this.setMonitoringNotifier=function(e,t){return r.cl_ep?void 0:null==r.cl_bp&&(r.cl_bp=e,r.cl_Fn.setSessionId(t),!0)},this.removeMonitoringNotifier=function(){r.cl_ep||(r.cl_bp=null,r.cl_Fn.setSessionId(null))},this.pushCurrentState=function(){r.setPlayerState(r.getPlayerState()),r.setBitrateKbps(r.getBitrateKbps()),r.setDuration(r.getDuration()),r.setEncodedFrameRate(r.getEncodedFrameRate()),r.setStreamUrl(r.getStreamUrl()),r.setPlayerType(r.getPlayerType()),r.setPlayerVersion(r.getPlayerVersion());for(var e=0;e<r.cl_Vp.length;e++){var t=r.cl_Vp[e];r.setError(t)}r.cl_Vp=[]},this.getPlayerState=function(){return r.cl_Pp},this.setPlayerState=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setPlayerState",function(){a.isValidPlayerState(e)?(r.cl_Pp=e,null!=r.cl_bp&&r.cl_bp.onPlayerStateChange(r.cl_Pp)):r.cl_Fn.error("PlayerStateManager.SetPlayerState(): invalid state: "+e)})},this.getBitrateKbps=function(){return r.cl_Rp},this.setBitrateKbps=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setBitrateKbps",function(){var t=O.sanitizeSpecialIntegerValue(e);t>=-1&&(r.cl_Rp=t,null!=r.cl_bp&&r.cl_bp.onBitrateChange(r.cl_Rp))})},this.setPlayerSeekStart=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setPlayerSeekStart()",function(){null!=r.cl_bp&&r.cl_bp.onSeekEvent(a.SEEK_ACTIONS_TYPE.SEEK_START,e)})},this.setPlayerSeekEnd=function(){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setPlayerSeekEnd()",function(){null!=r.cl_bp&&r.cl_bp.onSeekEvent(a.SEEK_ACTIONS_TYPE.SEEK_END,-1)})},this.setUserSeekButtonUp=function(){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setUserSeekButtonUp()",function(){null!=r.cl_bp&&r.cl_bp.onSeekEvent(a.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)})},this.setUserSeekButtonDown=function(){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setUserSeekButtonDown()",function(){null!=r.cl_bp&&r.cl_bp.onSeekEvent(a.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)})},this.setVideoResolutionWidth=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setVideoResolutionWidth()",function(){var t=O.sanitizeSpecialIntegerValue(e);t>0&&(r.cl_Mp=t),null!=r.cl_bp&&r.cl_bp.onStreamResolutionWidthChange(r.cl_Mp)})},this.setVideoResolutionHeight=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setVideoResolutionHeight()",function(){var t=O.sanitizeSpecialIntegerValue(e);t>0&&(r.cl_Up=t),null!=r.cl_bp&&r.cl_bp.onStreamResolutionHeightChange(r.cl_Up)})},this.setConnectionType=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setConnectionType()",function(){r.cl_xp=e,null!=r.cl_bp&&r.cl_bp.onConnectionTypeChange(r.cl_xp)})},this.setLinkEncryption=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setLinkEncryption()",function(){r.cl_Fp=e,null!=r.cl_bp&&r.cl_bp.onLinkEncryptionChange(r.cl_Fp)})},this.setSignalStrength=function(e){},this.setError=function(e){if(r.cl_Bp=e,null!=r.cl_bp){var t=e.errorCode,i=e.severity;r.cl_bp.onError(t,i)}else r.cl_Vp.push(e)},this.sendError=function(e,i){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.sendError",function(){var n=new t.StreamerError(e,i);r.setError(n)})},this.reset=function(){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.reset",function(){r.cl_Rp=-2,r.cl_Pp=a.PlayerState.UNKNOWN,r.cl_Np={},r.cl_Lp=-1,r.cl_dp=-1,r.cl_Hl=-1,r.cl_Dp=null,r.cl_Op=null,r.cl_up=null,r.cl_Bp=null,r.cl_Vp=[]})},this.setCDNServerIP=function(e){r.cl_ep||r.cl_Xf.runProtected("PlayerStateManager.setCDNServerIP",function(){null!=r.cl_bp&&r.cl_bp.onCDNServerIPChange(e)})},this.getError=function(){return r.cl_Bp},n.apply(r,arguments),a.DEFAULT_SIGNAL_STRENGTH=1e3,a.DEFAULT_RENDERED_FRAME_RATE=-1,a.DEFAULT_BUFFER_LENGTH=-1,a.DEFAULT_PHT=-1};a.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},a.isValidPlayerState=function(e){return e===a.PlayerState.STOPPED||e===a.PlayerState.PLAYING||e===a.PlayerState.BUFFERING||e===a.PlayerState.PAUSED||e===a.PlayerState.UNKNOWN||e===a.PlayerState.NOT_MONITORED},a.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"};var c=(e.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}},e.HttpInterface=function(){this.makeRequest=function(e,t,i,n,r,s){},this.release=function(){}}),u=e.LoggingInterface=function(){this.consoleLog=function(e,t){},this.release=function(){}},l=e.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.release=function(){}},d=e.StorageInterface=function(){this.saveData=function(e,t,i,n){},this.loadData=function(e,t,i){},this.release=function(){}},_=e.SystemInterface=function(e,t,i,n,r,s){function o(e,t,i,n,r,s){P.validateInterface(e,new h,"TimeInterface"),P.validateInterface(t,new f,"TimerInterface"),P.validateInterface(i,new c,"HttpInterface"),P.validateInterface(n,new d,"StorageInterface"),P.validateInterface(r,new l,"MetadataInterface"),P.validateInterface(s,new u,"LoggingInterface"),this.cl_hp=e,this.cl_fp=t,this.cl_pp=i,this.cl_gp=n,this.cl_Ep=r,this.cl_Ap=s}o.apply(this,arguments),this.release=function(){this.cl_hp.release(),this.cl_hp=null,this.cl_fp.release(),this.cl_fp=null,this.cl_pp.release(),this.cl_pp=null,this.cl_gp.release(),this.cl_gp=null,this.cl_Ep.release(),this.cl_Ep=null,this.cl_Ap.release(),this.cl_Ap=null}},h=e.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},f=e.TimerInterface=function(){this.createTimer=function(e,t,i){},this.release=function(){}},p=t.JSON2={};!function(){function e(e){return 10>e?"0"+e:e}function t(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function i(e,n){var o,c,u,l,d,_=r,h=n[e];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(e)),"function"==typeof a&&(h=a.call(n,e,h)),typeof h){case"string":return t(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(r+=s,d=[],Object.prototype.toString.apply(h)===Object.prototype.toString.apply([])){for(l=h.length,o=0;l>o;o+=1)d[o]=i(o,h)||"null";return u=0===d.length?"[]":r?"[\n"+r+d.join(",\n"+r)+"\n"+_+"]":"["+d.join(",")+"]",r=_,u}if(a&&"object"==typeof a)for(l=a.length,o=0;l>o;o+=1)"string"==typeof a[o]&&(c=a[o],u=i(c,h),u&&d.push(t(c)+(r?": ":":")+u));else for(c in h)Object.prototype.hasOwnProperty.call(h,c)&&(u=i(c,h),u&&d.push(t(c)+(r?": ":":")+u));return u=0===d.length?"{}":r?"{\n"+r+d.join(",\n"+r)+"\n"+_+"}":"{"+d.join(",")+"}",r=_,u}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var n,r,s,o,a;"function"!=typeof p.stringify&&(n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p.stringify=function(e,t,n){var o;if(r="",s="","number"==typeof n)for(o=0;n>o;o+=1)s+=" ";else"string"==typeof n&&(s=n);if(a=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON2.stringify");return i("",{"":e})})}();var g=t.JsonParse=function(){var e,t,i,n,r={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},s=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},o=function(n){return n&&n!==t&&s("Expected '"+n+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},a=function(){var e,i="";for("-"===t&&(i="-",o("-"));t>="0"&&"9">=t;)i+=t,o();if("."===t)for(i+=".";o()&&t>="0"&&"9">=t;)i+=t;if("e"===t||"E"===t)for(i+=t,o(),("-"===t||"+"===t)&&(i+=t,o());t>="0"&&"9">=t;)i+=t,o();return e=+i,isNaN(e)?void s("Bad number"):e},c=function(){var e,i,n,a="";if('"'===t)for(;o();){if('"'===t)return o(),a;if("\\"===t)if(o(),"u"===t){for(n=0,i=0;4>i&&(e=parseInt(o(),16),isFinite(e));i+=1)n=16*n+e;a+=String.fromCharCode(n)}else{if("string"!=typeof r[t])break;a+=r[t]}else a+=t}s("Bad string")},u=function(){for(;t&&" ">=t;)o()},l=function(){switch(t){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}s("Unexpected '"+t+"'")},d=function(){var e=[];if("["===t){if(o("["),u(),"]"===t)return o("]"),e;for(;t;){if(e.push(n()),u(),"]"===t)return o("]"),e;o(","),u()}}s("Bad array")},_=function(){var e,i={};if("{"===t){if(o("{"),u(),"}"===t)return o("}"),i;for(;t;){if(e=c(),u(),o(":"),Object.hasOwnProperty.call(i,e)&&s('Duplicate key "'+e+'"'),i[e]=n(),u(),"}"===t)return o("}"),i;o(","),u()}}s("Bad object")};return n=function(){switch(u(),t){case"{":return _();case"[":return d();case'"':return c();case"-":return a();default:return t>="0"&&"9">=t?a():l()}},function(r,o){var a;return i=r,e=0,t=" ",a=n(),u(),t&&s("Syntax error"),"function"==typeof o?function e(t,i){var n,r,s=t[i];if(s&&"object"==typeof s)for(n in s)Object.hasOwnProperty.call(s,n)&&(r=e(s,n),void 0!==r?s[n]=r:delete s[n]);return o.call(t,i,s)}({"":a},""):a}}(),E=t.CwsProtocol=function(){this.generateEvent=function(e,t,i,n){return n.seq=e,n.st=t,n.t=i,n},this.generateSessionEndEvent=function(e,t){var i=E.EVENT_TYPE_SESSION_END,n={};return this.generateEvent(e,t,i,n)}};E.version="2.4",E.gatewayPath="/0/wsg",E.DEFAULT_CLIENT_ID="0",E.DEFAULT_MAX_HEARTBEAT_INFOS=0,E.DEFAULT_PLAYHEAD_TIME=-1,E.DEFAULT_BUFFER_LENGTH=-1,E.DEFAULT_SIGNAL_STRENGTH=1e3,E.SDK_METADATA_SCHEMA="sdk.js.1",E.EVENT_TYPE_STATE_CHANGE="CwsStateChangeEvent",E.EVENT_TYPE_ERROR="CwsErrorEvent",E.EVENT_TYPE_SESSION_END="CwsSessionEndEvent",E.EVENT_TYPE_CUSTOM="CwsCustomEvent",E.EVENT_TYPE_SEEK="CwsSeekEvent",E.EVENT_TYPE_DATA_SAMPLE="CwsDataSamplesEvent",E.RESPONSE_STATUS_NO_ERRORS="ok",E.RESPONSE_KEY_STATUS="err",E.RESPONSE_KEY_CLIENT_ID="clid",E.RESPONSE_KEY_CONFIG="cfg",E.RESPONSE_KEY_EVENTS="evs",E.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxhbinfos",E.RESPONSE_CONFIG_KEY_SEND_LOGS="slg",E.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL="hbi",E.RESPONSE_CONFIG_KEY_GATEWAY_URL="gw",E.MESSAGE_TYPE_SESSION_HEARTBEAT="CwsSessionHb",E.REQUEST_KEY_MESSAGE_TYPE="t",E.REQUEST_KEY_SESSION_TIME="st",E.REQUEST_KEY_SESSION_START_TIME="sst",E.REQUEST_KEY_IS_LIVE="lv",E.REQUEST_KEY_SEQUENCE_NUMBER="seq",E.REQUEST_KEY_CUSTOMER_KEY="cid",E.REQUEST_KEY_CLIENT_ID="clid",E.REQUEST_KEY_CLIENT_VERSION="clv",E.REQUEST_KEY_PROTOCOL_VERSION="pver",E.REQUEST_KEY_INSTANCE_ID="iid",E.REQUEST_KEY_SESSION_ID="sid",E.REQUEST_KEY_VIEWER_ID="vid",E.REQUEST_KEY_ASSET_NAME="an",E.REQUEST_KEY_PLAYER_NAME="pn",E.REQUEST_KEY_TAGS="tags",E.REQUEST_KEY_SESSION_FLAGS="sf",E.REQUEST_KEY_EVENTS="evs",E.REQUEST_KEY_LOGS="lg",E.REQUEST_KEY_HEARTBEAT_INFOS="hbinfos",E.REQUEST_KEY_IS_SDK_CLIENT="sdk",E.REQUEST_KEY_PAUSE_JOIN="pj",E.REQUEST_KEY_PLAYER_STATE="ps",E.REQUEST_KEY_BITRATE="br",E.REQUEST_KEY_CONTENT_LENGTH="cl",E.REQUEST_KEY_ENCODED_FRAME_RATE="efps",E.REQUEST_KEY_AVERAGE_FRAME_RATE="afps",E.REQUEST_KEY_RFPS_TOTAL="rfpstot",E.REQUEST_KEY_RFPS_COUNT="rfpscnt",E.REQUEST_KEY_RESOURCE="rs",E.REQUEST_KEY_PLAYHEAD_TIME="pht",E.REQUEST_KEY_BUFFER_LENGTH="bl",E.REQUEST_KEY_STREAM_URL="url",E.REQUEST_KEY_CAPABILITIES="caps",E.REQUEST_KEY_PLATFORM_METADATA="pm",E.REQUEST_KEY_VIDEO_WIDTH="w",E.REQUEST_KEY_VIDEO_HEIGHT="h",E.REQUEST_KEY_CONNECTION_TYPE="ct",E.REQUEST_KEY_LINK_ENCRYPTION="le",E.REQUEST_KEY_SIGNAL_STRENGTH="ss",E.REQUEST_KEY_STREAM_METADATA_CHANGE="strmetadata",E.REQUEST_PLATFORM_METADATA_KEY_SCHEMA="sch",
E.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME="br",E.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION="brv",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND="dvb",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER="dvma",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL="dvm",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE="dvt",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION="dvv",E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME="fw",E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION="fwv",E.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION="cc",E.REQUEST_PLATFORM_METADATA_KEY_MODULE_NAME="mn",E.REQUEST_PLATFORM_METADATA_KEY_MODULE_VERSION="mv",E.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME="os",E.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION="osv",E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_CATEGORY="cat",E.REQUEST_KEY_PROTOCOL_CAPP="caps",E.REQUEST_EVENT_KEY_TYPE="t",E.REQUEST_EVENT_KEY_SEQUENCE_NUMBER="seq",E.REQUEST_EVENT_KEY_SESSION_TIME="st",E.REQUEST_EVENT_KEY_SEEK_ACT_TYPE="act",E.REQUEST_EVENT_KEY_SEEK_TO_POS="skto",E.REQUEST_ERROR_EVENT_KEY_MESSAGE="err",E.REQUEST_ERROR_EVENT_KEY_FATAL="ft",E.REQUEST_STATE_CHANGE_EVENT_KEY_NEW="new",E.REQUEST_STATE_CHANGE_EVENT_KEY_OLD="old",E.REQUEST_CUSTOM_EVENT_KEY_NAME="name",E.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES="attr",E.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER="seq",E.REQUEST_HEARTBEAT_INFO_KEY_STATUS="err",E.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME="rtt",E.REQUEST_KEY_IS_AD_SESSION="ad",E.REQUEST_CDN_SERVER_IP="csi",E.convertPlayerState=function(e){switch(e){case a.PlayerState.STOPPED:return E.eStopped;case a.PlayerState.PLAYING:return E.ePlaying;case a.PlayerState.BUFFERING:return E.eBuffering;case a.PlayerState.PAUSED:return E.ePaused;case a.PlayerState.NOT_MONITORED:return E.eNotMonitored;default:return E.eUnknown}},E.eStopped=1,E.ePlaying=3,E.eBuffering=6,E.ePaused=12,E.eNotMonitored=98,E.eUnknown=100,E.SessionFlags={GLOBAL:0,VIDEO:1,QUALITY_METRICS:2,BITRATE_METRICS:4},E.Capabilities={INSIGHTS:0};var A=(t.JSONInterface=function(){this.encode=function(e){},this.decode=function(e){}},t.LibJSONInterface=function(){this.encode=function(e){var t=null;try{t=p.stringify(e)}catch(e){}return t},this.decode=function(e){var t=null;try{t=g(e)}catch(e){}return P.isObject(t)||(t=null),t}}),m=t.CwsHeartbeat=function(){function e(){}this.cl_Kp={},e.apply(this,arguments),this.get=function(){return this.cl_Kp},this.setField=function(e,t){this.cl_Kp[e]=t},this.setInnerField=function(e,t,i){this.cl_Kp[e]||(this.cl_Kp[e]={}),this.cl_Kp[e][t]=i},this.setMessageType=function(e){this.setField(E.REQUEST_KEY_MESSAGE_TYPE,e)},this.setSessionTime=function(e){this.setField(E.REQUEST_KEY_SESSION_TIME,e)},this.setSessionStartTime=function(e){this.setField(E.REQUEST_KEY_SESSION_START_TIME,e)},this.setIsLive=function(e){this.setField(E.REQUEST_KEY_IS_LIVE,e)},this.setSequenceNumber=function(e){this.setField(E.REQUEST_KEY_SEQUENCE_NUMBER,e)},this.setCustomerKey=function(e){this.setField(E.REQUEST_KEY_CUSTOMER_KEY,e)},this.setClientId=function(e){this.setField(E.REQUEST_KEY_CLIENT_ID,e)},this.setClientVersion=function(e){this.setField(E.REQUEST_KEY_CLIENT_VERSION,e)},this.setProtocolVersion=function(e){this.setField(E.REQUEST_KEY_PROTOCOL_VERSION,e)},this.setCapfield=function(e){this.setField(E.REQUEST_KEY_PROTOCOL_CAPP,e)},this.setSessionId=function(e){this.setField(E.REQUEST_KEY_SESSION_ID,e)},this.setInstanceId=function(e){this.setField(E.REQUEST_KEY_INSTANCE_ID,e)},this.setViewerId=function(e){this.setField(E.REQUEST_KEY_VIEWER_ID,e)},this.setAssetName=function(e){this.setField(E.REQUEST_KEY_ASSET_NAME,e)},this.setPlayerName=function(e){this.setField(E.REQUEST_KEY_PLAYER_NAME,e)},this.setTags=function(e){this.setField(E.REQUEST_KEY_TAGS,e)},this.setSessionFlags=function(e){this.setField(E.REQUEST_KEY_SESSION_FLAGS,e)},this.setCapabilities=function(e){this.setField(E.REQUEST_KEY_CAPABILITIES,e)},this.setEvents=function(e){this.setField(E.REQUEST_KEY_EVENTS,e)},this.setIsSdkClient=function(e){this.setField(E.REQUEST_KEY_IS_SDK_CLIENT,e)},this.setLogs=function(e){this.setField(E.REQUEST_KEY_LOGS,e)},this.setHeartbeatInfos=function(e){this.setField(E.REQUEST_KEY_HEARTBEAT_INFOS,e)},this.setPlayerState=function(e){this.setField(E.REQUEST_KEY_PLAYER_STATE,e)},this.setPauseJoin=function(e){this.setField(E.REQUEST_KEY_PAUSE_JOIN,e)},this.setContentLength=function(e){this.setField(E.REQUEST_KEY_CONTENT_LENGTH,e)},this.setBitrate=function(e){this.setField(E.REQUEST_KEY_BITRATE,e)},this.setResource=function(e){this.setField(E.REQUEST_KEY_RESOURCE,e)},this.setEncodedFrameRate=function(e){this.setField(E.REQUEST_KEY_ENCODED_FRAME_RATE,e)},this.setAverageFrameRate=function(e){this.setField(E.REQUEST_KEY_AVERAGE_FRAME_RATE,e)},this.setRfpsObservationCount=function(e){this.setField(E.REQUEST_KEY_RFPS_COUNT,e)},this.setRfpsTotal=function(e){this.setField(E.REQUEST_KEY_RFPS_TOTAL,e)},this.setPlatformMetadataSchema=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_SCHEMA,e)},this.setBrowserName=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_BROWSER_NAME,e)},this.setBrowserVersion=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_BROWSER_VERSION,e)},this.setDeviceBrand=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_BRAND,e)},this.setDeviceManufacturer=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MANUFACTURER,e)},this.setDeviceModel=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_MODEL,e)},this.setDeviceType=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_TYPE,e)},this.setDeviceVersion=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_VERSION,e)},this.setFrameworkName=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME,e),this.setField(E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_NAME,e)},this.setFrameworkVersion=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION,e),this.setField(E.REQUEST_PLATFORM_METADATA_KEY_FRAMEWORK_VERSION,e)},this.setOperatingSystemName=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_NAME,e.toUpperCase())},this.setOperatingSystemVersion=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_OPERATING_SYSTEM_VERSION,e)},this.setDeviceCategory=function(e){this.setInnerField(E.REQUEST_KEY_PLATFORM_METADATA,E.REQUEST_PLATFORM_METADATA_KEY_DEVICE_CATEGORY,e)},this.setPlayheadTime=function(e){this.setField(E.REQUEST_KEY_PLAYHEAD_TIME,e)},this.setBufferLength=function(e){this.setField(E.REQUEST_KEY_BUFFER_LENGTH,e)},this.setStreamUrl=function(e){this.setField(E.REQUEST_KEY_STREAM_URL,e)},this.setStreamWidth=function(e){this.setField(E.REQUEST_KEY_VIDEO_WIDTH,e)},this.setStreamHeight=function(e){this.setField(E.REQUEST_KEY_VIDEO_HEIGHT,e)},this.setConnectionType=function(e){this.setField(E.REQUEST_KEY_CONNECTION_TYPE,e)},this.setLinkEncryption=function(e){this.setField(E.REQUEST_KEY_LINK_ENCRYPTION,e)},this.setIsAdSession=function(){this.setField(E.REQUEST_KEY_IS_AD_SESSION,!0)},this.setSignalStrength=function(e){this.setField(E.REQUEST_KEY_SIGNAL_STRENGTH,e)},this.setModuleName=function(e){this.setInnerField(E.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION,E.REQUEST_PLATFORM_METADATA_KEY_MODULE_NAME,e)},this.setModuleVersion=function(e){this.setInnerField(E.REQUEST_PLATFORM_METADATA_KEY_CLIENT_CONFIGURATION,E.REQUEST_PLATFORM_METADATA_KEY_MODULE_VERSION,e)},this.setCDNServerIP=function(e){this.setField(E.REQUEST_CDN_SERVER_IP,e)}},y=t.CwsSession=function(e,t,n,r,s,o,c,u,l,d,_){function h(e,t,i,n,r,s,o,a,c,u,l){this.cl_Gp=e,this.cl_hf=t,this.cl_yp=i,this.cl_Fn=n,this.cl_Fn.setModuleName("CwsSession"),this.cl_Xf=r,this.cl_Hp=s,this.cl_jp=o,this.cl_Wp=a,this.cl_Qp=c,this.cl_Sp=u,this.cl_qp=l}var f=this;f.cl_zp=null,f.cl_Xp=0,f.cl_Jp=0,f.cl_Zp=E.SessionFlags.GLOBAL,f.cl_$p=E.Capabilities.INSIGHTS,f.cl_eg=[],f.cl_tg=-1,f.cl_Rp=-2,f.cl_ig=null,f.cl_Pp=a.PlayerState.NOT_MONITORED,f.cl_dp=-1,f.cl_ng=-1,f.cl_up=null,f.cl_Mp=-1,f.cl_Up=-1,f.cl__f=null,f.cl_rp=null,f.cl_ap=null,f.cl_rg=null,f.cl_sg=null,f.cl_og={},f.cl_ag=null,f.cl_cg=null,f.cl_ug=null,f.cl_lg=null,f.cl_dg=null,f.cl__g=null,f.cl_hg=null,f.cl_fg=null,f.cl_pg=null,f.cl_gg=null,f.cl_Eg=null,f.cl_Ag=null,f.cl_wp=null,f.cl_kp=null,f.cl_xp=null,f.cl_Fp=null,f.cl_mg=null,f.cl_yg=!1,f.cl_Sg=!1,f.cl_vg=!1,f.cl_Tg=!1,f.cl_Cg=null,f.cl_Ig=1e3,f.cl_bg=0,f.cl_Rg=0,h.apply(this,arguments),this.cleanup=function(){this.cl_qp=null,this.cl_Sp=null,this.cl_$f=null,this.cl_Qp=null,this.cl_Wp=null,this.cl_jp=null,this.cl_Hp=null,this.cl_Xf=null,this.cl_Fn=null,this.cl_yp=null,this.cl_hf=null,this.cl_Gp.flush(),this.cl_Gp=null,this.cl_vg=!0},this.start=function(e){this.cl_Id=e,this.cl_Pg=this.cl_Id.cl_Pg,this.cl_Fn.setSessionId(this.cl_Id.cl_ad),this.cl_Xp=this.cl_Qp.current(),(this.isVideoSession()||this.isAdSession())&&(this.cl_Zp+=y.DEFAULT_VIDEO_SESSION_FLAGS)},this.willEndSoon=function(){this.cl_Tg=!0},this.initialize=function(){this.cl_Fn.debug("initialize()")},this.end=function(){(this.isVideoSession()||this.isAdSession())&&(this.cl_Fn.debug("end(): schedule the last hb before session cleanup"+f.sessionTypeTag()),this.enqueueSessionEndEvent()),this.cancelHeartbeatTimer(),this.sendHeartbeat()},this.startSendingHeartbeats=function(){this.cl_Tg||(this.sendHeartbeat(),this.resetHeartbeatTimer())},this.setBrowserName=function(e){f.cl_Fn.debug("setBrowserName(): "+e);var t=f.cl_ag;t!==e&&null!=e&&(f.cl_Fn.debug("Change browserName from "+t+" to "+e),f.cl_ag=e)},this.setBrowserVersion=function(e){f.cl_Fn.debug("setBrowserVersion(): "+e);var t=f.cl_cg;t!==e&&null!=e&&(f.cl_Fn.debug("Change browserVersion from "+t+" to "+e),f.cl_cg=e)},this.setDeviceBrand=function(e){f.cl_Fn.debug("setDeviceBrand(): "+e);var t=f.cl_ug;t!==e&&null!=e&&(f.cl_Fn.debug("Change deviceBrand from "+t+" to "+e),f.cl_ug=e)},this.setDeviceManufacturer=function(e){f.cl_Fn.debug("setDeviceManufacturer(): "+e);var t=f.cl_lg;t!==e&&null!=e&&(f.cl_Fn.debug("Change deviceManufacturer from "+t+" to "+e),f.cl_lg=e)},this.setDeviceModel=function(e){f.cl_Fn.debug("setDeviceModel(): "+e);var t=f.cl_dg;t!==e&&null!=e&&(f.cl_Fn.debug("Change deviceModel from "+t+" to "+e),f.cl_dg=e)},this.setDeviceType=function(e){f.cl_Fn.debug("setDeviceBrand(): "+e);var t=f.cl__g;t!==e&&null!=e&&(f.cl_Fn.debug("Change deviceType from "+t+" to "+e),f.cl__g=e)},this.setDeviceVersion=function(e){f.cl_Fn.debug("setDeviceVersion(): "+e);var t=f.cl_hg;t!==e&&null!=e&&(f.cl_Fn.debug("Change deviceVersion from "+t+" to "+e),f.cl_hg=e)},this.setOperatingSystemName=function(e){f.cl_Fn.debug("setOperatingSystemName(): "+e);var t=f.cl_gg;t!==e&&null!=e&&(f.cl_Fn.debug("Change operatingSystemName from "+t+" to "+e),f.cl_gg=e)},this.setOperatingSystemVersion=function(e){f.cl_Fn.debug("setOperatingSystemVersion(): "+e);var t=f.cl_Eg;t!==e&&null!=e&&(f.cl_Fn.debug("Change operatingSystemVersion from "+t+" to "+e),f.cl_Eg=e)},this.setDeviceCategory=function(e){f.cl_Fn.debug("setDeviceCategory(): "+e);var t=f.cl_Ag;t!==e&&null!=e&&(f.cl_Fn.debug("Change operatingSystemVersion from "+t+" to "+e),f.cl_Ag=e)},this.getFrameworkName=function(){return f.cl_fg},this.setFrameworkName=function(e){f.cl_Fn.debug("setFrameworkName(): "+e);var t=f.cl_fg;t!==e&&null!=e&&(f.cl_Fn.debug("Change frameworkName from "+t+" to "+e),f.cl_fg=e)},this.getFrameworkVersion=function(){return f.cl_pg},this.setFrameworkVersion=function(e){f.cl_Fn.debug("setFrameworkVersion(): "+e);var t=f.cl_pg;t!==e&&null!=e&&(f.cl_Fn.debug("Change frameworkVersion from "+t+" to "+e),f.cl_pg=e)},this.setStreamUrl=function(e){f.cl_Fn.debug("setStreamUrl(): "+e);var t=f.cl_up;t!==e&&null!=e&&(f.cl_Fn.debug("Change stream url from "+t+" to "+e),f.cl_up=e)},this.setBitrateKbps=function(e){f.cl_Fn.debug("setBitrateKbps(): "+e);var t=f.cl_Rp;t!==e&&e>0&&(f.cl_Fn.info("Change bitrate from "+t+" to "+e),f.enqueueBitrateChangeEvent(t,e),f.cl_Rp=e)},this.setResource=function(e){f.cl_Fn.debug("setResource(): "+e);var t=f.cl_ig;t!==e&&null!=e&&(f.cl_Fn.info("Change resource from "+t+" to "+e),f.cl_ig=e)},this.setAssetName=function(e){f.cl_Fn.debug("setAssetName(): "+e),f.cl_rp!==e&&null!=e&&(f.cl_Fn.info("Change assetName from "+f.cl_rp+" to "+e),f.cl_rp=e)},this.setIsLive=function(e){f.cl_Fn.debug("setIsLive(): "+e);var t=f.cl_sg;t!==e&&null!=e&&(f.cl_Fn.info("Change isLive from "+t+" to "+e),f.cl_sg=e)},this.setViewerId=function(e){f.cl_Fn.debug("setViewerId(): "+e);var t=f.cl_ap;t!==e&&null!=e&&(f.cl_Fn.info("Change viewerId from "+t+" to "+e),f.cl_ap=e)},this.setPlayerName=function(e){f.cl_Fn.debug("setPlayerName(): "+e);var t=f.cl_rg;t!==e&&null!=e&&(f.cl_Fn.info("Change playerName from "+t+" to "+e),f.cl_rg=e)},this.setTags=function(e){f.cl_Fn.debug("setTags()");var t=f.cl_og;P.ObjectShallowEquals(t,e)||null==e||(f.cl_Fn.info("Change tags from "+P.ObjectToString(t)+" to "+P.ObjectToString(e)),f.cl_og=e)},this.setEncodedFrameRate=function(e){f.cl_Fn.debug("setEncodedFrameRate(): "+e),f.cl_dp=e},this.setContentLength=function(e){f.cl_Fn.debug("setContentLength(): "+e),f.cl_ng=e},this.setPlayerState=function(e){if(f.cl_Fn.debug("setPlayerState(): "+e),f.cl_Sg||e!=a.PlayerState.PLAYING||(f.togglePauseJoin(!1),f.cl_Sg=!0),f.cl_Pp!==e){var t=f.cl_Pp;f.cl_Fn.info("setPlayerState(): changing player state from "+t+" to "+e),f.enqueuePlayerStateChangeEvent(t,e),f.cl_Pp=e}},this.setStreamResolutionWidth=function(e){f.cl_Fn.debug("setStreamResolutionWidth(): "+e);var t=f.cl_Mp;t!==e&&e>0&&(f.cl_Fn.debug("Change stream resolution width from "+t+" to "+e),f.enqueueResolutionWidthChangeEvent(t,e),f.cl_Mp=e)},this.setStreamResolutionHeight=function(e){f.cl_Fn.debug("setStreamResolutionHeight(): "+e);var t=f.cl_Up;t!==e&&e>0&&(f.cl_Fn.debug("Change stream resolution height from "+t+" to "+e),f.enqueueResolutionHeightChangeEvent(t,e),f.cl_Up=e)},this.setConnectionType=function(e){f.cl_Fn.debug("setConnectionType(): "+e);var t=f.cl_xp;t!==e&&null!=e&&(f.cl_Fn.debug("Change network connection type from "+t+" to "+e),f.enqueueConnectionTypeChangeEvent(t,e),f.cl_xp=e)},this.setLinkEncryption=function(e){f.cl_Fn.debug("setLinkEncryption(): "+e);var t=f.cl_Fp;t!==e&&null!=e&&(f.cl_Fn.debug("Change network link encryption from "+t+" to "+e),f.enqueueLinkEncryptionChangeEvent(t,e),f.cl_Fp=e)},this.setCDNServerIP=function(e){f.cl_Fn.debug("setCDNServerIP(): "+e);var t=f.cl_mg;t!==e&&P.isValidString(e)&&(f.cl_Fn.debug("Change CDN Server IP from "+t+" to "+e),f.enqueueCDNServerIPChangeEvent(t,e),f.cl_mg=e)},this.togglePauseJoin=function(e){if(f.cl_Fn.debug("togglePauseJoin()"),f.cl_yg===e)return void f.cl_Fn.debug("togglePauseJoin(): same value, ignoring");var t=f.cl_yg,i=!f.cl_yg;f.enqueuePauseJoinChangeEvent(t,i),f.cl_yg=!f.cl_yg},this.sendError=function(e,t){f.enqueueErrorEvent(e,t)},this.enqueueEvent=function(e,t){if(t[E.REQUEST_EVENT_KEY_TYPE]=e,t[E.REQUEST_EVENT_KEY_SESSION_TIME]=this.getSessionTime(),t[E.REQUEST_EVENT_KEY_SEQUENCE_NUMBER]=this.cl_Gp.getNumber(),this.cl__f){var i=O.Integer(this.cl__f.getPHT(),0,null,-1),n=O.Integer(this.cl__f.getBufferLength(),0,null,-1);i>=0&&(t[E.REQUEST_KEY_PLAYHEAD_TIME]=i),n>0&&(t[E.REQUEST_KEY_BUFFER_LENGTH]=n)}this.cl_Gp.enqueue(t)},this.setPlayerStateManager=function(e){f.cl__f=e,null!=f.cl__f?f.startRfpsTimer():f.cancelRfpsTimer()},this.enqueueSessionEndEvent=function(){var e=this.getSessionTime(),t=this.getNextEventNumber(),i=this.cl_Wp.generateSessionEndEvent(t,e);this.cl_Gp.enqueue(i)},this.enqueueErrorEvent=function(e,t){var i={};i[E.REQUEST_ERROR_EVENT_KEY_MESSAGE]=e,i[E.REQUEST_ERROR_EVENT_KEY_FATAL]=t,this.enqueueEvent(E.EVENT_TYPE_ERROR,i)},this.enqueueBitrateChangeEvent=function(e,t){var i={},n={};e>0&&(n[E.REQUEST_KEY_BITRATE]=e),i[E.REQUEST_KEY_BITRATE]=t,this.declareStateChange(i,n)},this.enqueueSeekEvent=function(e,t){var i={};i[E.REQUEST_EVENT_KEY_SEEK_ACT_TYPE]=e,t>=0&&(i[E.REQUEST_EVENT_KEY_SEEK_TO_POS]=t),this.enqueueEvent(E.EVENT_TYPE_SEEK,i)},this.enqueueResolutionWidthChangeEvent=function(e,t){var i={},n={};-1!==e&&(n[E.REQUEST_KEY_VIDEO_WIDTH]=e),i[E.REQUEST_KEY_VIDEO_WIDTH]=t,this.declareStateChange(i,n)},this.enqueueResolutionHeightChangeEvent=function(e,t){var i={},n={};-1!==e&&(n[E.REQUEST_KEY_VIDEO_HEIGHT]=e),i[E.REQUEST_KEY_VIDEO_HEIGHT]=t,this.declareStateChange(i,n)},this.enqueueConnectionTypeChangeEvent=function(e,t){var i={},n={};null!==e&&(n[E.REQUEST_KEY_CONNECTION_TYPE]=e),i[E.REQUEST_KEY_CONNECTION_TYPE]=t,this.declareStateChange(i,n)},this.enqueueLinkEncryptionChangeEvent=function(e,t){var i={},n={};null!==e&&(n[E.REQUEST_KEY_LINK_ENCRYPTION]=e),i[E.REQUEST_KEY_LINK_ENCRYPTION]=t,this.declareStateChange(i,n)},this.enqueueCDNServerIPChangeEvent=function(e,t){var i={},n={};P.isValidString(e)&&(n[E.REQUEST_CDN_SERVER_IP]=e),i[E.REQUEST_CDN_SERVER_IP]=t,this.declareStateChange(i,n)},this.enqueuePauseJoinChangeEvent=function(e,t){var i={},n={};n[E.REQUEST_KEY_PAUSE_JOIN]=e,i[E.REQUEST_KEY_PAUSE_JOIN]=t,this.declareStateChange(i,n)},this.enqueuePlayerStateChangeEvent=function(e,t){var i={},n={};i[E.REQUEST_KEY_PLAYER_STATE]=E.convertPlayerState(t),n[E.REQUEST_KEY_PLAYER_STATE]=E.convertPlayerState(e),this.declareStateChange(i,n)},this.declareStateChange=function(e,t){var i={};i[E.REQUEST_STATE_CHANGE_EVENT_KEY_NEW]=e,null!=t&&P.dictCount(t)>0&&(i[E.REQUEST_STATE_CHANGE_EVENT_KEY_OLD]=t),this.enqueueEvent(E.EVENT_TYPE_STATE_CHANGE,i)},this.enqueueCustomEvent=function(e,t){var i={};i[E.REQUEST_CUSTOM_EVENT_KEY_NAME]=e,i[E.REQUEST_CUSTOM_EVENT_KEY_ATTRIBUTES]=t,this.enqueueEvent(E.EVENT_TYPE_CUSTOM,i)},this.cancelHeartbeatTimer=function(){null!=f.cl_zp&&(f.cl_zp(),f.cl_zp=null)},this.resetHeartbeatTimer=function(){f.cancelHeartbeatTimer();var e=1e3*f.cl_yp.heartbeatInterval;f.cl_zp=f.cl_Hp.create(f.sendHeartbeat,e,"Session.sendHeartbeat")},this.cancelRfpsTimer=function(){null!=f.cl_Cg&&(f.cl_Cg(),f.cl_Cg=null)},this.startRfpsTimer=function(){f.cancelRfpsTimer(),f.cl_Cg=f.cl_Hp.create(f.countRfps,f.cl_Ig,"Session.startRfpsTimer")},this.createHeartbeatInfo=function(){var e={};e.err="pending",e.seq=f.cl_Jp-1,e.sentAt=f.getSessionTime(),e.rtt=-1,f.cl_eg.push(e)},this.updateHeartbeatInfoOnFailure=function(e,t){for(var i=0;i<f.cl_eg.length;i++){var n=f.cl_eg[i],r=n.seq;r===e&&(n.rtt=f.getSessionTime()-n.sentAt,n.err=t)}},this.updateHeartbeatInfoOnSuccess=function(e){for(var t=0;t<f.cl_eg.length;t++){var i=f.cl_eg[t],n=i.seq;n===e&&(i.rtt=f.getSessionTime()-i.sentAt,i.err="ok")}},this.removeOutdatedHeartbeatInfos=function(){for(var e,t,i=f.cl_qp.get(C.CONFIG_KEY_MAX_HEARTBEAT_INFOS),n=[],r=0;r<f.cl_eg.length;r++)t=f.cl_eg[r],e=t.seq,e<f.cl_Jp-i&&n.push(r);for(var s=[],o=0;o<f.cl_eg.length;o++)t=f.cl_eg[o],e=t.seq,n.indexOf(o)<0&&s.push(f.cl_eg[o]);f.cl_eg=s},this.compileHeartbeatInfos=function(){f.removeOutdatedHeartbeatInfos();for(var e=[],t=0;t<f.cl_eg.length;t++){var i=f.cl_eg[t],n={};n[E.REQUEST_HEARTBEAT_INFO_KEY_SEQUENCE_NUMBER]=i.seq,n[E.REQUEST_HEARTBEAT_INFO_KEY_ROUNDTRIP_TIME]=i.rtt,n[E.REQUEST_HEARTBEAT_INFO_KEY_STATUS]=i.err,e.push(n)}return e},this.makeHeartbeat=function(){var e=f.cl_Gp.flush();if(f.isGlobalSession()&&0===e.length)return null;var t=new m;if(t.setMessageType(E.MESSAGE_TYPE_SESSION_HEARTBEAT),t.setCustomerKey(f.cl_yp.customerKey),t.setClientId(f.cl_qp.get(C.CONFIG_KEY_CLIENT_ID)),t.setSessionId(f.cl_Id.cl_ad),t.setSequenceNumber(f.cl_Jp),t.setProtocolVersion(E.version),t.setClientVersion(i.version),t.setInstanceId(f.cl_hf.getId()),t.setCapfield(0),null!=f.cl_xp&&t.setConnectionType(f.cl_xp),null!=f.cl_Fp&&t.setLinkEncryption(f.cl_Fp),P.isValidString(f.cl_mg)&&t.setCDNServerIP(f.cl_mg),t.setPlatformMetadataSchema(E.SDK_METADATA_SCHEMA),null!=f.cl_ag&&t.setBrowserName(f.cl_ag),null!=f.cl_cg&&t.setBrowserVersion(f.cl_cg),null!=f.cl_ug&&t.setDeviceBrand(f.cl_ug),null!=f.cl_lg&&t.setDeviceManufacturer(f.cl_lg),null!=f.cl_dg&&t.setDeviceModel(f.cl_dg),null!=f.cl__g&&t.setDeviceType(f.cl__g),null!=f.cl_hg&&t.setDeviceVersion(f.cl_hg),null!=f.cl_fg&&t.setFrameworkName(f.cl_fg),null!=f.cl_pg&&t.setFrameworkVersion(f.cl_pg),null!=f.cl_gg&&t.setOperatingSystemName(f.cl_gg),null!=f.cl_Eg&&t.setOperatingSystemVersion(f.cl_Eg),null!=f.cl_Ag&&t.setDeviceCategory(f.cl_Ag),null!=f.cl__f&&(f.cl_wp=f.cl__f.getModuleName(),null!=f.cl_wp&&t.setModuleName(f.cl_wp)),null!=f.cl__f&&(f.cl_kp=f.cl__f.getModuleVersion(),null!=f.cl_kp&&t.setModuleVersion(f.cl_kp)),null!=f.cl_ap&&t.setViewerId(f.cl_ap),P.dictCount(f.cl_og)>0&&t.setTags(f.cl_og),f.isVideoSession()||f.isAdSession()){f.isAdSession()&&t.setIsAdSession(),null!=f.cl_rp&&t.setAssetName(f.cl_rp),t.setSessionFlags(f.cl_Zp);var n=E.convertPlayerState(f.cl_Pp);t.setPlayerState(n),t.setPauseJoin(f.cl_yg),null!=f.cl_rg&&t.setPlayerName(f.cl_rg),null!=f.cl_sg&&t.setIsLive(f.cl_sg),f.cl_ng>0&&t.setContentLength(f.cl_ng),f.cl_Rp>0&&t.setBitrate(f.cl_Rp),null!==f.cl_ig&&t.setResource(f.cl_ig),f.cl_dp>0&&t.setEncodedFrameRate(f.cl_dp);var r,s,o;null!=f.cl__f&&(r=O.Integer(f.cl__f.getPHT(),0,null,-1),s=O.Integer(f.cl__f.getBufferLength(),0,null,-1),o=f.cl__f.getSignalStrength()),r>=0&&t.setPlayheadTime(r),s>0&&t.setBufferLength(s);var a=f.updateAverageFrameRate();a>0&&t.setAverageFrameRate(a),f.cl_Rg>0&&t.setRfpsTotal(O.Integer(f.cl_Rg,0,null,-1)),f.cl_bg>0&&t.setRfpsObservationCount(O.Integer(f.cl_bg,0,null,-1)),0>=o&&t.setSignalStrength(o),null!=f.cl_up&&t.setStreamUrl(f.cl_up),f.cl_Mp>0&&t.setStreamWidth(f.cl_Mp),f.cl_Up>0&&t.setStreamHeight(f.cl_Up)}else t.setSessionFlags(E.SessionFlags.GLOBAL);if(e.length>0&&t.setEvents(e),t.setCapabilities(f.cl_$p),t.setIsSdkClient(!0),f.cl_qp.get(C.CONFIG_KEY_SEND_LOGS)&&t.setLogs(f.cl_Sp.flush()),f.cl_qp.get(C.CONFIG_KEY_MAX_HEARTBEAT_INFOS)>0){var c=f.compileHeartbeatInfos();c.length>0&&t.setHeartbeatInfos(c)}return t.setSessionStartTime(f.cl_Xp),t.setSessionTime(f.getSessionTime()),f.cl_Jp++,t.get()},this.sendHeartbeat=function(){if(!f.cl_vg){var e=f.makeHeartbeat();null!=e&&f.postHeartbeat(e)}},this.countRfps=function(){if(f.cl_Pp===a.PlayerState.PLAYING){var e=f.cl__f.getRenderedFrameRate();e>=0&&(f.cl_Rg+=e,f.cl_bg++)}},this.updateAverageFrameRate=function(){if(f.cl_Pp===a.PlayerState.PLAYING){var e=f.cl__f.getRenderedFrameRate();if(e>=0){f.cl_Rg+=e,f.cl_bg++;var t=P.Int32.Cast(1*f.cl_Rg/f.cl_bg);return t}return-1}return-1},this.postHeartbeat=function(e){f.createHeartbeatInfo();var t=f.cl_Jp-1;f.cl_Fn.info("postHeartbeat(): Send HB["+t+"]"+f.sessionTypeTag());var i=function(e,i){f.onHeartbeatResponse(e,i,t)};f.cl_jp.send(e,i)},this.onHeartbeatResponse=function(e,t,i){f.cl_vg||f.cl_Xf.runProtected("onHeartbeatResponse",function(){if(e){var n=t;if(null!=n){f.cl_Fn.debug("onHeartbeatResponse(): received valid response for HB["+i+"]"),f.updateHeartbeatInfoOnSuccess(i);var r=n[E.RESPONSE_KEY_CLIENT_ID];null!=r&&r!=f.cl_qp.get(C.CONFIG_KEY_CLIENT_ID)&&(f.cl_Fn.debug("onHeartbeatResponse(): setting the client id to "+r+" (from gateway)"),f.cl_qp.set(C.CONFIG_KEY_CLIENT_ID,r),f.cl_qp.save());var s=n[E.RESPONSE_KEY_STATUS];null!=s&&s!=E.RESPONSE_STATUS_NO_ERRORS&&f.cl_Fn.error("onHeartbeatResponse(): error from gateway: "+s);var o=n[E.RESPONSE_KEY_CONFIG];if("object"==typeof o){var a=o[E.RESPONSE_CONFIG_KEY_MAX_HEARTBEAT_INFOS];null!=a&&f.cl_qp.get(C.CONFIG_KEY_MAX_HEARTBEAT_INFOS)!==a&&(f.cl_Fn.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+a+" (from gateway)"),f.cl_qp.set(C.CONFIG_KEY_MAX_HEARTBEAT_INFOS,a));var c=o[E.RESPONSE_CONFIG_KEY_SEND_LOGS],u=null!=c&&P.AsBoolean(c);u!==f.cl_qp.get(C.CONFIG_KEY_SEND_LOGS)&&(f.cl_Fn.debug("onHeartbeatResponse(): turning "+(u?"on":"off")+" sending of logs"),f.cl_qp.set(C.CONFIG_KEY_SEND_LOGS,u));var l=o[E.RESPONSE_CONFIG_KEY_HEARTBEAT_INTERVAL];if(null!=l){var d=P.Int32.Cast(l),_=d;_!=f.cl_yp.heartbeatInterval&&(f.cl_Fn.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+_),f.cl_yp.heartbeatInterval=_,null!=f.cl_zp&&f.resetHeartbeatTimer())}var h=o[E.RESPONSE_CONFIG_KEY_GATEWAY_URL];null!=h&&h!=f.cl_yp.gatewayUrl&&(f.cl_Fn.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+h),f.cl_yp.gatewayUrl=h)}}else f.cl_Fn.warning("onHeartbeatResponse(): decoded heartbeat response is null.")}else{var p=t;P.isValidString(p)?P.stringStartsWith(p,"HTTP timeout")?f.cl_Fn.warning("onHeartbeatResponse(): "+p):f.cl_Fn.error("onHeartbeatResponse(): failed to send heartbeat: "+p):(p=S.DEFAULT_HEARTBEAT_ERROR_MESSAGE,f.cl_Fn.error("onHeartbeatResponse(): "+p)),f.updateHeartbeatInfoOnFailure(i,p)}})},this.getSessionTime=function(){var e=P.Int32.Cast(f.cl_Qp.current()-f.cl_Xp);return e},this.getNextEventNumber=function(){return this.cl_Gp.getNumber()},this.sessionTypeTag=function(){return this.isGlobalSession()?" (global session)":""},this.isGlobalSession=function(){return this.cl_Pg==y.SESSION_TYPE.GLOBAL},this.isVideoSession=function(){return this.cl_Pg==y.SESSION_TYPE.VIDEO},this.isAdSession=function(){return this.cl_Pg==y.SESSION_TYPE.AD}};y.DEFAULT_VIDEO_SESSION_FLAGS=E.SessionFlags.VIDEO+E.SessionFlags.QUALITY_METRICS+E.SessionFlags.BITRATE_METRICS,y.SESSION_TYPE={VIDEO:"Video",GLOBAL:"Global",AD:"Ad"};var S=(t.IMonitor=function(){this.onPlayerStateChange=function(e){},this.onBitrateChange=function(e){},this.onSeekEvent=function(e,t){},this.onEncodedFrameRateChange=function(e){},this.onRenderedFrameRateChange=function(e){},this.onContentLengthChange=function(e){},this.onPlayheadTimeChange=function(e){},this.onStreamUrlChange=function(e){},this.onBufferLengthChange=function(e){},this.onPlayerTypeChange=function(e){},this.onPlayerVersionChange=function(e){},this.onStreamResolutionWidthChange=function(e){},this.onStreamResolutionHeightChange=function(e){},this.onConnectionTypeChange=function(e){},this.onLinkEncryptionChange=function(e){},this.onSignalStrengthChange=function(e){},this.onError=function(e,t){},this.onRelease=function(){},this.onCDNServerIPChange=function(e){}},t.Session=function(){function t(e,t,i,n,r,s,o,a){this.cl_ad=e,this.cl_Pg=t,this.cl_ff=i,this.cl_qp=n,this.cl_Ng=r,this.cl_Lg=s,this.cl_Xf=o,this.cl_Fn=a,this.cl_Fn.setModuleName("Session"),this.cl_Fn.setSessionId(P.ToString(this.cl_ad))}var i=this;i.cl_ff=null,i.cl__f=null,i.cl_ad=0,i.cl_Pg=y.SESSION_TYPE.VIDEO,i.cl_Dg=!1,i.cl_vg=!1,i.cl_Og=!1,i.cl_wg=null,i.cl_kg=null,i.cl_Mg=null,i.cl_Ug=!1,i.cl_xg=a.PlayerState.NOT_MONITORED,i.cl_Fg=!1,i.cl_Bg=!1,i.cl_Vg=!1,i.cl_Yg=!1,t.apply(i,arguments),this.start=function(){if(i.isVideoSession()||i.isAdSession()?i.cl_Fn.info("start(): assetName="+i.cl_ff.assetName):i.cl_Fn.info("start()"+i.sessionTypeTag()),i.cl_Lg.start(this),i.cl_qp.isReady())i.initiateSession();else{var e=function(){i.initiateSession()};i.cl_qp.register(e)}},this.cleanup=function(){if(i.cl_Fn.info("cleanup()"+i.sessionTypeTag()),i.cl_Dg=!0,i.cl_Lg.willEndSoon(),i.cl_qp.isReady())i.endCwsSessionAndCleanupAll();else{var e=function(){i.endCwsSessionAndCleanupAll()};i.cl_qp.register(e)}},this.cleanupAll=function(){i.cl_Fn.debug("cleanupAll()"+i.sessionTypeTag()),(i.isVideoSession()||i.isAdSession())&&null!=i.cl__f&&i.detachPlayer(),i.cl_ff=null,i.cl_Fn.setSessionId(null),i.cl_Fn=null,i.cl_Xf=null,i.cl_hf=null,i.cl_qp=null,i.cl_Ng=null,i.cl_Lg.cleanup(),i.cl_Lg=null,i.cl_vg=!0},this.endCwsSessionAndCleanupAll=function(){i.cl_Lg.end(),i.cleanupAll()},this.initiateSession=function(){i.cl_Lg.initialize(),i.setStatesFromSystemMetadata(),(i.isVideoSession()||i.isAdSession())&&(i.setStatesFromContentMetadata(),i.enqueueEventForContentMetadata()),i.cl_Lg.startSendingHeartbeats()},this.enqueueEventForContentMetadata=function(){var t={};if(null!=i.cl_ff.assetName?t[E.REQUEST_KEY_ASSET_NAME]=i.cl_ff.assetName:i.cl_Fn.warning("enqueueEventForContentMetadata(): assetName was not set."),null!=i.cl_ff.applicationName?("undefined"==typeof t[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(t[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),t[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_PLAYER_NAME]=i.cl_ff.applicationName):i.cl_Fn.warning("enqueueEventForContentMetadata(): applicationName was not set."),null!=i.cl_ff.streamUrl?t[E.REQUEST_KEY_STREAM_URL]=i.cl_ff.streamUrl:i.cl_Fn.warning("enqueueEventForContentMetadata(): streamUrl was not set."),null!=i.cl_ff.viewerId?("undefined"==typeof t[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(t[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),t[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_VIEWER_ID]=i.cl_ff.viewerId):i.cl_Fn.warning("enqueueEventForContentMetadata(): viewerId was not set."),null!=i.cl_ff.defaultResource?t[E.REQUEST_KEY_RESOURCE]=i.cl_ff.defaultResource:i.cl_Fn.warning("enqueueEventForContentMetadata(): defaultResource was not set."),i.cl_ff.duration>-1?t[E.REQUEST_KEY_CONTENT_LENGTH]=i.cl_ff.duration:i.cl_Fn.warning("enqueueEventForContentMetadata(): duration was not set."),i.cl_ff.encodedFrameRate>-1?t[E.REQUEST_KEY_ENCODED_FRAME_RATE]=i.cl_ff.encodedFrameRate:i.cl_Fn.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),i.cl_ff.streamType!=r.StreamType.UNKNOWN?i.cl_ff.streamType==e.ContentMetadata.StreamType.LIVE?t[E.REQUEST_KEY_IS_LIVE]=!0:t[E.REQUEST_KEY_IS_LIVE]=!1:i.cl_Fn.warning("enqueueEventForContentMetadata(): streamType was not set."),P.dictCount(i.cl_ff.custom)>0){t[E.REQUEST_KEY_TAGS]={};for(var n in i.cl_ff.custom)t[E.REQUEST_KEY_TAGS][n]=i.cl_ff.custom[n]}else i.cl_Fn.warning("enqueueEventForContentMetadata(): custom tags were not set.");P.dictCount(t)>0&&i.cl_Lg.declareStateChange(t,null)},this.setStatesFromSystemMetadata=function(){i.cl_Fn.debug("setStatesFromSystemMetadata()");var e=i.cl_Ng.get(),t=e[U.BROWSER_NAME];null!=t&&i.cl_Lg.setBrowserName(t);var n=e[U.BROWSER_VERSION];null!=n&&i.cl_Lg.setBrowserVersion(n);var r=e[U.DEVICE_BRAND];null!=r&&i.cl_Lg.setDeviceBrand(r);var s=e[U.DEVICE_MANUFACTURER];null!=s&&i.cl_Lg.setDeviceManufacturer(s);var o=e[U.DEVICE_MODEL];null!=o&&i.cl_Lg.setDeviceModel(o);var a=e[U.DEVICE_TYPE];null!=a&&i.cl_Lg.setDeviceType(a);var c=e[U.DEVICE_VERSION];null!=c&&i.cl_Lg.setDeviceVersion(c);var u=e[U.FRAMEWORK_NAME];null!=u&&i.cl_Lg.setFrameworkName(u);var l=e[U.FRAMEWORK_VERSION];null!=l&&i.cl_Lg.setFrameworkVersion(l);var d=e[U.OPERATING_SYSTEM_NAME];null!=d&&i.cl_Lg.setOperatingSystemName(d);var _=e[U.OPERATING_SYSTEM_VERSION];null!=_&&i.cl_Lg.setOperatingSystemVersion(_);var h=e[U.DEVICE_CATEGORY];null!=h&&i.cl_Lg.setDeviceCategory(h)},this.setStatesFromContentMetadata=function(){if(i.cl_Fn.debug("setStatesFromContentMetadata()"),null!=i.cl_ff.defaultResource&&i.cl_Lg.setResource(i.cl_ff.defaultResource),null!=i.cl_ff.streamUrl&&i.cl_Lg.setStreamUrl(i.cl_ff.streamUrl),i.cl_ff.duration>0&&i.cl_Lg.setContentLength(i.cl_ff.duration),i.cl_ff.encodedFrameRate>0&&i.cl_Lg.setEncodedFrameRate(i.cl_ff.encodedFrameRate),i.cl_ff.streamType!==r.StreamType.UNKNOWN){var e=i.cl_ff.streamType===r.StreamType.LIVE;i.cl_Lg.setIsLive(e)}null!=i.cl_ff.assetName&&i.cl_Lg.setAssetName(i.cl_ff.assetName),null!=i.cl_ff.viewerId&&i.cl_Lg.setViewerId(i.cl_ff.viewerId),null!=i.cl_ff.applicationName&&i.cl_Lg.setPlayerName(i.cl_ff.applicationName),P.dictCount(i.cl_ff.custom)>0&&i.cl_Lg.setTags(i.cl_ff.custom)},this.onPlayerStateChange=function(e){return i.cl_Fn.debug("onPlayerStateChange(): "+e),i.cl_Lg.cl_Pp!=e?(i.cl_Lg.cl_Pp==a.PlayerState.NOT_MONITORED&&e!=a.PlayerState.NOT_MONITORED&&(i.cl_xg=e),i.cl_Ug?void i.cl_Fn.debug("onPlayerStateChange(): "+e+" (pooled, "+(i.cl_Og?"ad playing":"preloading")+")"):void i.cl_Lg.setPlayerState(e)):void 0},this.onBitrateChange=function(e){return i.cl_Fn.debug("onBitrateChange(): "+e),i.cl_Fg?void i.cl_Fn.info("onBitrateChange(): ignored"):void i.cl_Lg.setBitrateKbps(e)},this.onSeekEvent=function(e,t){null==t||P.isInteger(t)||(i.cl_Fn.error("onSeekEvent(): Ignored non-integer seekToPosition data: "+t),
t=-1),i.cl_Lg.enqueueSeekEvent(e,t)},this.onEncodedFrameRateChange=function(e){i.cl_Fn.debug("onEncodedFrameRateChange(): "+e),i.cl_ff.encodedFrameRate>0||(e>0?i.cl_Vg?i.cl_Fn.info("onEncodedFrameRateChange(): Ignored encoded frame rate data: "+e+" (ads)"):(i.cl_Lg.setEncodedFrameRate(e),i.cl_Fn.info("onEncodedFrameRateChange(): Received encoded frame rate data: "+e)):i.cl_Fn.warning("onEncodedFrameRateChange(): Ignored invalid encoded frame rate data: "+e))},this.onContentLengthChange=function(e){i.cl_Fn.debug("onContentLengthChange(): "+e),i.cl_ff.duration>0||(e>0?i.cl_Vg?i.cl_Fn.info("setContentLength(): Ignored content length data: "+e+" (ads)"):(i.cl_Lg.setContentLength(e),i.cl_Fn.info("setContentLength(): Received content length data: "+e)):i.cl_Fn.warning("setContentLength(): Ignored invalid content length data: "+e))},this.onStreamUrlChange=function(e){i.cl_Fn.debug("onStreamUrlChange(): "+e),null==i.cl_ff.streamUrl&&i.cl_Lg.setStreamUrl(e)},this.onStreamResolutionWidthChange=function(e){i.cl_Fn.debug("onStreamResolutionWidthChange(): "+e),i.cl_Lg.setStreamResolutionWidth(e)},this.onStreamResolutionHeightChange=function(e){i.cl_Fn.debug("onStreamResolutionHeightChange(): "+e),i.cl_Lg.setStreamResolutionHeight(e)},this.onConnectionTypeChange=function(e){i.cl_Fn.debug("onConnectionTypeChange(): "+e),i.cl_Lg.setConnectionType(e)},this.onLinkEncryptionChange=function(e){i.cl_Fn.debug("onLinkEncryptionChange(): "+e),i.cl_Lg.setLinkEncryption(e)},this.onPlayerTypeChange=function(e){i.cl_Fn.debug("onPlayerTypeChange(): "+e),null==i.cl_Lg.getFrameworkName()&&i.cl_Lg.setFrameworkName(e)},this.onPlayerVersionChange=function(e){i.cl_Fn.debug("onPlayerVersionChange(): "+e),null==i.cl_Lg.getFrameworkVersion()&&i.cl_Lg.setFrameworkVersion(e)},this.onCDNServerIPChange=function(e){i.cl_Fn.debug("onCDNServerIPChange(): "+e),i.cl_Lg.setCDNServerIP(e)},this.onError=function(e,t){i.cl_Fn.debug("onError(): "+e+" ("+t+")"),i.reportError(e,t)},this.onRelease=function(){i.cl_Fn.debug("onRelease()"),i.detachPlayer()},this.adStart=function(t,n,r){return i.cl_Fn.debug("adStart(): adStream="+t+" adPlayer="+n+" adPosition="+r),i.cl_Og?void i.cl_Fn.warning("adStart(): multiple adStart calls, ignoring"):(i.cl_Og=!0,i.cl_wg=t,i.cl_kg=n,i.cl_Mg=r,i.cl_Lg.cl_Sg||i.cl_Lg.togglePauseJoin(!0),void(i.cl_wg==e.Client.AdStream.CONTENT||i.cl_kg==e.Client.AdPlayer.SEPARATE?(i.cl_Lg.cl_Pp!==a.PlayerState.NOT_MONITORED&&(i.cl_xg=i.cl_Lg.cl_Pp),i.cl_Lg.setPlayerState(a.PlayerState.NOT_MONITORED),i.cl_Ug=!0):i.cl_wg==e.Client.AdStream.SEPARATE&&i.cl_kg==e.Client.AdPlayer.CONTENT&&(i.cl_Lg.cl_Pp!==a.PlayerState.NOT_MONITORED&&(i.cl_xg=i.cl_Lg.cl_Pp),i.cl_Lg.setPlayerState(a.PlayerState.NOT_MONITORED),i.cl_Ug=!0,i.cl_Fg=!0,i.cl_Vg=!0,i.cl_Bg=!0,i.cl_Yg=!0)))},this.adEnd=function(){return i.cl_Fn.debug("adEnd()"),i.cl_Og?(i.cl_Lg.cl_Sg||i.cl_Lg.togglePauseJoin(!1),i.cl_wg==e.Client.AdStream.CONTENT||i.cl_kg==e.Client.AdPlayer.SEPARATE?i.cl_Kg||(i.cl_Ug=!1,i.cl_Lg.setPlayerState(i.cl_xg)):i.cl_wg==e.Client.AdStream.SEPARATE&&i.cl_kg==e.Client.AdPlayer.CONTENT&&(i.cl_Fg=!1,i.cl_Vg=!1,i.cl_Bg=!1,i.cl_Yg=!1,i.cl_Kg||(i.cl_Ug=!1,i.cl_Lg.setPlayerState(i.cl_xg))),i.cl_Og=!1,void(i.cl_wg=i.cl_kg=i.cl_Mg=null)):void i.cl_Fn.debug("adEnd(): called before adStart, ignoring")},this.detachPlayer=function(){i.cl_Fn.debug("detachPlayer()"),null!==i.cl__f&&(i.cl_Xf.runProtected("Session.detachPlayer",function(){i.cl__f.removeMonitoringNotifier()}),i.cl__f=null,i.cl_Lg.setPlayerStateManager(null),i.cl_Lg.setPlayerState(a.PlayerState.NOT_MONITORED))},this.attachPlayer=function(e){return i.cl_Fn.debug("attachPlayer()"),null!=i.cl__f?void i.cl_Fn.error("attachPlayer(): detach current PlayerStateManager first"):void i.cl_Xf.runProtected("Session.attachPlayer()",function(){e.setMonitoringNotifier(i,i.cl_ad)?(e.pushCurrentState(),i.cl__f=e,i.cl_Lg.setPlayerStateManager(i.cl__f)):i.cl_Fn.error("attachPlayer(): instance of PlayerStateManager is already attached to a session")})},this.getPlayerStateManager=function(){return i.cl_Fn.debug("getPlayerStateManager()"),i.cl__f},this.contentPreload=function(){return i.cl_Fn.debug("contentPreload()"),i.cl_Kg?void i.cl_Fn.debug("contentPreload(): called twice, ignoring"):(i.cl_Kg=!0,void(i.cl_Ug=!0))},this.contentStart=function(){return i.cl_Fn.debug("contentStart()"),i.cl_Kg?(i.cl_Kg=!1,void(i.cl_Og||(i.cl_Ug=!1,i.cl_Lg.setPlayerState(i.cl_xg)))):void i.cl_Fn.warning("contentStart(): called without contentPreload, ignoring")},this.reportError=function(t,n){if(i.cl_Fn.info("reportError(): "+t),!P.isValidString(t))return void i.cl_Fn.error("reportError(): invalid error message string: "+t);if(n!==e.Client.ErrorSeverity.FATAL&&n!==e.Client.ErrorSeverity.WARNING)return void i.cl_Fn.error("reportError(): invalid error severity: "+n);if(i.cl_Yg)return void i.cl_Fn.debug("reportError(): ignored");var r=n===e.Client.ErrorSeverity.FATAL;i.cl_Lg.sendError(t,r)},this.updateContentMetadata=function(e){i.cl_Fn.debug("updateContentMetadata(): enter"),i.cl_Xf.runProtected("Session.updateContentMetadata",function(){i.mergeContentMetadata(e),i.setStatesFromContentMetadata()})},this.sendCustomEvent=function(e,t){i.cl_Fn.info("sendEvent(): eventName="+e+i.sessionTypeTag()),i.cl_Lg.enqueueCustomEvent(e,t)},this.mergeContentMetadata=function(t){var n={},s={};if(P.isValidString(t.assetName)&&(i.cl_ff.assetName!=t.assetName?(null!=i.cl_ff.assetName&&(n[E.REQUEST_KEY_ASSET_NAME]=i.cl_ff.assetName),s[E.REQUEST_KEY_ASSET_NAME]=t.assetName,i.cl_ff.assetName=t.assetName):i.cl_Fn.warning("mergeContentMetadata(): assetName was not changed.")),P.isValidString(t.applicationName)&&(i.cl_ff.applicationName!=t.applicationName?(null!=i.cl_ff.applicationName&&("undefined"==typeof n[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(n[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),n[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_PLAYER_NAME]=i.cl_ff.applicationName),"undefined"==typeof s[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(s[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),s[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_PLAYER_NAME]=t.applicationName,i.cl_ff.applicationName=t.applicationName):i.cl_Fn.warning("mergeContentMetadata(): applicationName was not changed.")),P.isValidString(t.streamUrl)&&(i.cl_ff.streamUrl!=t.streamUrl?(null!=i.cl_ff.streamUrl&&(n[E.REQUEST_KEY_STREAM_URL]=i.cl_ff.streamUrl),s[E.REQUEST_KEY_STREAM_URL]=t.streamUrl,i.cl_ff.streamUrl=t.streamUrl):i.cl_Fn.warning("mergeContentMetadata(): streamUrl was not changed.")),P.isValidString(t.viewerId)&&(i.cl_ff.viewerId!=t.viewerId?(null!=i.cl_ff.viewerId&&("undefined"==typeof n[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(n[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),n[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_VIEWER_ID]=i.cl_ff.viewerId),"undefined"==typeof s[E.REQUEST_KEY_STREAM_METADATA_CHANGE]&&(s[E.REQUEST_KEY_STREAM_METADATA_CHANGE]={}),s[E.REQUEST_KEY_STREAM_METADATA_CHANGE][E.REQUEST_KEY_VIEWER_ID]=t.viewerId,i.cl_ff.viewerId=t.viewerId):i.cl_Fn.warning("mergeContentMetadata(): viewerId was not changed.")),P.isValidString(t.defaultResource)&&(i.cl_ff.defaultResource!=t.defaultResource?(null!=i.cl_ff.defaultResource&&(n[E.REQUEST_KEY_RESOURCE]=i.cl_ff.defaultResource),s[E.REQUEST_KEY_RESOURCE]=t.defaultResource,i.cl_ff.defaultResource=t.defaultResource):i.cl_Fn.warning("mergeContentMetadata(): defaultResource was not changed.")),P.isInteger(t.duration)&&t.duration>0&&(i.cl_ff.duration!=t.duration?(i.cl_Lg.cl_ng>0&&(n[E.REQUEST_KEY_CONTENT_LENGTH]=i.cl_Lg.cl_ng),s[E.REQUEST_KEY_CONTENT_LENGTH]=t.duration,i.cl_ff.duration=t.duration):i.cl_Fn.warning("mergeContentMetadata(): duration was not changed.")),P.isInteger(t.encodedFrameRate)&&t.encodedFrameRate>0&&(i.cl_ff.encodedFrameRate!=t.encodedFrameRate?(i.cl_ff.encodedFrameRate>-1&&(n[E.REQUEST_KEY_ENCODED_FRAME_RATE]=i.cl_ff.encodedFrameRate),s[E.REQUEST_KEY_ENCODED_FRAME_RATE]=t.encodedFrameRate,i.cl_ff.encodedFrameRate=t.encodedFrameRate):i.cl_Fn.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),t.streamType!=r.StreamType.UNKNOWN&&(i.cl_ff.streamType!=t.streamType?(i.cl_ff.streamType!=r.StreamType.UNKNOWN&&(i.cl_ff.streamType==e.ContentMetadata.StreamType.LIVE?n[E.REQUEST_KEY_IS_LIVE]=!0:n[E.REQUEST_KEY_IS_LIVE]=!1),t.streamType==e.ContentMetadata.StreamType.LIVE?s[E.REQUEST_KEY_IS_LIVE]=!0:s[E.REQUEST_KEY_IS_LIVE]=!1,i.cl_ff.streamType=t.streamType):i.cl_Fn.warning("mergeContentMetadata(): streamType was not changed.")),P.dictCount(t.custom)>0){var o={},a={};for(var c in t.custom){var u=i.cl_ff.custom[c];u!=t.custom[c]?(o[c]=t.custom[c],i.cl_ff.custom[c]&&(a[c]=i.cl_ff.custom[c]),i.cl_ff.custom[c]=t.custom[c]):i.cl_Fn.info("mergeContentMetadata(): custom."+c+" was not changed.")}P.dictCount(o)>0?(P.dictCount(a)>0&&(n[E.REQUEST_KEY_TAGS]=a),s[E.REQUEST_KEY_TAGS]=o):i.cl_Fn.warning("mergeContentMetadata(): custom was not changed.")}P.dictCount(s)>0&&i.cl_Lg.declareStateChange(s,n)},this.isGlobalSession=function(){return i.cl_Pg==y.SESSION_TYPE.GLOBAL},this.isVideoSession=function(){return i.cl_Pg==y.SESSION_TYPE.VIDEO},this.isAdSession=function(){return i.cl_Pg==y.SESSION_TYPE.AD},this.sessionTypeTag=function(){return i.isGlobalSession()?" (global session)":""}});S.DEFAULT_HEARTBEAT_ERROR_MESSAGE="received no response (or a bad response) to heartbeat POST request";var v=t.SessionFactory=function(){function e(e,i,n,r){t.cl_hf=e,t.cl_yp=i,t.cl_qp=n,t.cl_pf=r,t.cl_Fn=t.cl_pf.buildLogger(),t.cl_Fn.setModuleName("SessionFactory"),t.cl_Gg=0,t.cl_Hg={}}var t=this;t.cl_Fn=null,t.cl_Sp=null,t.cl_Gg=0,t.cl_Hg=null,e.apply(t,arguments),this.cleanup=function(){t.cl_Fn=null,t.cl_Sp=null;for(var e in t.cl_Hg){var i=t.cl_Hg[e];i.cleanup()}t.cl_Hg=null,t.cl_Gg=0},this.newSessionKey=function(){var e=t.cl_Gg;return t.cl_Gg++,e},this.makeVideoSession=function(e,i){return null==e&&(e=new r),t.makeSession(e,i)},this.makeGlobalSession=function(e){return t.makeSession(e,y.SESSION_TYPE.GLOBAL)},this.generateSessionId=function(){return D.integer32()},this.makeSession=function(e,i){var n=e.clone(),r=t.generateSessionId(),s=t.cl_pf.buildSession(t.cl_hf,t.cl_yp,t.cl_qp,r,i,n),o=t.newSessionKey();return t.addSession(o,s),s.start(),o},this.getSession=function(e){var i=t.cl_Hg[e];return null==i&&t.cl_Fn.error("Client: invalid sessionKey. Did you cleanup that session previously?"),i},this.getVideoSession=function(e){var i=this.getSession(e);return null!=i&&(i.isVideoSession()||i.isAdSession()||(t.cl_Fn.error("Client: invalid sessionKey. Did you cleanup that session previously?"),i=null)),i},this.addSession=function(e,i){t.cl_Hg[e]=i},this.removeSession=function(e){delete t.cl_Hg[e]},this.cleanupSession=function(e){var i=t.getSession(e);t.removeSession(e),i.cleanup()}},T=t.CallbackWithTimeout=function(e){this.cl_Hp=e,this.getWrapperCallback=function(e,t,i){var n=!1,r=function(){n||(n=!0,e(!1,i+" ("+t+" ms)"))};this.cl_Hp.createOnce(r,t,"CallbackWithTimeout.wrap");var s=function(t,i){n||(n=!0,e(t,i))};return s}},C=t.Config=function(e,t,i){var n=this;this.cl_Fn=e,this.cl_Fn.setModuleName("Config"),this.cl_Il=t,this.cl_jg=i,this.cl_Wg={clientId:E.DEFAULT_CLIENT_ID,sendLogs:!1,maxHbInfos:E.DEFAULT_MAX_HEARTBEAT_INFOS},this.cl_Q=P.ObjectShallowCopy(this.cl_Wg),this.cl_Qg=!1,this.cl_qg=!1,this.cl_zg=[],this.isReady=function(){return this.cl_Qg},this.load=function(){var e=function(e,t){e?(n.cl_Xg(t),n.cl_Fn.debug("load(): configuration successfully loaded from local storage"+(n.cl_qg?" (was empty)":"")+".")):n.cl_Fn.error("load(): error loading configuration from local storage: "+t),n.cl_Qg=!0,n.cl_Jg()};this.cl_Il.load(C.STORAGE_KEY,e)},this.cl_Xg=function(e){var t=this.cl_jg.decode(e);if(null==t)return void(this.cl_qg=!0);var i=t[C.CONFIG_STORAGE_KEY_CLIENT_ID];null!=i&&i!=E.DEFAULT_CLIENT_ID&&""!=i&&"null"!=i&&(this.cl_Q[C.CONFIG_KEY_CLIENT_ID]=i,this.cl_Fn.debug("parse(): loaded clientId="+i+" (from local storage)"))},this.cl_Zg=function(){var e={};return e[C.CONFIG_STORAGE_KEY_CLIENT_ID]=this.cl_Q.clientId,this.cl_Fn.debug("_marshall(): saving clientId="+this.cl_Q.clientId+" (to local storage)"),this.cl_jg.encode(e)},this.save=function(){var e=function(e,t){e?n.cl_Fn.debug("save(): configuration successfully saved to local storage."):n.cl_Fn.error("save(): error saving configuration to local storage: "+t)};this.cl_Il.save(C.STORAGE_KEY,this.cl_Zg(),e)},this.register=function(e){return this.isReady()?void e():void this.cl_zg.push(e)},this.get=function(e){return this.cl_Qg?this.cl_Q[e]:null},this.set=function(e,t){this.cl_Qg&&(this.cl_Q[e]=t)},this.cl_Jg=function(){for(var e;null!=(e=this.cl_zg.shift());)e()}};C.STORAGE_KEY="sdkConfig",C.CONFIG_STORAGE_KEY_CLIENT_ID="clId",C.CONFIG_KEY_CLIENT_ID="clientId",C.CONFIG_KEY_SEND_LOGS="sendLogs",C.CONFIG_KEY_MAX_HEARTBEAT_INFOS="maxHbInfos";var I=t.EventQueue=function(){this.cl_rt=[],this.cl_$g=0,this.enqueue=function(e){this.cl_rt.push(e)},this.getNumber=function(){var e=this.cl_$g;return this.cl_$g++,e},this.flush=function(){var e=this.cl_rt;return this.cl_rt=[],e}},b=t.ExceptionCatcher=function(e,t,i){this.cl_Fn=e,this.cl_Fn.setModuleName("ExceptionCatcher"),this.cl_eE=t,this.cl_$f=i,this.runProtected=function(e,t,i){try{t()}catch(t){if(null!=i)i(t);else{if(this.cl_$f.allowUncaughtExceptions)throw t;this.onUncaughtException(e,t)}}},this.onUncaughtException=function(e,t){var i="Uncaught exception: "+e+": "+t.toString();if(null!=this.cl_eE)try{this.cl_eE.send(i)}catch(e){this.cl_Fn.error("Caught exception while sending ping: "+e.toString())}this.cl_Fn.error(i)}},R=t.GatewayControl=function(e,t,i,n){var r=this;this.cl_yp=e,this.cl_Fn=t,this.cl_Fn.setModuleName("GatewayControl"),this.cl_tE=i,this.cl_jg=n,this.send=function(e,t){var i=this.cl_jg.encode(e),n=this.cl_yp.gatewayUrl+E.gatewayPath,s=function(e,i){if(e){var n=r.cl_jg.decode(i);t(e,n)}else{var s=i;t(e,s)}};this.cl_tE.request("POST",n,i,"application/json",s)}},P=t.Lang={};P.isMeaningfulString=function(e){return P.isValidString(e)&&null!=e&&"undefined"!=e&&"null"!=e},P.sanitizeStringToStringObject=function(e){var t={};for(var i in e)if(P.isMeaningfulString(i)){var n=e[i];P.isMeaningfulString(n)&&(t[i]=n)}return t},P.validateInterface=function(e,t,i){if(null==e)throw new Error("Expected "+i+" implementation is null.");for(var n in t)if("function"!=typeof e[n])throw new Error("Expected method "+n+" in "+i+" implementation.")},P.dictCount=function(e){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i},P.ToString=function(e){return""+e},P.NumberToInt=function(e){return Math.floor(e)},P.NumberToUnsignedInt=function(e){return Math.abs(P.NumberToInt(e))},P.AsBoolean=function(e){return Boolean(e)},P.isValidString=function(e){return"string"==typeof e&&""!==e},P.stringStartsWith=function(e,t){return"string"==typeof e&&"string"==typeof t&&("function"==typeof e.indexOf&&0===e.indexOf(t))},P.isBoolean=function(e){return"boolean"==typeof e},P.UrlEncodeString=function(e){return escape(e)},P.isObject=function(e){return"object"==typeof e},P.ObjectToString=function(e){var t="";for(var i in e){var n=e[i],r=n;t+=i+"="+r}return"Object{"+t+"}"},P.ObjectShallowCopyOmitNull=function(e){var t=P.ObjectShallowCopy(e);for(var i in t)null==t[i]&&delete t[i];return t},P.ObjectShallowCopy=function(e){var t={};for(var i in e)t[i]=e[i];return t},P.ObjectShallowEquals=function(e,t){if(typeof e!=typeof t)return!1;if(e instanceof Object&&t instanceof Object){if(P.dictCount(e)!==P.dictCount(t))return!1;var i=!0;for(var n in e)if(i=e[n]===t[n],!i)return!1;return!0}return e===t},P.isInteger=function(e){if("number"!=typeof e)return!1;var t=Math.round(e);return t===e},P.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},P.ArrayEquals=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;++i)if(P.isArray(e[i])&&P.isArray(t[i])){if(!P.ArrayEquals(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1;return!0},P.isObjectDefinePropertyPresent=function(){return"undefined"!=typeof Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()},P.defGet=function(e,t,i){if(P.isObjectDefinePropertyPresent())Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:i});else{if("undefined"==typeof e.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");e.__defineGetter__(t,i)}},P.defSet=function(e,t,i){if(P.isObjectDefinePropertyPresent())Object.defineProperty(e,t,{configurable:!0,set:i});else{if("undefined"==typeof e.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");e.__defineSetter__(t,i)}},function(){var e={};e.two32=4294967296,e.MaxValue=e.two32-1,e.MinValue=0,P.UInt32=e,P.UInt32.Cast=function(t){var i=parseInt(t,10);return i>e.MaxValue?i%=e.two32:i<e.MinValue&&(i=-i%e.two32,i=e.two32-i),i},P.UInt32.InRange=function(t){var i=parseInt(t,10);return i<=e.MaxValue&&i>=e.MinValue};var t={};t.MaxValue=2147483647,t.MinValue=-2147483648,P.Int32=t,P.Int32.Cast=function(e){var i=parseInt(e,10);return i>t.MaxValue?i%=t.MaxValue:i<t.MinValue&&(i=-i%t.MaxValue,i=t.MaxValue-i),i},P.Int32.InRange=function(e){var i=parseInt(e,10);return i<=t.MaxValue&&i>=t.MinValue}}();var N=t.LogBuffer=function(){var e=32;this.cl_Jl=[],this.add=function(t){this.cl_Jl.length>=e&&this.cl_Jl.shift(),this.cl_Jl.push(t)},this.flush=function(){var e=this.cl_Jl;return this.cl_Jl=[],e}},L=t.Ping=function(e,t,n){this.cl_iE=!1,this.cl_nE=null,this.cl_Fn=e,this.cl_Fn.setModuleName("Ping"),this.cl_tE=t,this.cl_yp=n,this.send=function(e){if(!this.cl_iE){this.cl_iE=!0;var t=this.getBasePingUrl()+"&d="+P.UrlEncodeString(e.toString());this.cl_Fn.error("send(): "+t),this.cl_tE.request("GET",t,null,null,null),this.cl_iE=!1}},this.getBasePingUrl=function(){if(!this.cl_nE){var e=L.SERVICE_URL+"?comp="+L.COMPONENT_NAME+"&clv="+i.version;if(this.cl_yp&&(e+="&cid="+this.cl_yp.customerKey),e+="&sch="+E.SDK_METADATA_SCHEMA,!this.cl_yp)return e;this.cl_nE=e}return this.cl_nE}};L.COMPONENT_NAME="sdkjs",L.SERVICE_URL="https://pings.conviva.com/ping.ping";var D=t.Random={};D.maxUInt32=4294967295,D.maxInt32=2147483647,D.minInt32=-2147483648,D.integer32=function(){return Math.floor(Math.random()*D.maxUInt32)+D.minInt32},D.uinteger32=function(){return Math.floor(Math.random()*D.maxUInt32)};var O=t.Sanitize={};O.Integer=function(e,t,i,n){if(isNaN(e))return n;if("number"!=typeof e)return n;if(e==n)return n;var r=P.NumberToInt(e);return O.EnforceBoundaries(r,t,i)},O.EnforceBoundaries=function(e,t,i){return null!=i&&e>i?e=i:null!=t&&t>e&&(e=t),e},O.sanitizeSpecialIntegerValue=function(e){return-1==e||-2==e?e:e=O.Integer(e,0,null,-1)};var w=(t.StreamerError=function(){function e(e,i){t.errorCode=e,t.severity=i}var t=this;t.errorCode=null,t.severity=i.ErrorSeverity.FATAL,e.apply(t,arguments)},t.HttpClient=function(e,t,i,n){this.cl_Fn=e,this.cl_Fn.setModuleName("HttpClient"),this.cl_pp=t,this.cl_rE=i,this.cl_$f=n,this.request=function(e,t,i,n,r){var s=1e3*this.cl_$f.httpTimeout,o=this.cl_rE.getWrapperCallback(r,s,"HTTP timeout");this.cl_Fn.debug("request(): calling HttpInterface.makeRequest"),this.cl_pp.makeRequest(e,t,i,n,s,o)}}),k=t.Logger=function(e,t,i,n,r){this.cl_Ap=e,this.cl_hp=t,this.cl_zf=i,this.cl_Sp=n,this.cl_mp=r,this.debug=function(e){this.log(e,o.LogLevel.DEBUG)},this.info=function(e){this.log(e,o.LogLevel.INFO)},this.warning=function(e){this.log(e,o.LogLevel.WARNING)},this.error=function(e){this.log(e,o.LogLevel.ERROR)},this.log=function(e,t){var i=this.formatMessage(e,t);this.cl_Sp.add(i),this.cl_zf.logLevel<=t&&this.cl_Ap.consoleLog(i,t)},this.prependModuleName=function(e){var t=e;return t="["+this.cl_wp+"] "+t},this.prependPackageName=function(e){var t=e;return t="["+this.cl_mp+"] "+t},this.prependConvivaNamespace=function(e){var t=e;return t="[Conviva] "+t},this.prependTime=function(e){var t=this.cl_hp.getEpochTimeMs(),i=(t/1e3).toFixed(3).toString();return"["+i+"] "+e},this.prependLogLevel=function(e,t){var i=k.getLogLevelString(t),n=e;return n="["+i+"] "+n},this.prependSessionId=function(e){var t=e;return null!=this.cl_sE&&(t="sid="+this.cl_sE+" "+t),t},this.setSessionId=function(e){this.cl_sE=e},this.setModuleName=function(e){this.cl_wp=e},this.formatMessage=function(e,t){return this.prependConvivaNamespace(this.prependTime(this.prependLogLevel(this.prependPackageName(this.prependModuleName(this.prependSessionId(e))),t)))}};k.getLogLevelString=function(e){var t;switch(e){case o.LogLevel.ERROR:t="ERROR";break;case o.LogLevel.WARNING:t="WARNING";break;case o.LogLevel.INFO:t="INFO";break;case o.LogLevel.DEBUG:t="DEBUG"}return t};var M=t.Storage=function(e,t,i,n){this.cl_Fn=e,this.cl_Fn.setModuleName("Storage"),this.cl_gp=t,this.cl_rE=i,this.cl_$f=n,this.load=function(e,t){var i=this.cl_rE.getWrapperCallback(t,1e3*this.cl_$f.storageTimeout,"storage load timeout");this.cl_Fn.debug("load(): calling StorageInterface.loadData"),this.cl_gp.loadData(M.STORAGE_SPACE,e,i)},this.save=function(e,t,i){var n=this.cl_rE.getWrapperCallback(i,1e3*this.cl_$f.storageTimeout,"storage save timeout");this.cl_Fn.debug("save(): calling StorageInterface.saveData"),this.cl_gp.saveData(M.STORAGE_SPACE,e,t,n)}};M.STORAGE_SPACE="Conviva";var U=t.SystemMetadata=function(t,i,n){this.cl_Fn=t,this.cl_Fn.setModuleName("SystemMetadata"),this.cl_Ep=i,this.cl_Xf=n,this.cl_oE=null,this.get=function(){return this.cl_oE||this.retrieve(),this.cl_oE},this.retrieve=function(){function t(e,t){n.cl_Xf.runProtected("Session.getSystemMetadataSchema(): "+e,function(){var i=t[e];t[e]=i.call(n.cl_Ep)})}var i={};i[U.BROWSER_NAME]=this.cl_Ep.getBrowserName,i[U.BROWSER_VERSION]=this.cl_Ep.getBrowserVersion,i[U.DEVICE_BRAND]=this.cl_Ep.getDeviceBrand,i[U.DEVICE_MANUFACTURER]=this.cl_Ep.getDeviceManufacturer,i[U.DEVICE_MODEL]=this.cl_Ep.getDeviceModel,i[U.DEVICE_TYPE]=this.cl_Ep.getDeviceType,i[U.DEVICE_VERSION]=this.cl_Ep.getDeviceVersion,i[U.FRAMEWORK_NAME]=this.cl_Ep.getFrameworkName,i[U.FRAMEWORK_VERSION]=this.cl_Ep.getFrameworkVersion,i[U.OPERATING_SYSTEM_NAME]=this.cl_Ep.getOperatingSystemName,i[U.OPERATING_SYSTEM_VERSION]=this.cl_Ep.getOperatingSystemVersion,i[U.DEVICE_CATEGORY]=this.cl_Ep.getDeviceCategory;var n=this;this.cl_Fn.debug("retrieve(): calling MetadataInterface methods");for(var r in i)t(r,i),P.isValidString(i[r])||delete i[r];var s=!1;if("undefined"!=typeof i[U.DEVICE_TYPE]){for(var o in e.Client.DeviceType)if(i[U.DEVICE_TYPE]===e.Client.DeviceType[o]){s=!0;break}s||delete i[U.DEVICE_TYPE]}if(s=!1,"undefined"!=typeof i[U.DEVICE_CATEGORY]){for(var a in e.Client.DeviceCategory)if(i[U.DEVICE_CATEGORY]===e.Client.DeviceCategory[a]){s=!0;break}s||delete i[U.DEVICE_CATEGORY]}this.cl_oE=P.ObjectShallowCopyOmitNull(i)}};U.BROWSER_NAME="browserName",U.BROWSER_VERSION="browserVersion",U.DEVICE_BRAND="deviceBrand",U.DEVICE_MANUFACTURER="deviceManufacturer",U.DEVICE_MODEL="deviceModel",U.DEVICE_TYPE="deviceType",U.DEVICE_VERSION="deviceVersion",U.FRAMEWORK_NAME="frameworkName",U.FRAMEWORK_VERSION="frameworkVersion",U.OPERATING_SYSTEM_NAME="operatingSystemName",U.OPERATING_SYSTEM_VERSION="operatingSystemVersion",U.DEVICE_CATEGORY="deviceCategory";var x=t.Time=function(e,t){this.cl_hp=e,this.cl_Fn=t,this.cl_Fn.setModuleName("Time"),this.current=function(){var e=this.cl_hp.getEpochTimeMs();return P.isInteger(e)||this.cl_Fn.error("current(): TimeInterface.getEpochTimeMs() did not return an integer ("+e+")"),e}},F=t.Timer=function(e,t,i){var n=this;this.cl_Fn=e,this.cl_Fn.setModuleName("Timer"),this.cl_fp=t,this.cl_Xf=i,this.create=function(e,t,i){var r=function(){n.cl_Xf.runProtected(i,function(){e()})},s=this.createTimer(r,t,i);return s},this.createOnce=function(e,t,i){var r={cancel:null},s=function(){n.cl_Xf.runProtected(i,function(){r&&"function"==typeof r.cancel&&(r.cancel(),r.cancel=null,r=null),e()})},o=this.createTimer(s,t,i);return r.cancel=o,o},this.createTimer=function(e,t,i){return this.cl_Fn.debug("createTimer(): calling TimerInterface.create"),this.cl_fp.createTimer(e,t,i)}}}()}(),e})},144:function(e,t,i){var n=i(4).Logger,r=function(e,t){this.cl_$c=e,this.cl_Fn=new n(t+".sdk.measure")};r.prototype.getPHT=function(){var e=this.cl_$c.currentTime();return this.cl_Fn.debug("Reporting Play Head Time (PHT): "+e+" sec."),Math.round(1e3*e)},r.prototype.getBufferLength=function(){var e=-1,t=null,i=this.cl_$c.cl_re();return i&&(t=i.tech_)?(e=t.cl_kr().ahead,this.cl_Fn.debug("Reporting Buffer Length: "+e+" sec."),Math.round(1e3*e)):(this.cl_Fn.debug("Reporting Buffer Length not available (-1)"),e)},r.prototype.getSignalStrength=function(){return 1e3},r.prototype.getRenderedFrameRate=function(){var e=this.cl_$c.getActiveTrackByType("video")[0];return e&&e.frameRate?e.frameRate:-1},e.exports=r},145:function(e,t,i){var n=i(18),r=function(){this.httpSend_=null};r.prototype.cl_aE=function(e,t,i,r,s,o){var a,c=o||function(){};return"application/json"===r&&(r=""),this.cl_cE=n.cl_Rr(e,t,i,{cl_Nr:r}).promise.then(function(e){clearTimeout(a),this.cl_cE=null;var t=e.data;c(!0,t)}.bind(this),function(e){clearTimeout(a),this.cl_cE=null;var t=e.currentTarget||e.target||document;c(!1,t.body)}.bind(this)),a=setTimeout(function(){this.cl_cE&&this.cl_cE.request&&this.cl_cE.request.abort()}.bind(this),s),null},r.prototype.makeRequest=function(){return this.cl_aE.apply(this,arguments)},r.prototype.release=function(){this.httpSend_&&this.httpSend_.request&&this.httpSend_.request.abort()},e.exports=r},146:function(e,t,i){var n=i(4).Logger,r=function(e,t){this.cl_uE=e,this.cl_Fn=new n(t+".logging")};r.prototype.consoleLog=function(e,t){var i=this.cl_uE.SystemSettings.LogLevel,n=/\[.+?\]\s\[[\d.]+\]\s\[.+?\]\s\[.+?\]\s+/;if("string"==typeof e&&(e=e.replace(n,"")),t===i.ERROR)this.cl_Fn.error(e);else if(t===i.WARNING){if(e.indexOf("mergeContentMetadata")>=0)return;this.cl_Fn.warn(e)}else this.cl_Fn.debug(e)},r.prototype.release=function(){},e.exports=r},147:function(e,t,i){var n=function(e){this.cl_uE=e};n.prototype.getBrowserName=function(){return null},n.prototype.getBrowserVersion=function(){return null},n.prototype.getDeviceBrand=function(){return null},n.prototype.getDeviceManufacturer=function(){return null},n.prototype.getDeviceModel=function(){return null},n.prototype.getDeviceType=function(){return null},n.prototype.getDeviceVersion=function(){return null},n.prototype.getFrameworkName=function(){return"castLabs PRESTOplay for Browsers"},n.prototype.getFrameworkVersion=function(){return String("5.1.36")||null},n.prototype.getOperatingSystemName=function(){return null},n.prototype.getOperatingSystemVersion=function(){return null},n.prototype.getDeviceCategory=function(){return this.cl_uE.Client.DeviceCategory.WEB},n.prototype.release=function(){},e.exports=n},148:function(e,t){var i=function(){};i.prototype.loadData=function(e,t,i){var n=e+"."+t;try{var r=localStorage.getItem(n);i(!0,r)}catch(e){i(!1,e.toString())}},i.prototype.saveData=function(e,t,i,n){var r=e+"."+t;try{localStorage.setItem(r,i),n(!0,null)}catch(e){n(!1,e.toString())}},i.prototype.release=function(){},e.exports=i},149:function(e,t){var i=function(){};i.prototype.getEpochTimeMs=function(){var e=new Date;return e.getTime()},i.prototype.release=function(){},e.exports=i},150:function(e,t){var i=function(){this.cl_Yu=-1};i.prototype.cl_lE=function(){this.cl_Yu!==-1&&(clearInterval(this.cl_Yu),this.cl_Yu=-1)},i.prototype.createTimer=function(e,t,i){return this.cl_Yu=setInterval(e,t),this.cl_lE.bind(this)},i.prototype.release=function(){this.cl_lE()},e.exports=i}})})}})});