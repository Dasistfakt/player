/*! @castlabs/prestoplay 5.1.38, 23-03-2020 Copyright (c) 2020 castLabs GmbH, All Rights reserved */

(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define(['clpp'],factory);else if(typeof exports==="object")exports["clpp_ima2"]=factory();else root["clpp_ima2"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="/";return __webpack_require__(0)}({0:function(module,exports,__webpack_require__){__webpack_require__(41);__webpack_require__(43);__webpack_require__(44);__webpack_require__(46);module.exports=__webpack_require__(47)},35:function(module,exports){module.exports=function(){var list=[];list.toString=function toString(){var result=[];for(var i=0;i<this.length;i++){var item=this[i];if(item[2]){result.push("@media "+item[2]+"{"+item[1]+"}")}else{result.push(item[1])}}return result.join("")};list.i=function(modules,mediaQuery){if(typeof modules==="string")modules=[[null,modules,""]];var alreadyImportedModules={};for(var i=0;i<this.length;i++){var id=this[i][0];if(typeof id==="number")alreadyImportedModules[id]=true}for(i=0;i<modules.length;i++){var item=modules[i];if(typeof item[0]!=="number"||!alreadyImportedModules[item[0]]){if(mediaQuery&&!item[2]){item[2]=mediaQuery}else if(mediaQuery){item[2]="("+item[2]+") and ("+mediaQuery+")"}list.push(item)}}};return list}},36:function(module,exports,__webpack_require__){var stylesInDom={},memoize=function(fn){var memo;return function(){if(typeof memo==="undefined")memo=fn.apply(this,arguments);return memo}},isOldIE=memoize(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),getHeadElement=memoize(function(){return document.head||document.getElementsByTagName("head")[0]}),singletonElement=null,singletonCounter=0,styleElementsInsertedAtTop=[];module.exports=function(list,options){if(false){if(typeof document!=="object")throw new Error("The style-loader cannot be used in a non-browser environment")}options=options||{};if(typeof options.singleton==="undefined")options.singleton=isOldIE();if(typeof options.insertAt==="undefined")options.insertAt="bottom";var styles=listToStyles(list);addStylesToDom(styles,options);return function update(newList){var mayRemove=[];for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];domStyle.refs--;mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList);addStylesToDom(newStyles,options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(domStyle.refs===0){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++){domStyle.parts[j](item.parts[j])}for(;j<item.parts.length;j++){domStyle.parts.push(addStyle(item.parts[j],options))}}else{var parts=[];for(var j=0;j<item.parts.length;j++){parts.push(addStyle(item.parts[j],options))}stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list){var styles=[];var newStyles={};for(var i=0;i<list.length;i++){var item=list[i];var id=item[0];var css=item[1];var media=item[2];var sourceMap=item[3];var part={css:css,media:media,sourceMap:sourceMap};if(!newStyles[id])styles.push(newStyles[id]={id:id,parts:[part]});else newStyles[id].parts.push(part)}return styles}function insertStyleElement(options,styleElement){var head=getHeadElement();var lastStyleElementInsertedAtTop=styleElementsInsertedAtTop[styleElementsInsertedAtTop.length-1];if(options.insertAt==="top"){if(!lastStyleElementInsertedAtTop){head.insertBefore(styleElement,head.firstChild)}else if(lastStyleElementInsertedAtTop.nextSibling){head.insertBefore(styleElement,lastStyleElementInsertedAtTop.nextSibling)}else{head.appendChild(styleElement)}styleElementsInsertedAtTop.push(styleElement)}else if(options.insertAt==="bottom"){head.appendChild(styleElement)}else{throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")}}function removeStyleElement(styleElement){styleElement.parentNode.removeChild(styleElement);var idx=styleElementsInsertedAtTop.indexOf(styleElement);if(idx>=0){styleElementsInsertedAtTop.splice(idx,1)}}function createStyleElement(options){var styleElement=document.createElement("style");styleElement.type="text/css";insertStyleElement(options,styleElement);return styleElement}function createLinkElement(options){var linkElement=document.createElement("link");linkElement.rel="stylesheet";insertStyleElement(options,linkElement);return linkElement}function addStyle(obj,options){var styleElement,update,remove;if(options.singleton){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement(options));update=applyToSingletonTag.bind(null,styleElement,styleIndex,false);remove=applyToSingletonTag.bind(null,styleElement,styleIndex,true)}else if(obj.sourceMap&&typeof URL==="function"&&typeof URL.createObjectURL==="function"&&typeof URL.revokeObjectURL==="function"&&typeof Blob==="function"&&typeof btoa==="function"){styleElement=createLinkElement(options);update=updateLink.bind(null,styleElement);remove=function(){removeStyleElement(styleElement);if(styleElement.href)URL.revokeObjectURL(styleElement.href)}}else{styleElement=createStyleElement(options);update=applyToTag.bind(null,styleElement);remove=function(){removeStyleElement(styleElement)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else{remove()}}}var replaceText=function(){var textStore=[];return function(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet){styleElement.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=styleElement.childNodes;if(childNodes[index])styleElement.removeChild(childNodes[index]);if(childNodes.length){styleElement.insertBefore(cssNode,childNodes[index])}else{styleElement.appendChild(cssNode)}}}function applyToTag(styleElement,obj){var css=obj.css;var media=obj.media;if(media){styleElement.setAttribute("media",media)}if(styleElement.styleSheet){styleElement.styleSheet.cssText=css}else{while(styleElement.firstChild){styleElement.removeChild(styleElement.firstChild)}styleElement.appendChild(document.createTextNode(css))}}function updateLink(linkElement,obj){var css=obj.css;var sourceMap=obj.sourceMap;if(sourceMap){css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}var blob=new Blob([css],{type:"text/css"});var oldSrc=linkElement.href;linkElement.href=URL.createObjectURL(blob);if(oldSrc)URL.revokeObjectURL(oldSrc)}},41:function(module,exports,__webpack_require__){var content=__webpack_require__(42);if(typeof content==="string")content=[[module.id,content,""]];var update=__webpack_require__(36)(content,{});if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../css-loader/index.js!./videojs.ads.css",function(){var newContent=require("!!../../../css-loader/index.js!./videojs.ads.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},42:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(35)();exports.push([module.id,".vjs-ad-playing.vjs-ad-playing .vjs-progress-control{pointer-events:none}.vjs-ad-playing.vjs-ad-playing .vjs-play-progress{background-color:#ffe400}.vjs-ad-loading .vjs-loading-spinner{display:block;visibility:visible}.vjs-ad-playing .vjs-audio-button,.vjs-ad-playing .vjs-captions-button{display:none}.vjs-ad-loading .vjs-loading-spinner:after,.vjs-ad-loading .vjs-loading-spinner:before{animation:vjs-spinner-spin 1.1s cubic-bezier(.6,.2,0,.8) infinite,vjs-spinner-fade 1.1s linear infinite}.vjs-ad-loading .vjs-loading-spinner:before{border-top-color:#fff}.vjs-ad-loading .vjs-loading-spinner:after{border-top-color:#fff;animation-delay:.44s}.vjs-ad-content-resuming .vjs-big-play-button,.vjs-ad-content-resuming .vjs-poster,.vjs-ad-loading .vjs-big-play-button,.vjs-ad-loading .vjs-poster{display:none}",""])},43:function(module,exports){(function(){var require=undefined;var module=undefined;var exports=undefined;var define=undefined;/*! @name videojs-contrib-ads @version 6.6.4 @license Apache-2.0 */
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory(require("video.js"),require("global/window"),require("global/document")):typeof define==="function"&&define.amd?define(["video.js","global/window","global/document"],factory):(global=global||self,global.videojsContribAds=factory(global.videojs,global.window,global.document))})(this,function(videojs,window,document){"use strict";videojs=videojs&&videojs.hasOwnProperty("default")?videojs["default"]:videojs;window=window&&window.hasOwnProperty("default")?window["default"]:window;document=document&&document.hasOwnProperty("default")?document["default"]:document;var version="6.6.4";function getAds(player){return{disableNextSnapshotRestore:false,_contentEnding:false,_contentHasEnded:false,_hasThereBeenALoadStartDuringPlayerLife:false,_hasThereBeenALoadedData:false,_hasThereBeenALoadedMetaData:false,_inLinearAdMode:false,_shouldBlockPlay:false,_playBlocked:false,_playRequested:false,adType:null,VERSION:version,reset:function reset(){player.ads.disableNextSnapshotRestore=false;player.ads._contentEnding=false;player.ads._contentHasEnded=false;player.ads.snapshot=null;player.ads.adType=null;player.ads._hasThereBeenALoadedData=false;player.ads._hasThereBeenALoadedMetaData=false;player.ads._cancelledPlay=false;player.ads._shouldBlockPlay=false;player.ads._playBlocked=false;player.ads.nopreroll_=false;player.ads.nopostroll_=false;player.ads._playRequested=false},startLinearAdMode:function startLinearAdMode(){player.ads._state.startLinearAdMode()},endLinearAdMode:function endLinearAdMode(){player.ads._state.endLinearAdMode()},skipLinearAdMode:function skipLinearAdMode(){player.ads._state.skipLinearAdMode()},stitchedAds:function stitchedAds(arg){if(arg!==undefined){videojs.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, "+"it should be set as an option upon initialization of contrib-ads.");this.settings.stitchedAds=!!arg}return this.settings.stitchedAds},videoElementRecycled:function videoElementRecycled(){if(player.ads.shouldPlayContentBehindAd(player)){return false}if(!this.snapshot){throw new Error("You cannot use videoElementRecycled while there is no snapshot.")}var srcChanged=player.tech_.src()!==this.snapshot.src;var currentSrcChanged=player.currentSrc()!==this.snapshot.currentSrc;return srcChanged||currentSrcChanged},isLive:function isLive(somePlayer){if(somePlayer===void 0){somePlayer=player}if(typeof somePlayer.ads.settings.contentIsLive==="boolean"){return somePlayer.ads.settings.contentIsLive}else if(somePlayer.duration()===Infinity){return true}else if(videojs.browser.IOS_VERSION==="8"&&somePlayer.duration()===0){return true}return false},shouldPlayContentBehindAd:function shouldPlayContentBehindAd(somePlayer){if(somePlayer===void 0){somePlayer=player}if(!somePlayer){throw new Error("shouldPlayContentBehindAd requires a player as a param")}else if(!somePlayer.ads.settings.liveCuePoints){return false}else{return!videojs.browser.IS_IOS&&!videojs.browser.IS_ANDROID&&somePlayer.duration()===Infinity}},shouldTakeSnapshots:function shouldTakeSnapshots(somePlayer){if(somePlayer===void 0){somePlayer=player}return!this.shouldPlayContentBehindAd(somePlayer)&&!this.stitchedAds()},isInAdMode:function isInAdMode(){return this._state.isAdState()},isWaitingForAdBreak:function isWaitingForAdBreak(){return this._state.isWaitingForAdBreak()},isContentResuming:function isContentResuming(){return this._state.isContentResuming()},isAdPlaying:function isAdPlaying(){return this._state.inAdBreak()},inAdBreak:function inAdBreak(){return this._state.inAdBreak()},removeNativePoster:function removeNativePoster(){var tech=player.$(".vjs-tech");if(tech){tech.removeAttribute("poster")}},debug:function debug(){if(this.settings.debug){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(args.length===1&&typeof args[0]==="string"){videojs.log("ADS: "+args[0])}else{videojs.log.apply(videojs,["ADS:"].concat(args))}}}}}var cancelEvent=function cancelEvent(player,event){event.isImmediatePropagationStopped=function(){return true};event.cancelBubble=true;event.isPropagationStopped=function(){return true}};var prefixEvent=function prefixEvent(player,prefix,event){cancelEvent(player,event);player.trigger({type:prefix+event.type,originalEvent:event})};var handlePlaying=function handlePlaying(player,event){if(player.ads.isInAdMode()){if(player.ads.isContentResuming()){if(player.ads._contentEnding){prefixEvent(player,"content",event)}}else{prefixEvent(player,"ad",event)}}};var handleEnded=function handleEnded(player,event){if(player.ads.isInAdMode()){if(player.ads.isContentResuming()){cancelEvent(player,event);player.trigger("resumeended")}else{prefixEvent(player,"ad",event)}}else if(!player.ads._contentHasEnded&&!player.ads.stitchedAds()){prefixEvent(player,"content",event);player.trigger("readyforpostroll")}};var handleLoadEvent=function handleLoadEvent(player,event){if(event.type==="loadstart"&&!player.ads._hasThereBeenALoadStartDuringPlayerLife||event.type==="loadeddata"&&!player.ads._hasThereBeenALoadedData||event.type==="loadedmetadata"&&!player.ads._hasThereBeenALoadedMetaData){return}else if(player.ads.inAdBreak()){prefixEvent(player,"ad",event)}else if(player.currentSrc()!==player.ads.contentSrc){return}else{prefixEvent(player,"content",event)}};var handlePlay=function handlePlay(player,event){if(player.ads.inAdBreak()){prefixEvent(player,"ad",event)}else if(player.ads.isContentResuming()){prefixEvent(player,"content",event)}};function redispatch(event){if(event.type==="playing"){handlePlaying(this,event)}else if(event.type==="ended"){handleEnded(this,event)}else if(event.type==="loadstart"||event.type==="loadeddata"||event.type==="loadedmetadata"){handleLoadEvent(this,event)}else if(event.type==="play"){handlePlay(this,event)}else if(this.ads.isInAdMode()){if(this.ads.isContentResuming()){prefixEvent(this,"content",event)}else{prefixEvent(this,"ad",event)}}}function initializeContentupdate(player){player.ads.contentSrc=player.currentSrc();player.ads._seenInitialLoadstart=false;var checkSrc=function checkSrc(){if(!player.ads.inAdBreak()){var src=player.currentSrc();if(src!==player.ads.contentSrc){if(player.ads._seenInitialLoadstart){player.trigger({type:"contentchanged"})}player.trigger({type:"contentupdate",oldValue:player.ads.contentSrc,newValue:src});player.ads.contentSrc=src}player.ads._seenInitialLoadstart=true}};player.on("loadstart",checkSrc)}var uriEncodeIfNeeded=function uriEncodeIfNeeded(value,uriEncode){if(uriEncode){return encodeURIComponent(value)}return value};var customFields=function customFields(mediainfo,macros,customFieldsName){if(mediainfo&&mediainfo[customFieldsName]){var fields=mediainfo[customFieldsName];var fieldNames=Object.keys(fields);for(var i=0;i<fieldNames.length;i++){var tag="{mediainfo."+customFieldsName+"."+fieldNames[i]+"}";macros[tag]=fields[fieldNames[i]]}}};function adMacroReplacement(string,uriEncode,customMacros){var _this=this;var defaults={};string=string.replace(/{([^}=]+)=([^}]+)}/g,function(match,name,defaultVal){defaults["{"+name+"}"]=defaultVal;return"{"+name+"}"});if(uriEncode===undefined){uriEncode=false}var macros={};if(customMacros!==undefined){macros=customMacros}macros["{player.id}"]=this.options_["data-player"];macros["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"";macros["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"";macros["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"";macros["{player.duration}"]=this.duration();macros["{timestamp}"]=(new Date).getTime();macros["{document.referrer}"]=document.referrer;macros["{window.location.href}"]=window.location.href;macros["{random}"]=Math.floor(Math.random()*1e12);["description","tags","reference_id","ad_keys"].forEach(function(prop){if(_this.mediainfo&&_this.mediainfo[prop]){macros["{mediainfo."+prop+"}"]=_this.mediainfo[prop]}else if(defaults["{mediainfo."+prop+"}"]){macros["{mediainfo."+prop+"}"]=defaults["{mediainfo."+prop+"}"]}else{macros["{mediainfo."+prop+"}"]=""}});customFields(this.mediainfo,macros,"custom_fields");customFields(this.mediainfo,macros,"customFields");for(var i in macros){string=string.split(i).join(uriEncodeIfNeeded(macros[i],uriEncode))}string=string.replace(/{pageVariable\.([^}]+)}/g,function(match,name){var value;var context=window;var names=name.split(".");for(var _i=0;_i<names.length;_i++){if(_i===names.length-1){value=context[names[_i]]}else{context=context[names[_i]]}}var type=typeof value;if(value===null){return"null"}else if(value===undefined){if(defaults["{pageVariable."+name+"}"]){return defaults["{pageVariable."+name+"}"]}videojs.log.warn('Page variable "'+name+'" not found');return""}else if(type!=="string"&&type!=="number"&&type!=="boolean"){videojs.log.warn('Page variable "'+name+'" is not a supported type');return""}return uriEncodeIfNeeded(String(value),uriEncode)});for(var defaultVal in defaults){string=string.replace(defaultVal,defaults[defaultVal])}return string}var cueTextTracks={};cueTextTracks.processMetadataTracks=function(player,processMetadataTrack){var tracks=player.textTracks();var setModeAndProcess=function setModeAndProcess(track){if(track.kind==="metadata"){player.ads.cueTextTracks.setMetadataTrackMode(track);processMetadataTrack(player,track)}};for(var i=0;i<tracks.length;i++){setModeAndProcess(tracks[i])}tracks.addEventListener("addtrack",function(event){setModeAndProcess(event.track)})};cueTextTracks.setMetadataTrackMode=function(track){return};cueTextTracks.getSupportedAdCue=function(player,cue){return cue};cueTextTracks.isSupportedAdCue=function(player,cue){return true};cueTextTracks.getCueId=function(player,cue){return cue.id};var cueAlreadySeen=function cueAlreadySeen(player,cueId){return cueId!==undefined&&player.ads.includedCues[cueId]};var setCueAlreadySeen=function setCueAlreadySeen(player,cueId){if(cueId!==undefined&&cueId!==""){player.ads.includedCues[cueId]=true}};cueTextTracks.processAdTrack=function(player,cues,processCue,cancelAdsHandler){player.ads.includedCues={};for(var i=0;i<cues.length;i++){var cue=cues[i];var cueData=this.getSupportedAdCue(player,cue);if(!this.isSupportedAdCue(player,cue)){videojs.log.warn("Skipping as this is not a supported ad cue.",cue);return}var cueId=this.getCueId(player,cue);var startTime=cue.startTime;if(cueAlreadySeen(player,cueId)){videojs.log("Skipping ad already seen with ID "+cueId);return}if(cancelAdsHandler){cancelAdsHandler(player,cueData,cueId,startTime)}processCue(player,cueData,cueId,startTime);setCueAlreadySeen(player,cueId)}};function initCancelContentPlay(player,debug){if(debug){videojs.log("Using cancelContentPlay to block content playback")}player.on("playing",cancelContentPlay)}function cancelContentPlay(){if(this.ads._shouldBlockPlay===false){return}if(!this.paused()){this.ads.debug("Playback was canceled by cancelContentPlay");this.pause()}this.ads._cancelledPlay=true}var obj={};var videojsReference=videojs;obj.isMiddlewareMediatorSupported=function(){if(videojsReference.browser.IS_IOS||videojsReference.browser.IS_ANDROID){return false}else if(videojsReference.use&&videojsReference.middleware&&videojsReference.middleware.TERMINATOR){return true}return false};obj.playMiddleware=function(player){return{setSource:function setSource(srcObj,next){next(null,srcObj)},callPlay:function callPlay(){if(player.ads&&player.ads._shouldBlockPlay===true){player.ads.debug("Using playMiddleware to block content playback");player.ads._playBlocked=true;return videojsReference.middleware.TERMINATOR}},play:function play(terminated,playPromise){if(player.ads&&player.ads._playBlocked&&terminated){player.ads.debug("Play call to Tech was terminated.");player.trigger("play");player.addClass("vjs-has-started");player.ads._playBlocked=false}else if(playPromise&&playPromise.catch){playPromise.catch(function(e){if(e.name==="NotAllowedError"&&!videojs.browser.IS_SAFARI){player.trigger("pause")}})}}}};obj.testHook=function(testVjs){videojsReference=testVjs};var playMiddleware=obj.playMiddleware,isMiddlewareMediatorSupported=obj.isMiddlewareMediatorSupported;var hasAdsPlugin=function hasAdsPlugin(){if(videojs.getPlugin){return Boolean(videojs.getPlugin("ads"))}var Player=videojs.getComponent("Player");return Boolean(Player&&Player.prototype.ads)};function register(contribAdsPlugin){if(hasAdsPlugin(videojs)){return false}var registerPlugin=videojs.registerPlugin||videojs.plugin;registerPlugin("ads",contribAdsPlugin);if(isMiddlewareMediatorSupported()&&!videojs.usingContribAdsMiddleware_){videojs.use("*",playMiddleware);videojs.usingContribAdsMiddleware_=true;videojs.log.debug("Play middleware has been registered with videojs")}return true}var States=function(){function States(){}States.getState=function getState(name){if(!name){return}if(States.states_&&States.states_[name]){return States.states_[name]}};States.registerState=function registerState(name,StateToRegister){if(typeof name!=="string"||!name){throw new Error('Illegal state name, "'+name+'"; must be a non-empty string.')}if(!States.states_){States.states_={}}States.states_[name]=StateToRegister;return StateToRegister};return States}();var State=function(){State._getName=function _getName(){return"Anonymous State"};function State(player){this.player=player}var _proto=State.prototype;_proto.transitionTo=function transitionTo(NewState){var player=this.player;this.cleanup(player);var newState=new NewState(player);player.ads._state=newState;player.ads.debug(this.constructor._getName()+" -> "+newState.constructor._getName());for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}newState.init.apply(newState,[player].concat(args))};_proto.init=function init(){};_proto.cleanup=function cleanup(){};_proto.onPlay=function onPlay(){};_proto.onPlaying=function onPlaying(){};_proto.onEnded=function onEnded(){};_proto.onAdEnded=function onAdEnded(){};_proto.onAdsReady=function onAdsReady(){videojs.log.warn("Unexpected adsready event")};_proto.onAdsError=function onAdsError(){};_proto.onAdsCanceled=function onAdsCanceled(){};_proto.onAdTimeout=function onAdTimeout(){};_proto.onAdStarted=function onAdStarted(){};_proto.onContentChanged=function onContentChanged(){};_proto.onContentResumed=function onContentResumed(){};_proto.onReadyForPostroll=function onReadyForPostroll(){videojs.log.warn("Unexpected readyforpostroll event")};_proto.onNoPreroll=function onNoPreroll(){};_proto.onNoPostroll=function onNoPostroll(){};_proto.startLinearAdMode=function startLinearAdMode(){videojs.log.warn("Unexpected startLinearAdMode invocation "+"(State via "+this.constructor._getName()+")")};_proto.endLinearAdMode=function endLinearAdMode(){videojs.log.warn("Unexpected endLinearAdMode invocation "+"(State via "+this.constructor._getName()+")")};_proto.skipLinearAdMode=function skipLinearAdMode(){videojs.log.warn("Unexpected skipLinearAdMode invocation "+"(State via "+this.constructor._getName()+")")};_proto.isAdState=function isAdState(){throw new Error("isAdState unimplemented for "+this.constructor._getName())};_proto.isWaitingForAdBreak=function isWaitingForAdBreak(){return false};_proto.isContentResuming=function isContentResuming(){return false};_proto.inAdBreak=function inAdBreak(){return false};_proto.handleEvent=function handleEvent(type){var player=this.player;if(type==="play"){this.onPlay(player)}else if(type==="adsready"){this.onAdsReady(player)}else if(type==="adserror"){this.onAdsError(player)}else if(type==="adscanceled"){this.onAdsCanceled(player)}else if(type==="adtimeout"){this.onAdTimeout(player)}else if(type==="ads-ad-started"){this.onAdStarted(player)}else if(type==="contentchanged"){this.onContentChanged(player)}else if(type==="contentresumed"){this.onContentResumed(player)}else if(type==="readyforpostroll"){this.onReadyForPostroll(player)}else if(type==="playing"){this.onPlaying(player)}else if(type==="ended"){this.onEnded(player)}else if(type==="nopreroll"){this.onNoPreroll(player)}else if(type==="nopostroll"){this.onNoPostroll(player)}else if(type==="adended"){this.onAdEnded(player)}};return State}();States.registerState("State",State);function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var AdState=function(_State){_inheritsLoose(AdState,_State);function AdState(player){var _this;_this=_State.call(this,player)||this;_this.contentResuming=false;_this.waitingForAdBreak=false;return _this}var _proto=AdState.prototype;_proto.isAdState=function isAdState(){return true};_proto.onPlaying=function onPlaying(){var ContentPlayback=States.getState("ContentPlayback");if(this.contentResuming){this.transitionTo(ContentPlayback)}};_proto.onContentResumed=function onContentResumed(){var ContentPlayback=States.getState("ContentPlayback");if(this.contentResuming){this.transitionTo(ContentPlayback)}};_proto.isWaitingForAdBreak=function isWaitingForAdBreak(){return this.waitingForAdBreak};_proto.isContentResuming=function isContentResuming(){return this.contentResuming};_proto.inAdBreak=function inAdBreak(){return this.player.ads._inLinearAdMode===true};return AdState}(State);States.registerState("AdState",AdState);var ContentState=function(_State){_inheritsLoose(ContentState,_State);function ContentState(){return _State.apply(this,arguments)||this}var _proto=ContentState.prototype;_proto.isAdState=function isAdState(){return false};_proto.onContentChanged=function onContentChanged(player){var BeforePreroll=States.getState("BeforePreroll");var Preroll=States.getState("Preroll");player.ads.debug("Received contentchanged event (ContentState)");if(player.paused()){this.transitionTo(BeforePreroll)}else{this.transitionTo(Preroll,false);player.pause();player.ads._pausedOnContentupdate=true}};return ContentState}(State);States.registerState("ContentState",ContentState);var ContentState$1=States.getState("ContentState");var AdsDone=function(_ContentState){_inheritsLoose(AdsDone,_ContentState);function AdsDone(){return _ContentState.apply(this,arguments)||this}AdsDone._getName=function _getName(){return"AdsDone"};var _proto=AdsDone.prototype;_proto.init=function init(player){player.ads._contentHasEnded=true;player.trigger("ended")};_proto.startLinearAdMode=function startLinearAdMode(){videojs.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")};return AdsDone}(ContentState$1);States.registerState("AdsDone",AdsDone);var tryToResumeTimeout_;function getPlayerSnapshot(player){var currentTime;if(videojs.browser.IS_IOS&&player.ads.isLive(player)){if(player.seekable().length>0){currentTime=player.currentTime()-player.seekable().end(0)}else{currentTime=player.currentTime()}}else{currentTime=player.currentTime()}var tech=player.$(".vjs-tech");var tracks=player.textTracks?player.textTracks():[];var suppressedTracks=[];var snapshotObject={ended:player.ended(),currentSrc:player.currentSrc(),sources:player.currentSources(),src:player.tech_.src(),currentTime:currentTime,type:player.currentType()};if(tech){snapshotObject.style=tech.getAttribute("style")}for(var i=0;i<tracks.length;i++){var track=tracks[i];suppressedTracks.push({track:track,mode:track.mode});track.mode="disabled"}snapshotObject.suppressedTracks=suppressedTracks;return snapshotObject}function restorePlayerSnapshot(player,callback){var snapshotObject=player.ads.snapshot;if(callback===undefined){callback=function callback(){}}if(player.ads.disableNextSnapshotRestore===true){player.ads.disableNextSnapshotRestore=false;delete player.ads.snapshot;callback();return}var tech=player.$(".vjs-tech");var attempts=20;var suppressedTracks=snapshotObject.suppressedTracks;var trackSnapshot;var restoreTracks=function restoreTracks(){for(var i=0;i<suppressedTracks.length;i++){trackSnapshot=suppressedTracks[i];trackSnapshot.track.mode=trackSnapshot.mode}};var resume=function resume(){var currentTime;if(videojs.browser.IS_IOS&&player.ads.isLive(player)){if(snapshotObject.currentTime<0){if(player.seekable().length>0){currentTime=player.seekable().end(0)+snapshotObject.currentTime}else{currentTime=player.currentTime()}player.currentTime(currentTime)}if(player.paused()){var playPromise=player.play();if(playPromise&&playPromise.catch){playPromise.catch(function(error){videojs.log.warn("Play promise rejected in IOS snapshot resume",error)})}}}else if(snapshotObject.ended){player.currentTime(player.duration())}else{player.currentTime(snapshotObject.currentTime);var _playPromise=player.play();if(_playPromise&&_playPromise.catch){_playPromise.catch(function(error){videojs.log.warn("Play promise rejected in snapshot resume",error)})}}if(player.ads.shouldRemoveAutoplay_){player.autoplay(false);player.ads.shouldRemoveAutoplay_=false}};var tryToResume=function tryToResume(){player.off("contentcanplay",tryToResume);if(tryToResumeTimeout_){player.clearTimeout(tryToResumeTimeout_)}tech=player.el().querySelector(".vjs-tech");if(tech.readyState>1){return resume()}if(tech.seekable===undefined){return resume()}if(tech.seekable.length>0){return resume()}if(attempts--){player.setTimeout(tryToResume,50)}else{try{resume()}catch(e){videojs.log.warn("Failed to resume the content after an advertisement",e)}}};if("style"in snapshotObject){tech.setAttribute("style",snapshotObject.style||"")}if(player.ads.videoElementRecycled()){player.one("resumeended",function(){delete player.ads.snapshot;callback()});player.one("contentloadedmetadata",restoreTracks);if(videojs.browser.IS_IOS&&!player.autoplay()){player.autoplay(true);player.ads.shouldRemoveAutoplay_=true}player.src(snapshotObject.sources);player.one("contentcanplay",tryToResume);tryToResumeTimeout_=player.setTimeout(tryToResume,2e3)}else{restoreTracks();if(!player.ended()){var playPromise=player.play();if(playPromise&&playPromise.catch){playPromise.catch(function(error){videojs.log.warn("Play promise rejected in snapshot restore",error)})}}delete player.ads.snapshot;callback()}}function start(player){player.ads.debug("Starting ad break");player.ads._inLinearAdMode=true;player.trigger("adstart");if(player.ads.shouldTakeSnapshots()){player.ads.snapshot=getPlayerSnapshot(player)}if(player.ads.shouldPlayContentBehindAd(player)){player.ads.preAdVolume_=player.volume();player.volume(0)}player.addClass("vjs-ad-playing");if(player.hasClass("vjs-live")){player.removeClass("vjs-live")}player.ads.removeNativePoster()}function end(player,callback){player.ads.debug("Ending ad break");if(callback===undefined){callback=function callback(){}}player.ads.adType=null;player.ads._inLinearAdMode=false;player.trigger("adend");player.removeClass("vjs-ad-playing");if(player.ads.isLive(player)){player.addClass("vjs-live")}if(player.ads.shouldTakeSnapshots()){restorePlayerSnapshot(player,callback)}else{player.volume(player.ads.preAdVolume_);callback()}}var obj$1={start:start,end:end};var AdState$1=States.getState("AdState");var Preroll=function(_AdState){_inheritsLoose(Preroll,_AdState);function Preroll(){return _AdState.apply(this,arguments)||this}Preroll._getName=function _getName(){return"Preroll"};var _proto=Preroll.prototype;_proto.init=function init(player,adsReady,shouldResumeToContent){this.waitingForAdBreak=true;player.addClass("vjs-ad-loading");if(shouldResumeToContent||player.ads.nopreroll_){return this.resumeAfterNoPreroll(player)}var timeout=player.ads.settings.timeout;if(typeof player.ads.settings.prerollTimeout==="number"){timeout=player.ads.settings.prerollTimeout}this._timeout=player.setTimeout(function(){player.trigger("adtimeout")},timeout);if(adsReady){this.handleAdsReady()}else{this.adsReady=false}};_proto.onAdsReady=function onAdsReady(player){if(!player.ads.inAdBreak()){player.ads.debug("Received adsready event (Preroll)");this.handleAdsReady()}else{videojs.log.warn("Unexpected adsready event (Preroll)")}};_proto.handleAdsReady=function handleAdsReady(){this.adsReady=true;this.readyForPreroll()};_proto.afterLoadStart=function afterLoadStart(callback){var player=this.player;if(player.ads._hasThereBeenALoadStartDuringPlayerLife){callback()}else{player.ads.debug("Waiting for loadstart...");player.one("loadstart",function(){player.ads.debug("Received loadstart event");callback()})}};_proto.noPreroll=function noPreroll(){var _this=this;this.afterLoadStart(function(){_this.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)");_this.resumeAfterNoPreroll(_this.player)})};_proto.readyForPreroll=function readyForPreroll(){var player=this.player;this.afterLoadStart(function(){player.ads.debug("Triggered readyforpreroll event (Preroll)");player.trigger("readyforpreroll")})};_proto.onAdsCanceled=function onAdsCanceled(player){var _this2=this;player.ads.debug("adscanceled (Preroll)");this.afterLoadStart(function(){_this2.resumeAfterNoPreroll(player)})};_proto.onAdsError=function onAdsError(player){var _this3=this;videojs.log("adserror (Preroll)");if(this.inAdBreak()){player.ads.endLinearAdMode()}else{this.afterLoadStart(function(){_this3.resumeAfterNoPreroll(player)})}};_proto.startLinearAdMode=function startLinearAdMode(){var player=this.player;if(this.adsReady&&!player.ads.inAdBreak()&&!this.isContentResuming()){this.clearTimeout(player);player.ads.adType="preroll";this.waitingForAdBreak=false;obj$1.start(player);player.ads._shouldBlockPlay=false}else{videojs.log.warn("Unexpected startLinearAdMode invocation (Preroll)")}};_proto.onAdStarted=function onAdStarted(player){player.removeClass("vjs-ad-loading")};_proto.endLinearAdMode=function endLinearAdMode(){var player=this.player;if(this.inAdBreak()){player.removeClass("vjs-ad-loading");player.addClass("vjs-ad-content-resuming");this.contentResuming=true;obj$1.end(player)}};_proto.skipLinearAdMode=function skipLinearAdMode(){var _this4=this;var player=this.player;if(player.ads.inAdBreak()||this.isContentResuming()){videojs.log.warn("Unexpected skipLinearAdMode invocation")}else{this.afterLoadStart(function(){player.trigger("adskip");player.ads.debug("skipLinearAdMode (Preroll)");_this4.resumeAfterNoPreroll(player)})}};_proto.onAdTimeout=function onAdTimeout(player){var _this5=this;this.afterLoadStart(function(){player.ads.debug("adtimeout (Preroll)");_this5.resumeAfterNoPreroll(player)})};_proto.onNoPreroll=function onNoPreroll(player){if(player.ads.inAdBreak()||this.isContentResuming()){videojs.log.warn("Unexpected nopreroll event (Preroll)")}else{this.noPreroll()}};_proto.resumeAfterNoPreroll=function resumeAfterNoPreroll(player){this.contentResuming=true;player.ads._shouldBlockPlay=false;this.cleanupPartial(player);if(player.paused()&&(player.ads._playRequested||player.ads._pausedOnContentupdate)){var playPromise=player.play();if(playPromise&&playPromise.then){playPromise.then(null,function(e){})}}};_proto.cleanup=function cleanup(player){if(!player.ads._hasThereBeenALoadStartDuringPlayerLife){videojs.log.warn("Leaving Preroll state before loadstart event can cause issues.")}this.cleanupPartial(player)};_proto.cleanupPartial=function cleanupPartial(player){player.removeClass("vjs-ad-loading");player.removeClass("vjs-ad-content-resuming");this.clearTimeout(player)};_proto.clearTimeout=function clearTimeout(player){player.clearTimeout(this._timeout);this._timeout=null};return Preroll}(AdState$1);States.registerState("Preroll",Preroll);var ContentState$2=States.getState("ContentState");var BeforePreroll=function(_ContentState){_inheritsLoose(BeforePreroll,_ContentState);function BeforePreroll(){return _ContentState.apply(this,arguments)||this}BeforePreroll._getName=function _getName(){return"BeforePreroll"};var _proto=BeforePreroll.prototype;_proto.init=function init(player){this.adsReady=false;this.shouldResumeToContent=false;player.ads._shouldBlockPlay=true};_proto.onAdsReady=function onAdsReady(player){player.ads.debug("Received adsready event (BeforePreroll)");this.adsReady=true};_proto.onPlay=function onPlay(player){var Preroll=States.getState("Preroll");player.ads.debug("Received play event (BeforePreroll)");this.transitionTo(Preroll,this.adsReady,this.shouldResumeToContent)};_proto.onAdsCanceled=function onAdsCanceled(player){player.ads.debug("adscanceled (BeforePreroll)");this.shouldResumeToContent=true};_proto.onAdsError=function onAdsError(){this.player.ads.debug("adserror (BeforePreroll)");this.shouldResumeToContent=true};_proto.onNoPreroll=function onNoPreroll(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)");this.shouldResumeToContent=true};_proto.skipLinearAdMode=function skipLinearAdMode(){var player=this.player;player.trigger("adskip");player.ads.debug("skipLinearAdMode (BeforePreroll)");this.shouldResumeToContent=true};_proto.onContentChanged=function onContentChanged(){this.init(this.player)};return BeforePreroll}(ContentState$2);States.registerState("BeforePreroll",BeforePreroll);var AdState$2=States.getState("AdState");var Midroll=function(_AdState){_inheritsLoose(Midroll,_AdState);function Midroll(){return _AdState.apply(this,arguments)||this}Midroll._getName=function _getName(){return"Midroll"};var _proto=Midroll.prototype;_proto.init=function init(player){player.ads.adType="midroll";obj$1.start(player);player.addClass("vjs-ad-loading")};_proto.onAdStarted=function onAdStarted(player){player.removeClass("vjs-ad-loading")};_proto.endLinearAdMode=function endLinearAdMode(){var player=this.player;if(this.inAdBreak()){this.contentResuming=true;player.addClass("vjs-ad-content-resuming");player.removeClass("vjs-ad-loading");obj$1.end(player)}};_proto.onAdsError=function onAdsError(player){if(this.inAdBreak()){player.ads.endLinearAdMode()}};_proto.cleanup=function cleanup(player){player.removeClass("vjs-ad-loading");player.removeClass("vjs-ad-content-resuming")};return Midroll}(AdState$2);States.registerState("Midroll",Midroll);var AdState$3=States.getState("AdState");var Postroll=function(_AdState){_inheritsLoose(Postroll,_AdState);function Postroll(){return _AdState.apply(this,arguments)||this}Postroll._getName=function _getName(){return"Postroll"};var _proto=Postroll.prototype;_proto.init=function init(player){this.waitingForAdBreak=true;player.ads._contentEnding=true;if(!player.ads.nopostroll_){player.addClass("vjs-ad-loading");var timeout=player.ads.settings.timeout;if(typeof player.ads.settings.postrollTimeout==="number"){timeout=player.ads.settings.postrollTimeout}this._postrollTimeout=player.setTimeout(function(){player.trigger("adtimeout")},timeout)}else{this.resumeContent(player);var AdsDone=States.getState("AdsDone");this.transitionTo(AdsDone)}};_proto.startLinearAdMode=function startLinearAdMode(){var player=this.player;if(!player.ads.inAdBreak()&&!this.isContentResuming()){player.ads.adType="postroll";player.clearTimeout(this._postrollTimeout);this.waitingForAdBreak=false;obj$1.start(player)}else{videojs.log.warn("Unexpected startLinearAdMode invocation (Postroll)")}};_proto.onAdStarted=function onAdStarted(player){player.removeClass("vjs-ad-loading")};_proto.endLinearAdMode=function endLinearAdMode(){var _this=this;var player=this.player;var AdsDone=States.getState("AdsDone");if(this.inAdBreak()){player.removeClass("vjs-ad-loading");this.resumeContent(player);obj$1.end(player,function(){_this.transitionTo(AdsDone)})}};_proto.skipLinearAdMode=function skipLinearAdMode(){var player=this.player;if(player.ads.inAdBreak()||this.isContentResuming()){videojs.log.warn("Unexpected skipLinearAdMode invocation")}else{player.ads.debug("Postroll abort (skipLinearAdMode)");player.trigger("adskip");this.abort(player)}};_proto.onAdTimeout=function onAdTimeout(player){player.ads.debug("Postroll abort (adtimeout)");this.abort(player)};_proto.onAdsError=function onAdsError(player){player.ads.debug("Postroll abort (adserror)");if(player.ads.inAdBreak()){player.ads.endLinearAdMode()}else{this.abort(player)}};_proto.onContentChanged=function onContentChanged(player){if(this.isContentResuming()){var BeforePreroll=States.getState("BeforePreroll");this.transitionTo(BeforePreroll);
}else if(!this.inAdBreak()){var Preroll=States.getState("Preroll");this.transitionTo(Preroll)}};_proto.onNoPostroll=function onNoPostroll(player){if(!this.isContentResuming()&&!this.inAdBreak()){this.abort(player)}else{videojs.log.warn("Unexpected nopostroll event (Postroll)")}};_proto.resumeContent=function resumeContent(player){this.contentResuming=true;player.addClass("vjs-ad-content-resuming")};_proto.abort=function abort(player){var AdsDone=States.getState("AdsDone");this.resumeContent(player);player.removeClass("vjs-ad-loading");this.transitionTo(AdsDone)};_proto.cleanup=function cleanup(player){player.removeClass("vjs-ad-content-resuming");player.clearTimeout(this._postrollTimeout);player.ads._contentEnding=false};return Postroll}(AdState$3);States.registerState("Postroll",Postroll);var ContentState$3=States.getState("ContentState");var ContentPlayback=function(_ContentState){_inheritsLoose(ContentPlayback,_ContentState);function ContentPlayback(){return _ContentState.apply(this,arguments)||this}ContentPlayback._getName=function _getName(){return"ContentPlayback"};var _proto=ContentPlayback.prototype;_proto.init=function init(player){player.ads._shouldBlockPlay=false};_proto.onAdsReady=function onAdsReady(player){player.ads.debug("Received adsready event (ContentPlayback)");if(!player.ads.nopreroll_){player.ads.debug("Triggered readyforpreroll event (ContentPlayback)");player.trigger("readyforpreroll")}};_proto.onReadyForPostroll=function onReadyForPostroll(player){var Postroll=States.getState("Postroll");player.ads.debug("Received readyforpostroll event");this.transitionTo(Postroll)};_proto.startLinearAdMode=function startLinearAdMode(){var Midroll=States.getState("Midroll");this.transitionTo(Midroll)};return ContentPlayback}(ContentState$3);States.registerState("ContentPlayback",ContentPlayback);var ContentState$4=States.getState("ContentState");var StitchedContentPlayback=function(_ContentState){_inheritsLoose(StitchedContentPlayback,_ContentState);function StitchedContentPlayback(){return _ContentState.apply(this,arguments)||this}StitchedContentPlayback._getName=function _getName(){return"StitchedContentPlayback"};var _proto=StitchedContentPlayback.prototype;_proto.init=function init(){this.player.ads._shouldBlockPlay=false};_proto.onContentChanged=function onContentChanged(){this.player.ads.debug("Received contentchanged event ("+this._getName()+")")};_proto.startLinearAdMode=function startLinearAdMode(){var StitchedAdRoll=States.getState("StitchedAdRoll");this.transitionTo(StitchedAdRoll)};return StitchedContentPlayback}(ContentState$4);States.registerState("StitchedContentPlayback",StitchedContentPlayback);var AdState$4=States.getState("AdState");var StitchedAdRoll=function(_AdState){_inheritsLoose(StitchedAdRoll,_AdState);function StitchedAdRoll(){return _AdState.apply(this,arguments)||this}StitchedAdRoll._getName=function _getName(){return"StitchedAdRoll"};var _proto=StitchedAdRoll.prototype;_proto.init=function init(){this.waitingForAdBreak=false;this.contentResuming=false;this.player.ads.adType="stitched";obj$1.start(this.player)};_proto.onPlaying=function onPlaying(){};_proto.onContentResumed=function onContentResumed(){};_proto.onAdEnded=function onAdEnded(){this.endLinearAdMode();this.player.trigger("ended")};_proto.endLinearAdMode=function endLinearAdMode(){var StitchedContentPlayback=States.getState("StitchedContentPlayback");obj$1.end(this.player);this.transitionTo(StitchedContentPlayback)};return StitchedAdRoll}(AdState$4);States.registerState("StitchedAdRoll",StitchedAdRoll);var isMiddlewareMediatorSupported$1=obj.isMiddlewareMediatorSupported;var VIDEO_EVENTS=videojs.getTech("Html5").Events;var defaults={timeout:5e3,prerollTimeout:undefined,postrollTimeout:undefined,debug:false,stitchedAds:false,contentIsLive:undefined,liveCuePoints:true};var contribAdsPlugin=function contribAdsPlugin(options){var player=this;var settings=videojs.mergeOptions(defaults,options);var videoEvents=[];VIDEO_EVENTS.concat(["firstplay","loadedalldata"]).forEach(function(eventName){if(videoEvents.indexOf(eventName)===-1){videoEvents.push(eventName)}});player.on(videoEvents,redispatch);if(!isMiddlewareMediatorSupported$1()){initCancelContentPlay(player,settings.debug)}player.setTimeout(function(){if(!player.ads._hasThereBeenALoadStartDuringPlayerLife&&player.src()!==""){videojs.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds "+"after being initialized, but a source is present. This indicates that "+"videojs-contrib-ads was initialized too late. It must be initialized "+"immediately after video.js in the same tick. As a result, some ads will not "+"play and some media events will be incorrect. For more information, see "+"http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")}},5e3);player.on("ended",function(){if(!player.hasClass("vjs-has-started")){player.addClass("vjs-has-started")}});player.on("contenttimeupdate",function(){player.removeClass("vjs-waiting")});player.on(["addurationchange","adcanplay"],function(){if(player.ads.settings.stitchedAds){return}if(player.hasStarted()){return}if(player.ads.snapshot&&player.currentSrc()===player.ads.snapshot.currentSrc){return}if(!player.ads.inAdBreak()){return}var playPromise=player.play();if(playPromise&&playPromise.catch){playPromise.catch(function(error){videojs.log.warn("Play promise rejected when playing ad",error)})}});player.on("nopreroll",function(){player.ads.debug("Received nopreroll event");player.ads.nopreroll_=true});player.on("nopostroll",function(){player.ads.debug("Received nopostroll event");player.ads.nopostroll_=true});player.on("playing",function(){player.ads._cancelledPlay=false;player.ads._pausedOnContentupdate=false});player.on("play",function(){player.ads._playRequested=true});player.one("loadstart",function(){player.ads._hasThereBeenALoadStartDuringPlayerLife=true});player.on("loadeddata",function(){player.ads._hasThereBeenALoadedData=true});player.on("loadedmetadata",function(){player.ads._hasThereBeenALoadedMetaData=true});player.ads=getAds(player);player.ads.settings=settings;settings.stitchedAds=!!settings.stitchedAds;if(settings.stitchedAds){player.ads._state=new(States.getState("StitchedContentPlayback"))(player)}else{player.ads._state=new(States.getState("BeforePreroll"))(player)}player.ads._state.init(player);player.ads.cueTextTracks=cueTextTracks;player.ads.adMacroReplacement=adMacroReplacement.bind(player);initializeContentupdate(player);player.on("contentchanged",player.ads.reset);var shouldDisableTracks=function shouldDisableTracks(){return!player.ads.shouldPlayContentBehindAd(player)&&player.ads.inAdBreak()&&player.tech_.featuresNativeTextTracks&&videojs.browser.IS_IOS&&!Array.isArray(player.textTracks())};var textTrackChangeHandler=function textTrackChangeHandler(){var textTrackList=player.textTracks();if(shouldDisableTracks()){for(var i=0;i<textTrackList.length;i++){var track=textTrackList[i];if(track.mode==="showing"){track.mode="disabled"}}}};player.ready(function(){player.textTracks().addEventListener("change",textTrackChangeHandler)});player.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],function(e){player.ads._state.handleEvent(e.type)});player.on("dispose",function(){player.ads.reset();player.textTracks().removeEventListener("change",textTrackChangeHandler)})};contribAdsPlugin.VERSION=version;register(contribAdsPlugin);return contribAdsPlugin})}).call(window)},44:function(module,exports,__webpack_require__){var content=__webpack_require__(45);if(typeof content==="string")content=[[module.id,content,""]];var update=__webpack_require__(36)(content,{});if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../css-loader/index.js!./videojs.ima.css",function(){var newContent=require("!!../../../css-loader/index.js!./videojs.ima.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},45:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(35)();exports.push([module.id,'.ima-ad-container{top:0;position:absolute;display:none;width:100%;height:100%}.video-js.vjs-playing .bumpable-ima-ad-container{margin-top:-4em}.video-js.vjs-user-inactive.vjs-playing .bumpable-ima-ad-container{margin-top:0}.video-js.vjs-paused .bumpable-ima-ad-container,.video-js.vjs-playing:hover .bumpable-ima-ad-container,.video-js.vjs-user-active.vjs-playing .bumpable-ima-ad-container{margin-top:-4em}.ima-controls-div{bottom:0;height:1.4em;position:absolute;overflow:hidden;display:none;opacity:1;background-color:rgba(7,20,30,.7);background:linear-gradient(0deg,rgba(7,20,30,.7) 0,rgba(7,20,30,0));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#0007141E",endColorstr="#07141E",GradientType=0)}.ima-controls-div.ima-controls-div-showing{height:3.7em}.ima-countdown-div{height:1em;color:#fff;text-shadow:0 0 .2em #000;cursor:default}.ima-seek-bar-div{top:1.2em;height:.3em;position:absolute;background:hsla(0,0%,100%,.4)}.ima-progress-div{width:0;height:.3em;background-color:#ecc546}.ima-fullscreen-div,.ima-mute-div,.ima-play-pause-div,.ima-slider-div{width:2.33em;height:1.33em;top:.733em;left:0;position:absolute;color:#ccc;font-size:1.5em;line-height:2;text-align:center;font-family:VideoJS;cursor:pointer}.ima-mute-div{left:auto;right:5.667em}.ima-slider-div{left:auto;right:2.33em;width:3.33em;height:.667em;top:1.33em;background-color:#555}.ima-slider-level-div{width:100%;height:.667em;background-color:#ecc546}.ima-fullscreen-div{left:auto;right:0}.ima-playing:before{content:"\\F103"}.ima-paused:before{content:"\\F101"}.ima-paused:hover:before,.ima-playing:hover:before{text-shadow:0 0 1em #fff}.ima-non-muted:before{content:"\\F107"}.ima-muted:before{content:"\\F104"}.ima-muted:hover:before,.ima-non-muted:hover:before{text-shadow:0 0 1em #fff}.ima-non-fullscreen:before{content:"\\F108"}.ima-fullscreen:before{content:"\\F109"}.ima-fullscreen:hover:before,.ima-non-fullscreen:hover:before{text-shadow:0 0 1em #fff}',""])},46:function(module,exports){(function(){var require=undefined;var module=undefined;var exports=undefined;var define=undefined;(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory(require("video.js")):typeof define==="function"&&define.amd?define(["video.js"],factory):global.videojsIma=factory(global.videojs)})(this,function(videojs){"use strict";videojs=videojs&&videojs.hasOwnProperty("default")?videojs["default"]:videojs;var PlayerWrapper=function PlayerWrapper(player,adsPluginSettings,controller){this.vjsPlayer=player;this.controller=controller;this.contentTrackingTimer=null;this.contentComplete=false;this.updateTimeIntervalHandle=null;this.updateTimeInterval=1e3;this.seekCheckIntervalHandle=null;this.seekCheckInterval=1e3;this.resizeCheckIntervalHandle=null;this.resizeCheckInterval=250;this.seekThreshold=100;this.contentEndedListeners=[];this.contentSource="";this.contentSourceType="";this.contentPlayheadTracker={currentTime:0,previousTime:0,seeking:false,duration:0};this.vjsPlayerDimensions={width:this.getPlayerWidth(),height:this.getPlayerHeight()};this.vjsControls=this.vjsPlayer.getChild("controlBar");this.h5Player=null;this.vjsPlayer.one("play",this.setUpPlayerIntervals.bind(this));this.boundContentEndedListener=this.localContentEndedListener.bind(this);this.vjsPlayer.on("contentended",this.boundContentEndedListener);this.vjsPlayer.on("dispose",this.playerDisposedListener.bind(this));this.vjsPlayer.on("readyforpreroll",this.onReadyForPreroll.bind(this));this.vjsPlayer.ready(this.onPlayerReady.bind(this));this.vjsPlayer.ads(adsPluginSettings)};PlayerWrapper.prototype.setUpPlayerIntervals=function(){this.updateTimeIntervalHandle=setInterval(this.updateCurrentTime.bind(this),this.updateTimeInterval);this.seekCheckIntervalHandle=setInterval(this.checkForSeeking.bind(this),this.seekCheckInterval);this.resizeCheckIntervalHandle=setInterval(this.checkForResize.bind(this),this.resizeCheckInterval)};PlayerWrapper.prototype.updateCurrentTime=function(){if(!this.contentPlayheadTracker.seeking){this.contentPlayheadTracker.currentTime=this.vjsPlayer.currentTime()}};PlayerWrapper.prototype.checkForSeeking=function(){var tempCurrentTime=this.vjsPlayer.currentTime();var diff=(tempCurrentTime-this.contentPlayheadTracker.previousTime)*1e3;if(Math.abs(diff)>this.seekCheckInterval+this.seekThreshold){this.contentPlayheadTracker.seeking=true}else{this.contentPlayheadTracker.seeking=false}this.contentPlayheadTracker.previousTime=this.vjsPlayer.currentTime()};PlayerWrapper.prototype.checkForResize=function(){var currentWidth=this.getPlayerWidth();var currentHeight=this.getPlayerHeight();if(currentWidth!=this.vjsPlayerDimensions.width||currentHeight!=this.vjsPlayerDimensions.height){this.vjsPlayerDimensions.width=currentWidth;this.vjsPlayerDimensions.height=currentHeight;this.controller.onPlayerResize(currentWidth,currentHeight)}};PlayerWrapper.prototype.localContentEndedListener=function(){if(!this.contentComplete){this.contentComplete=true;this.controller.onContentComplete()}for(var index in this.contentEndedListeners){if(typeof this.contentEndedListeners[index]==="function"){this.contentEndedListeners[index]()}}clearInterval(this.updateTimeIntervalHandle);clearInterval(this.seekCheckIntervalHandle);clearInterval(this.resizeCheckIntervalHandle);if(this.vjsPlayer.el()){this.vjsPlayer.one("play",this.setUpPlayerIntervals.bind(this))}};PlayerWrapper.prototype.onNoPostroll=function(){this.vjsPlayer.trigger("nopostroll")};PlayerWrapper.prototype.playerDisposedListener=function(){this.contentEndedListeners=[];this.controller.onPlayerDisposed();this.contentComplete=true;this.vjsPlayer.off("contentended",this.boundContentEndedListener);if(this.vjsPlayer.ads.adTimeoutTimeout){clearTimeout(this.vjsPlayer.ads.adTimeoutTimeout)}var intervalsToClear=[this.updateTimeIntervalHandle,this.seekCheckIntervalHandle,this.resizeCheckIntervalHandle];for(var index in intervalsToClear){if(intervalsToClear[index]){clearInterval(intervalsToClear[index])}}};PlayerWrapper.prototype.onReadyForPreroll=function(){var cuePoints=this.controller.getAdsManager().getCuePoints();if(cuePoints.length===0||!cuePoints.includes(0)){this.onNoPreroll()}this.controller.onPlayerReadyForPreroll()};PlayerWrapper.prototype.onPlayerReady=function(){this.h5Player=document.getElementById(this.getPlayerId()).getElementsByClassName("vjs-tech")[0];if(this.h5Player.hasAttribute("autoplay")){this.controller.setSetting("adWillAutoPlay",true)}this.onVolumeChange();this.vjsPlayer.on("fullscreenchange",this.onFullscreenChange.bind(this));this.vjsPlayer.on("volumechange",this.onVolumeChange.bind(this));this.controller.onPlayerReady()};PlayerWrapper.prototype.onFullscreenChange=function(){if(this.vjsPlayer.isFullscreen()){this.controller.onPlayerEnterFullscreen()}else{this.controller.onPlayerExitFullscreen()}};PlayerWrapper.prototype.onVolumeChange=function(){var newVolume=this.vjsPlayer.muted()?0:this.vjsPlayer.volume();this.controller.onPlayerVolumeChanged(newVolume)};PlayerWrapper.prototype.injectAdContainerDiv=function(adContainerDiv){this.vjsControls.el().parentNode.appendChild(adContainerDiv)};PlayerWrapper.prototype.getContentPlayer=function(){return this.h5Player};PlayerWrapper.prototype.getVolume=function(){return this.vjsPlayer.muted()?0:this.vjsPlayer.volume()};PlayerWrapper.prototype.setVolume=function(volume){this.vjsPlayer.volume(volume);if(volume==0){this.vjsPlayer.muted(true)}else{this.vjsPlayer.muted(false)}};PlayerWrapper.prototype.unmute=function(){this.vjsPlayer.muted(false)};PlayerWrapper.prototype.mute=function(){this.vjsPlayer.muted(true)};PlayerWrapper.prototype.play=function(){this.vjsPlayer.play()};PlayerWrapper.prototype.getPlayerWidth=function(){var width=(getComputedStyle(this.vjsPlayer.el())||{}).width;if(!width||parseInt(width,10)===0){width=(this.vjsPlayer.el().getBoundingClientRect()||{}).width}return parseInt(width,10)||this.vjsPlayer.width()};PlayerWrapper.prototype.getPlayerHeight=function(){var height=(getComputedStyle(this.vjsPlayer.el())||{}).height;if(!height||parseInt(height,10)===0){height=(this.vjsPlayer.el().getBoundingClientRect()||{}).height}return parseInt(height,10)||this.vjsPlayer.height()};PlayerWrapper.prototype.getPlayerOptions=function(){return this.vjsPlayer.options_};PlayerWrapper.prototype.getPlayerId=function(){return this.vjsPlayer.id()};PlayerWrapper.prototype.toggleFullscreen=function(){if(this.vjsPlayer.isFullscreen()){this.vjsPlayer.exitFullscreen()}else{this.vjsPlayer.requestFullscreen()}};PlayerWrapper.prototype.getContentPlayheadTracker=function(){return this.contentPlayheadTracker};PlayerWrapper.prototype.onAdError=function(adErrorEvent){this.vjsControls.show();var errorMessage=adErrorEvent.getError!==undefined?adErrorEvent.getError():adErrorEvent.stack;this.vjsPlayer.trigger({type:"adserror",data:{AdError:errorMessage,AdErrorEvent:adErrorEvent}})};PlayerWrapper.prototype.onAdLog=function(adEvent){var adData=adEvent.getAdData();var errorMessage=adData["adError"]!==undefined?adData["adError"].getMessage():undefined;this.vjsPlayer.trigger({type:"adslog",data:{AdError:errorMessage,AdEvent:adEvent}})};PlayerWrapper.prototype.onAdBreakStart=function(){this.contentSource=this.vjsPlayer.currentSrc();this.contentSourceType=this.vjsPlayer.currentType();this.vjsPlayer.off("contentended",this.boundContentEndedListener);this.vjsPlayer.ads.startLinearAdMode();this.vjsControls.hide();this.vjsPlayer.pause()};PlayerWrapper.prototype.onAdBreakEnd=function(){this.vjsPlayer.on("contentended",this.boundContentEndedListener);if(this.vjsPlayer.ads.inAdBreak()){this.vjsPlayer.ads.endLinearAdMode()}this.vjsControls.show()};PlayerWrapper.prototype.onAdStart=function(){this.vjsPlayer.trigger("ads-ad-started")};PlayerWrapper.prototype.onAllAdsCompleted=function(){if(this.contentComplete==true){this.controller.onContentAndAdsCompleted()}};PlayerWrapper.prototype.onAdsReady=function(){this.vjsPlayer.trigger("adsready")};PlayerWrapper.prototype.onNoPreroll=function(){this.vjsPlayer.trigger("nopreroll")};PlayerWrapper.prototype.changeSource=function(contentSrc){if(this.vjsPlayer.currentSrc()){this.vjsPlayer.currentTime(0);this.vjsPlayer.pause()}if(contentSrc){this.vjsPlayer.src(contentSrc)}this.vjsPlayer.one("loadedmetadata",this.seekContentToZero.bind(this))};PlayerWrapper.prototype.seekContentToZero=function(){this.vjsPlayer.currentTime(0)};PlayerWrapper.prototype.triggerPlayerEvent=function(name,data){this.vjsPlayer.trigger(name,data)};PlayerWrapper.prototype.addContentEndedListener=function(listener){this.contentEndedListeners.push(listener)};PlayerWrapper.prototype.reset=function(){this.vjsPlayer.on("contentended",this.boundContentEndedListener);this.vjsControls.show();if(this.vjsPlayer.ads.inAdBreak()){this.vjsPlayer.ads.endLinearAdMode()}this.contentPlayheadTracker.currentTime=0;this.contentComplete=false};var AdUi=function AdUi(controller){this.controller=controller;this.adContainerDiv=document.createElement("div");this.controlsDiv=document.createElement("div");this.countdownDiv=document.createElement("div");this.seekBarDiv=document.createElement("div");this.progressDiv=document.createElement("div");this.playPauseDiv=document.createElement("div");this.muteDiv=document.createElement("div");this.sliderDiv=document.createElement("div");this.sliderLevelDiv=document.createElement("div");this.fullscreenDiv=document.createElement("div");this.boundOnMouseUp=this.onMouseUp.bind(this);this.boundOnMouseMove=this.onMouseMove.bind(this);this.adPlayheadTracker={currentTime:0,duration:0,isPod:false,adPosition:0,totalAds:0};this.controlPrefix=this.controller.getPlayerId()+"_";this.showCountdown=true;if(this.controller.getSettings().showCountdown===false){this.showCountdown=false}this.createAdContainer()};AdUi.prototype.createAdContainer=function(){this.assignControlAttributes(this.adContainerDiv,"ima-ad-container");this.adContainerDiv.style.position="absolute";this.adContainerDiv.style.zIndex=1111;this.adContainerDiv.addEventListener("mouseenter",this.showAdControls.bind(this),false);this.adContainerDiv.addEventListener("mouseleave",this.hideAdControls.bind(this),false);this.createControls();this.controller.injectAdContainerDiv(this.adContainerDiv)};AdUi.prototype.createControls=function(){this.assignControlAttributes(this.controlsDiv,"ima-controls-div");this.controlsDiv.style.width="100%";this.assignControlAttributes(this.countdownDiv,"ima-countdown-div");this.countdownDiv.innerHTML=this.controller.getSettings().adLabel;this.countdownDiv.style.display=this.showCountdown?"block":"none";this.assignControlAttributes(this.seekBarDiv,"ima-seek-bar-div");this.seekBarDiv.style.width="100%";this.assignControlAttributes(this.progressDiv,"ima-progress-div");this.assignControlAttributes(this.playPauseDiv,"ima-play-pause-div");this.addClass(this.playPauseDiv,"ima-playing");this.playPauseDiv.addEventListener("click",this.onAdPlayPauseClick.bind(this),false);this.assignControlAttributes(this.muteDiv,"ima-mute-div");this.addClass(this.muteDiv,"ima-non-muted");this.muteDiv.addEventListener("click",this.onAdMuteClick.bind(this),false);this.assignControlAttributes(this.sliderDiv,"ima-slider-div");this.sliderDiv.addEventListener("mousedown",this.onAdVolumeSliderMouseDown.bind(this),false);if(this.controller.getIsIos()){this.sliderDiv.style.display="none"}this.assignControlAttributes(this.sliderLevelDiv,"ima-slider-level-div");this.assignControlAttributes(this.fullscreenDiv,"ima-fullscreen-div");this.addClass(this.fullscreenDiv,"ima-non-fullscreen");this.fullscreenDiv.addEventListener("click",this.onAdFullscreenClick.bind(this),false);this.adContainerDiv.appendChild(this.controlsDiv);this.controlsDiv.appendChild(this.countdownDiv);this.controlsDiv.appendChild(this.seekBarDiv);this.controlsDiv.appendChild(this.playPauseDiv);this.controlsDiv.appendChild(this.muteDiv);this.controlsDiv.appendChild(this.sliderDiv);this.controlsDiv.appendChild(this.fullscreenDiv);this.seekBarDiv.appendChild(this.progressDiv);this.sliderDiv.appendChild(this.sliderLevelDiv)};AdUi.prototype.onAdPlayPauseClick=function(){this.controller.onAdPlayPauseClick()};AdUi.prototype.onAdMuteClick=function(){this.controller.onAdMuteClick()};AdUi.prototype.onAdFullscreenClick=function(){this.controller.toggleFullscreen()};AdUi.prototype.onAdsPaused=function(){this.addClass(this.playPauseDiv,"ima-paused");this.removeClass(this.playPauseDiv,"ima-playing");this.showAdControls()};AdUi.prototype.onAdsResumed=function(){this.onAdsPlaying();this.showAdControls()};AdUi.prototype.onAdsPlaying=function(){this.addClass(this.playPauseDiv,"ima-playing");this.removeClass(this.playPauseDiv,"ima-paused")};AdUi.prototype.updateAdUi=function(currentTime,remainingTime,duration,adPosition,totalAds){var remainingMinutes=Math.floor(remainingTime/60);var remainingSeconds=Math.floor(remainingTime%60);if(remainingSeconds.toString().length<2){remainingSeconds="0"+remainingSeconds}var podCount=": ";if(totalAds>1){podCount=" ("+adPosition+" "+this.controller.getSettings().adLabelNofN+" "+totalAds+"): "}this.countdownDiv.innerHTML=this.controller.getSettings().adLabel+podCount+remainingMinutes+":"+remainingSeconds;var playProgressRatio=currentTime/duration;var playProgressPercent=playProgressRatio*100;this.progressDiv.style.width=playProgressPercent+"%"};AdUi.prototype.unmute=function(){this.addClass(this.muteDiv,"ima-non-muted");this.removeClass(this.muteDiv,"ima-muted");this.sliderLevelDiv.style.width=this.controller.getPlayerVolume()*100+"%"};AdUi.prototype.mute=function(){this.addClass(this.muteDiv,"ima-muted");this.removeClass(this.muteDiv,"ima-non-muted");this.sliderLevelDiv.style.width="0%"};AdUi.prototype.onAdVolumeSliderMouseDown=function(){document.addEventListener("mouseup",this.boundOnMouseUp,false);document.addEventListener("mousemove",this.boundOnMouseMove,false)};AdUi.prototype.onMouseMove=function(event){this.changeVolume(event)};AdUi.prototype.onMouseUp=function(event){this.changeVolume(event);document.removeEventListener("mouseup",this.boundOnMouseUp);document.removeEventListener("mousemove",this.boundOnMouseMove)};AdUi.prototype.changeVolume=function(event){var percent=(event.clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth;percent*=100;percent=Math.min(Math.max(percent,0),100);this.sliderLevelDiv.style.width=percent+"%";if(this.percent==0){this.addClass(this.muteDiv,"ima-muted");this.removeClass(this.muteDiv,"ima-non-muted")}else{this.addClass(this.muteDiv,"ima-non-muted");this.removeClass(this.muteDiv,"ima-muted")}this.controller.setVolume(percent/100)};AdUi.prototype.showAdContainer=function(){this.adContainerDiv.style.display="block"};AdUi.prototype.hideAdContainer=function(){this.adContainerDiv.style.display="none"};AdUi.prototype.reset=function(){this.hideAdContainer()};AdUi.prototype.onAdError=function(){this.hideAdContainer()};AdUi.prototype.onAdBreakStart=function(adEvent){this.showAdContainer();var contentType=adEvent.getAd().getContentType();if(contentType==="application/javascript"&&!this.controller.getSettings().showControlsForJSAds){this.controlsDiv.style.display="none"}else{this.controlsDiv.style.display="block"}this.onAdsPlaying();this.hideAdControls()};AdUi.prototype.onAdBreakEnd=function(){var currentAd=this.controller.getCurrentAd();if(currentAd==null||currentAd.isLinear()){this.hideAdContainer()}this.controlsDiv.style.display="none";this.countdownDiv.innerHTML=""};AdUi.prototype.onAllAdsCompleted=function(){this.hideAdContainer()};AdUi.prototype.onLinearAdStart=function(){this.removeClass(this.adContainerDiv,"bumpable-ima-ad-container")};AdUi.prototype.onNonLinearAdLoad=function(){this.adContainerDiv.style.display="block";this.addClass(this.adContainerDiv,"bumpable-ima-ad-container")};AdUi.prototype.onPlayerEnterFullscreen=function(){this.addClass(this.fullscreenDiv,"ima-fullscreen");this.removeClass(this.fullscreenDiv,"ima-non-fullscreen")};AdUi.prototype.onPlayerExitFullscreen=function(){this.addClass(this.fullscreenDiv,"ima-non-fullscreen");this.removeClass(this.fullscreenDiv,"ima-fullscreen")};AdUi.prototype.onPlayerVolumeChanged=function(volume){if(volume==0){this.addClass(this.muteDiv,"ima-muted");this.removeClass(this.muteDiv,"ima-non-muted");this.sliderLevelDiv.style.width="0%"}else{this.addClass(this.muteDiv,"ima-non-muted");this.removeClass(this.muteDiv,"ima-muted");this.sliderLevelDiv.style.width=volume*100+"%"}};AdUi.prototype.showAdControls=function(){this.addClass(this.controlsDiv,"ima-controls-div-showing");this.playPauseDiv.style.display="block";this.muteDiv.style.display="block";this.fullscreenDiv.style.display="block";if(!this.controller.getIsIos()){this.sliderDiv.style.display="block"}};AdUi.prototype.hideAdControls=function(){this.removeClass(this.controlsDiv,"ima-controls-div-showing");this.playPauseDiv.style.display="none";this.muteDiv.style.display="none";this.sliderDiv.style.display="none";this.fullscreenDiv.style.display="none"};AdUi.prototype.assignControlAttributes=function(element,controlName){element.id=this.controlPrefix+controlName;element.className=this.controlPrefix+controlName+" "+controlName};AdUi.prototype.getClassRegexp=function(className){return new RegExp("(^|[^A-Za-z-])"+className+"((?![A-Za-z-])|$)","gi")};AdUi.prototype.elementHasClass=function(element,className){var classRegexp=this.getClassRegexp(className);return classRegexp.test(element.className)};AdUi.prototype.addClass=function(element,classToAdd){element.className=element.className.trim()+" "+classToAdd};AdUi.prototype.removeClass=function(element,classToRemove){var classRegexp=this.getClassRegexp(classToRemove);element.className=element.className.trim().replace(classRegexp,"")};AdUi.prototype.getAdContainerDiv=function(){return this.adContainerDiv};AdUi.prototype.setShowCountdown=function(showCountdownIn){this.showCountdown=showCountdownIn;this.countdownDiv.style.display=this.showCountdown?"block":"none"};var name="@castlabs/videojs-ima";var version="1.6.0";var license="Apache-2.0";var main="./dist/videojs.ima.js";var module$1="./dist/videojs.ima.es.js";var author={name:"Google Inc."};var engines={node:">=0.8.0"};var scripts={contBuild:"watch 'npm run rollup:max' src",predevServer:'echo "Starting up server on localhost:8000."',devServer:"npm-run-all -p testServer contBuild",lint:'eslint "src/*.js"',rollup:"npm-run-all rollup:*","rollup:max":"rollup -c configs/rollup.config.js","rollup:es":"rollup -c configs/rollup.config.es.js","rollup:min":"rollup -c configs/rollup.config.min.js",pretest:"npm run rollup",start:"npm run devServer",test:"npm-run-all test:*","test:vjs5":"npm install video.js@5.19.2 --no-save && npm-run-all -p -r testServer webdriver","test:vjs6":"npm install video.js@6 --no-save && npm-run-all -p -r testServer webdriver","test:vjs7":"npm install video.js@7 --no-save && npm-run-all -p -r testServer webdriver",testServer:"http-server --cors -p 8000 --silent",preversion:"node scripts/preversion.js && npm run lint && npm test",version:"node scripts/version.js",postversion:"node scripts/postversion.js",webdriver:"mocha test/webdriver/*.js --no-timeouts"};var repository={type:"git",url:"https://github.com/googleads/videojs-ima"};var files=["CHANGELOG.md","LICENSE","README.md","dist/","src/"];var dependencies={"can-autoplay":"^3.0.0",cryptiles:"^4.1.2","video.js":"^5.19.2 || ^6 || ^7","videojs-contrib-ads":"^6"};var devDependencies={"babel-core":"^6.26.3","babel-preset-env":"^1.7.0",child_process:"^1.0.2",chromedriver:"^2.35.0","conventional-changelog-cli":"^2.0.21","conventional-changelog-videojs":"^3.0.0",eslint:"^4.11.0","eslint-config-google":"^0.9.1","eslint-plugin-jsdoc":"^3.2.0",geckodriver:"^1.16.2","http-server":"^0.10.0",mocha:"^5.0.3","npm-run-all":"^4.1.2",path:"^0.12.7",rimraf:"^2.6.2",rollup:"^0.51.8","rollup-plugin-babel":"^3.0.3","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-uglify":"^2.0.1","selenium-webdriver":"^3.6.0","uglify-es":"^3.1.10",watch:"^1.0.2"};var keywords=["videojs","videojs-plugin"];var pkg={name:name,version:version,license:license,main:main,module:module$1,author:author,engines:engines,scripts:scripts,repository:repository,files:files,dependencies:dependencies,devDependencies:devDependencies,keywords:keywords};var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var SdkImpl=function SdkImpl(controller){this.controller=controller;this.adDisplayContainer=null;this.adDisplayContainerInitialized=false;this.adsLoader=null;this.adsManager=null;this.adsRenderingSettings=null;this.adsResponse=null;this.currentAd=null;this.adTrackingTimer=null;this.allAdsCompleted=false;this.adsActive=false;this.adPlaying=false;this.adMuted=false;this.adBreakReadyListener=undefined;this.contentCompleteCalled=false;this.adsManagerDimensions={width:0,height:0};this.autoPlayAdBreaks=true;if(this.controller.getSettings().autoPlayAdBreaks===false){this.autoPlayAdBreaks=false}if(this.controller.getSettings().locale){google.ima.settings.setLocale(this.controller.getSettings().locale)}if(this.controller.getSettings().disableFlashAds){google.ima.settings.setDisableFlashAds(this.controller.getSettings().disableFlashAds)}if(this.controller.getSettings().disableCustomPlaybackForIOS10Plus){google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.controller.getSettings().disableCustomPlaybackForIOS10Plus)}};SdkImpl.prototype.initAdObjects=function(){this.adDisplayContainer=new google.ima.AdDisplayContainer(this.controller.getAdContainerDiv(),this.controller.getContentPlayer());this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer);this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);
if(this.controller.getSettings().vpaidAllowed==false){this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED)}if(this.controller.getSettings().vpaidMode){this.adsLoader.getSettings().setVpaidMode(this.controller.getSettings().vpaidMode)}if(this.controller.getSettings().locale){this.adsLoader.getSettings().setLocale(this.controller.getSettings().locale)}if(this.controller.getSettings().numRedirects){this.adsLoader.getSettings().setNumRedirects(this.controller.getSettings().numRedirects)}this.adsLoader.getSettings().setPlayerType("videojs-ima");this.adsLoader.getSettings().setPlayerVersion(pkg.version);this.adsLoader.getSettings().setAutoPlayAdBreaks(this.autoPlayAdBreaks);this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),false);this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsLoaderError.bind(this),false)};SdkImpl.prototype.requestAds=function(){var adsRequest=new google.ima.AdsRequest;if(this.controller.getSettings().adTagUrl){adsRequest.adTagUrl=this.controller.getSettings().adTagUrl}else{adsRequest.adsResponse=this.controller.getSettings().adsResponse}if(this.controller.getSettings().forceNonLinearFullSlot){adsRequest.forceNonLinearFullSlot=true}if(this.controller.getSettings().vastLoadTimeout){adsRequest.vastLoadTimeout=this.controller.getSettings().vastLoadTimeout}adsRequest.linearAdSlotWidth=this.controller.getPlayerWidth();adsRequest.linearAdSlotHeight=this.controller.getPlayerHeight();adsRequest.nonLinearAdSlotWidth=this.controller.getSettings().nonLinearWidth||this.controller.getPlayerWidth();adsRequest.nonLinearAdSlotHeight=this.controller.getSettings().nonLinearHeight||this.controller.getPlayerHeight();adsRequest.setAdWillAutoPlay(this.controller.adsWillAutoplay());adsRequest.setAdWillPlayMuted(this.controller.adsWillPlayMuted());var providedAdsRequest=this.controller.getSettings().adsRequest;if(providedAdsRequest&&(typeof providedAdsRequest==="undefined"?"undefined":_typeof(providedAdsRequest))==="object"){Object.keys(providedAdsRequest).forEach(function(key){adsRequest[key]=providedAdsRequest[key]})}this.adsLoader.requestAds(adsRequest);this.controller.triggerPlayerEvent("ads-request",adsRequest)};SdkImpl.prototype.onAdsManagerLoaded=function(adsManagerLoadedEvent){this.createAdsRenderingSettings();this.adsManager=adsManagerLoadedEvent.getAdsManager(this.controller.getContentPlayheadTracker(),this.adsRenderingSettings);this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,this.onAdBreakReady.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,this.onAdPaused.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdComplete.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onAdLog.bind(this));if(this.controller.getIsMobile()){this.adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onAdPaused.bind(this));this.adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onAdResumed.bind(this))}if(!this.autoPlayAdBreaks){this.initAdsManager()}this.controller.onAdsReady();if(this.controller.getSettings().adsManagerLoadedCallback){this.controller.getSettings().adsManagerLoadedCallback()}};SdkImpl.prototype.onAdsLoaderError=function(event){window.console.warn("AdsLoader error: "+event.getError());this.controller.onErrorLoadingAds(event);if(this.adsManager){this.adsManager.destroy()}};SdkImpl.prototype.initAdsManager=function(){try{var initWidth=this.controller.getPlayerWidth();var initHeight=this.controller.getPlayerHeight();this.adsManagerDimensions.width=initWidth;this.adsManagerDimensions.height=initHeight;this.adsManager.init(initWidth,initHeight,google.ima.ViewMode.NORMAL);this.adsManager.setVolume(this.controller.getPlayerVolume());this.initializeAdDisplayContainer()}catch(adError){this.onAdError(adError)}};SdkImpl.prototype.createAdsRenderingSettings=function(){this.adsRenderingSettings=new google.ima.AdsRenderingSettings;this.adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete=true;if(this.controller.getSettings().adsRenderingSettings){for(var setting in this.controller.getSettings().adsRenderingSettings){if(setting!==""){this.adsRenderingSettings[setting]=this.controller.getSettings().adsRenderingSettings[setting]}}}};SdkImpl.prototype.onAdError=function(adErrorEvent){var errorMessage=adErrorEvent.getError!==undefined?adErrorEvent.getError():adErrorEvent.stack;window.console.warn("Ad error: "+errorMessage);this.adsManager.destroy();this.controller.onAdError(adErrorEvent);this.adsActive=false;this.adPlaying=false};SdkImpl.prototype.onAdBreakReady=function(adEvent){this.adBreakReadyListener(adEvent)};SdkImpl.prototype.onContentPauseRequested=function(adEvent){this.adsActive=true;this.adPlaying=true;this.controller.onAdBreakStart(adEvent)};SdkImpl.prototype.onContentResumeRequested=function(adEvent){this.adsActive=false;this.adPlaying=false;this.controller.onAdBreakEnd()};SdkImpl.prototype.onAllAdsCompleted=function(adEvent){this.allAdsCompleted=true;this.controller.onAllAdsCompleted()};SdkImpl.prototype.onAdLoaded=function(adEvent){if(!adEvent.getAd().isLinear()){this.controller.onNonLinearAdLoad();this.controller.playContent()}};SdkImpl.prototype.onAdStarted=function(adEvent){this.currentAd=adEvent.getAd();if(this.currentAd.isLinear()){this.adTrackingTimer=setInterval(this.onAdPlayheadTrackerInterval.bind(this),250);this.controller.onLinearAdStart()}else{this.controller.onNonLinearAdStart()}};SdkImpl.prototype.onAdPaused=function(){this.controller.onAdsPaused()};SdkImpl.prototype.onAdResumed=function(adEvent){this.controller.onAdsResumed()};SdkImpl.prototype.onAdComplete=function(){if(this.currentAd.isLinear()){clearInterval(this.adTrackingTimer)}};SdkImpl.prototype.onAdLog=function(adEvent){this.controller.onAdLog(adEvent)};SdkImpl.prototype.onAdPlayheadTrackerInterval=function(){var remainingTime=this.adsManager.getRemainingTime();var duration=this.currentAd.getDuration();var currentTime=duration-remainingTime;currentTime=currentTime>0?currentTime:0;var totalAds=0;var adPosition=void 0;if(this.currentAd.getAdPodInfo()){adPosition=this.currentAd.getAdPodInfo().getAdPosition();totalAds=this.currentAd.getAdPodInfo().getTotalAds()}this.controller.onAdPlayheadUpdated(currentTime,remainingTime,duration,adPosition,totalAds)};SdkImpl.prototype.onContentComplete=function(){if(this.adsLoader){this.adsLoader.contentComplete();this.contentCompleteCalled=true}if(this.adsManager&&this.adsManager.getCuePoints()&&!this.adsManager.getCuePoints().includes(-1)){this.controller.onNoPostroll()}if(this.allAdsCompleted){this.controller.onContentAndAdsCompleted()}};SdkImpl.prototype.onPlayerDisposed=function(){if(this.adTrackingTimer){clearInterval(this.adTrackingTimer)}if(this.adsManager){this.adsManager.destroy();this.adsManager=null}};SdkImpl.prototype.onPlayerReadyForPreroll=function(){if(this.autoPlayAdBreaks){this.initAdsManager();try{this.controller.showAdContainer();this.adsManager.setVolume(this.controller.getPlayerVolume());this.adsManager.start()}catch(adError){this.onAdError(adError)}}};SdkImpl.prototype.onPlayerReady=function(){this.initAdObjects();if(this.controller.getSettings().adTagUrl||this.controller.getSettings().adsResponse){this.requestAds()}};SdkImpl.prototype.onPlayerEnterFullscreen=function(){if(this.adsManager){this.adsManager.resize(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN)}};SdkImpl.prototype.onPlayerExitFullscreen=function(){if(this.adsManager){this.adsManager.resize(this.controller.getPlayerWidth(),this.controller.getPlayerHeight(),google.ima.ViewMode.NORMAL)}};SdkImpl.prototype.onPlayerVolumeChanged=function(volume){if(this.adsManager){this.adsManager.setVolume(volume)}if(volume==0){this.adMuted=true}else{this.adMuted=false}};SdkImpl.prototype.onPlayerResize=function(width,height){if(this.adsManager){this.adsManagerDimensions.width=width;this.adsManagerDimensions.height=height;this.adsManager.resize(width,height,google.ima.ViewMode.NORMAL)}};SdkImpl.prototype.getCurrentAd=function(){return this.currentAd};SdkImpl.prototype.setAdBreakReadyListener=function(listener){this.adBreakReadyListener=listener};SdkImpl.prototype.isAdPlaying=function(){return this.adPlaying};SdkImpl.prototype.isAdMuted=function(){return this.adMuted};SdkImpl.prototype.pauseAds=function(){this.adsManager.pause();this.adPlaying=false};SdkImpl.prototype.resumeAds=function(){this.adsManager.resume();this.adPlaying=true};SdkImpl.prototype.unmute=function(){this.adsManager.setVolume(1);this.adMuted=false};SdkImpl.prototype.mute=function(){this.adsManager.setVolume(0);this.adMuted=true};SdkImpl.prototype.setVolume=function(volume){this.adsManager.setVolume(volume);if(volume==0){this.adMuted=true}else{this.adMuted=false}};SdkImpl.prototype.initializeAdDisplayContainer=function(){if(this.adDisplayContainer){if(!this.adDisplayContainerInitialized){this.adDisplayContainer.initialize();this.adDisplayContainerInitialized=true}}};SdkImpl.prototype.playAdBreak=function(){if(!this.autoPlayAdBreaks){this.controller.showAdContainer();this.adsManager.setVolume(this.controller.getPlayerVolume());this.adsManager.start()}};SdkImpl.prototype.addEventListener=function(event,callback){if(this.adsManager){this.adsManager.addEventListener(event,callback)}};SdkImpl.prototype.getAdsManager=function(){return this.adsManager};SdkImpl.prototype.reset=function(){this.adsActive=false;this.adPlaying=false;if(this.adTrackingTimer){clearInterval(this.adTrackingTimer)}if(this.adsManager){this.adsManager.destroy();this.adsManager=null}if(this.adsLoader&&!this.contentCompleteCalled){this.adsLoader.contentComplete()}this.contentCompleteCalled=false;this.allAdsCompleted=false};var Controller=function Controller(player,options){this.settings={};this.contentAndAdsEndedListeners=[];this.isMobile=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i);this.isIos=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i);this.initWithSettings(options);var contribAdsDefaults={debug:this.settings.debug,timeout:this.settings.timeout,prerollTimeout:this.settings.prerollTimeout};var adsPluginSettings=this.extend({},contribAdsDefaults,options.contribAdsSettings||{});this.playerWrapper=new PlayerWrapper(player,adsPluginSettings,this);this.adUi=new AdUi(this);this.sdkImpl=new SdkImpl(this)};Controller.IMA_DEFAULTS={debug:false,timeout:5e3,prerollTimeout:1e3,adLabel:"Advertisement",adLabelNofN:"of",showControlsForJSAds:true};Controller.prototype.initWithSettings=function(options){this.settings=this.extend({},Controller.IMA_DEFAULTS,options||{});this.warnAboutDeprecatedSettings();this.showCountdown=true;if(this.settings.showCountdown===false){this.showCountdown=false}};Controller.prototype.warnAboutDeprecatedSettings=function(){var _this=this;var deprecatedSettings=["adWillAutoplay","adsWillAutoplay","adWillPlayMuted","adsWillPlayMuted"];deprecatedSettings.forEach(function(setting){if(_this.settings[setting]!==undefined){console.warn("WARNING: videojs.ima setting "+setting+" is deprecated")}})};Controller.prototype.getSettings=function(){return this.settings};Controller.prototype.getIsMobile=function(){return this.isMobile};Controller.prototype.getIsIos=function(){return this.isIos};Controller.prototype.injectAdContainerDiv=function(adContainerDiv){this.playerWrapper.injectAdContainerDiv(adContainerDiv)};Controller.prototype.getAdContainerDiv=function(){return this.adUi.getAdContainerDiv()};Controller.prototype.getContentPlayer=function(){return this.playerWrapper.getContentPlayer()};Controller.prototype.getContentPlayheadTracker=function(){return this.playerWrapper.getContentPlayheadTracker()};Controller.prototype.requestAds=function(){this.sdkImpl.requestAds()};Controller.prototype.setSetting=function(key,value){this.settings[key]=value};Controller.prototype.onErrorLoadingAds=function(adErrorEvent){this.adUi.onAdError();this.playerWrapper.onAdError(adErrorEvent)};Controller.prototype.onAdPlayPauseClick=function(){if(this.sdkImpl.isAdPlaying()){this.adUi.onAdsPaused();this.sdkImpl.pauseAds()}else{this.adUi.onAdsPlaying();this.sdkImpl.resumeAds()}};Controller.prototype.onAdMuteClick=function(){if(this.sdkImpl.isAdMuted()){this.playerWrapper.unmute();this.adUi.unmute();this.sdkImpl.unmute()}else{this.playerWrapper.mute();this.adUi.mute();this.sdkImpl.mute()}};Controller.prototype.setVolume=function(volume){this.playerWrapper.setVolume(volume);this.sdkImpl.setVolume(volume)};Controller.prototype.getPlayerVolume=function(){return this.playerWrapper.getVolume()};Controller.prototype.toggleFullscreen=function(){this.playerWrapper.toggleFullscreen()};Controller.prototype.onAdError=function(adErrorEvent){this.adUi.onAdError();this.playerWrapper.onAdError(adErrorEvent)};Controller.prototype.onAdBreakStart=function(adEvent){this.playerWrapper.onAdBreakStart();this.adUi.onAdBreakStart(adEvent)};Controller.prototype.showAdContainer=function(){this.adUi.showAdContainer()};Controller.prototype.onAdBreakEnd=function(){this.playerWrapper.onAdBreakEnd();this.adUi.onAdBreakEnd()};Controller.prototype.onAllAdsCompleted=function(){this.adUi.onAllAdsCompleted();this.playerWrapper.onAllAdsCompleted()};Controller.prototype.onAdsPaused=function(){this.adUi.onAdsPaused()};Controller.prototype.onAdsResumed=function(){this.adUi.onAdsResumed()};Controller.prototype.onAdPlayheadUpdated=function(currentTime,remainingTime,duration,adPosition,totalAds){this.adUi.updateAdUi(currentTime,remainingTime,duration,adPosition,totalAds)};Controller.prototype.onAdLog=function(adEvent){this.playerWrapper.onAdLog(adEvent)};Controller.prototype.getCurrentAd=function(){return this.sdkImpl.getCurrentAd()};Controller.prototype.playContent=function(){this.playerWrapper.play()};Controller.prototype.onLinearAdStart=function(){this.adUi.onLinearAdStart();this.playerWrapper.onAdStart()};Controller.prototype.onNonLinearAdLoad=function(){this.adUi.onNonLinearAdLoad()};Controller.prototype.onNonLinearAdStart=function(){this.adUi.onNonLinearAdLoad();this.playerWrapper.onAdStart()};Controller.prototype.getPlayerWidth=function(){return this.playerWrapper.getPlayerWidth()};Controller.prototype.getPlayerHeight=function(){return this.playerWrapper.getPlayerHeight()};Controller.prototype.onAdsReady=function(){this.playerWrapper.onAdsReady()};Controller.prototype.onPlayerResize=function(width,height){this.sdkImpl.onPlayerResize(width,height)};Controller.prototype.onContentComplete=function(){this.sdkImpl.onContentComplete()};Controller.prototype.onNoPostroll=function(){this.playerWrapper.onNoPostroll()};Controller.prototype.onContentAndAdsCompleted=function(){for(var index in this.contentAndAdsEndedListeners){if(typeof this.contentAndAdsEndedListeners[index]==="function"){this.contentAndAdsEndedListeners[index]()}}};Controller.prototype.onPlayerDisposed=function(){this.contentAndAdsEndedListeners=[];this.sdkImpl.onPlayerDisposed()};Controller.prototype.onPlayerReadyForPreroll=function(){this.sdkImpl.onPlayerReadyForPreroll()};Controller.prototype.onPlayerReady=function(){this.sdkImpl.onPlayerReady()};Controller.prototype.onPlayerEnterFullscreen=function(){this.adUi.onPlayerEnterFullscreen();this.sdkImpl.onPlayerEnterFullscreen()};Controller.prototype.onPlayerExitFullscreen=function(){this.adUi.onPlayerExitFullscreen();this.sdkImpl.onPlayerExitFullscreen()};Controller.prototype.onPlayerVolumeChanged=function(volume){this.adUi.onPlayerVolumeChanged(volume);this.sdkImpl.onPlayerVolumeChanged(volume)};Controller.prototype.setContentWithAdTag=function(contentSrc,adTag){this.reset();this.settings.adTagUrl=adTag?adTag:this.settings.adTagUrl;this.playerWrapper.changeSource(contentSrc)};Controller.prototype.setContentWithAdsResponse=function(contentSrc,adsResponse){this.reset();this.settings.adsResponse=adsResponse?adsResponse:this.settings.adsResponse;this.playerWrapper.changeSource(contentSrc)};Controller.prototype.setContentWithAdsRequest=function(contentSrc,adsRequest){this.reset();this.settings.adsRequest=adsRequest?adsRequest:this.settings.adsRequest;this.playerWrapper.changeSource(contentSrc)};Controller.prototype.reset=function(){this.sdkImpl.reset();this.playerWrapper.reset();this.adUi.reset()};Controller.prototype.addContentEndedListener=function(listener){this.playerWrapper.addContentEndedListener(listener)};Controller.prototype.addContentAndAdsEndedListener=function(listener){this.contentAndAdsEndedListeners.push(listener)};Controller.prototype.setAdBreakReadyListener=function(listener){this.sdkImpl.setAdBreakReadyListener(listener)};Controller.prototype.setShowCountdown=function(showCountdownIn){this.adUi.setShowCountdown(showCountdownIn);this.showCountdown=showCountdownIn;this.countdownDiv.style.display=this.showCountdown?"block":"none"};Controller.prototype.initializeAdDisplayContainer=function(){this.sdkImpl.initializeAdDisplayContainer()};Controller.prototype.playAdBreak=function(){this.sdkImpl.playAdBreak()};Controller.prototype.addEventListener=function(event,callback){this.sdkImpl.addEventListener(event,callback)};Controller.prototype.getAdsManager=function(){return this.sdkImpl.getAdsManager()};Controller.prototype.getPlayerId=function(){return this.playerWrapper.getPlayerId()};Controller.prototype.changeAdTag=function(adTag){this.reset();this.settings.adTagUrl=adTag};Controller.prototype.pauseAd=function(){this.adUi.onAdsPaused();this.sdkImpl.pauseAds()};Controller.prototype.resumeAd=function(){this.adUi.onAdsPlaying();this.sdkImpl.resumeAds()};Controller.prototype.adsWillAutoplay=function(){if(this.settings.adsWillAutoplay!==undefined){return this.settings.adsWillAutoplay}else if(this.settings.adWillAutoplay!==undefined){return this.settings.adWillAutoplay}else{return!!this.playerWrapper.getPlayerOptions().autoplay}};Controller.prototype.adsWillPlayMuted=function(){if(this.settings.adsWillPlayMuted!==undefined){return this.settings.adsWillPlayMuted}else if(this.settings.adWillPlayMuted!==undefined){return this.settings.adWillPlayMuted}else if(this.playerWrapper.getPlayerOptions().muted!==undefined){return this.playerWrapper.getPlayerOptions().muted}else{return this.playerWrapper.getVolume()==0}};Controller.prototype.triggerPlayerEvent=function(name,data){this.playerWrapper.triggerPlayerEvent(name,data)};Controller.prototype.extend=function(obj){var arg=void 0;var index=void 0;var key=void 0;for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}for(index=0;index<args.length;index++){arg=args[index];for(key in arg){if(arg.hasOwnProperty(key)){obj[key]=arg[key]}}}return obj};var ImaPlugin=function ImaPlugin(player,options){this.controller=new Controller(player,options);this.addContentAndAdsEndedListener=function(listener){this.controller.addContentAndAdsEndedListener(listener)}.bind(this);this.addContentEndedListener=function(listener){this.controller.addContentEndedListener(listener)}.bind(this);this.addEventListener=function(event,callback){this.controller.addEventListener(event,callback)}.bind(this);this.changeAdTag=function(adTag){this.controller.changeAdTag(adTag)}.bind(this);this.getAdsManager=function(){return this.controller.getAdsManager()}.bind(this);this.initializeAdDisplayContainer=function(){this.controller.initializeAdDisplayContainer()}.bind(this);this.pauseAd=function(){this.controller.pauseAd()}.bind(this);this.playAdBreak=function(){this.controller.playAdBreak()}.bind(this);this.requestAds=function(){this.controller.requestAds()}.bind(this);this.resumeAd=function(){this.controller.resumeAd()}.bind(this);this.setAdBreakReadyListener=function(listener){this.controller.setAdBreakReadyListener(listener)}.bind(this);this.setContentWithAdTag=function(contentSrc,adTag){this.controller.setContentWithAdTag(contentSrc,adTag)}.bind(this);this.setContentWithAdsResponse=function(contentSrc,adsResponse){this.controller.setContentWithAdsResponse(contentSrc,adsResponse)}.bind(this);this.setContentWithAdsRequest=function(contentSrc,adsRequest){this.controller.setContentWithAdsRequest(contentSrc,adsRequest)}.bind(this);this.setShowCountdown=function(showCountdownIn){this.controller.setShowCountdown(showCountdownIn)}.bind(this)};var init=function init(options){this.ima=new ImaPlugin(this,options)};var registerPlugin=videojs.registerPlugin||videojs.plugin;registerPlugin("ima",init);return ImaPlugin})}).call(window)},47:function(module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["clpp_ima2"]=t():e["clpp_ima2"]=t()}(this,function(){return webpackJsonpclpp__name_([3],{0:function(e,t,i){var n=i(1),r=i(2),s=i(167);t.registerPlugin=function(e,t,i){this.cl_pd=new s(t,i),this.cl_pd.cl_Pi()},t.unregisterPlugin=function(){this.cl_pd.cl_X_()},n.definePlugin(r.plugins.clpp_ima2,t)},161:function(e,t){var i="crossorigin",n=function(e,t){this.cl_Ss=e.el_.querySelector("video"),this.cl__E=null,this.cl_dE=t};n.prototype.cl_hE=function(){this.cl_dE&&(this.cl__E=this.cl_Ss.getAttribute(i),this.cl_Ss.removeAttribute(i))},n.prototype.cl_fE=function(){this.cl_dE&&this.cl_Ss.setAttribute(i,this.cl__E)},e.exports=n},162:function(e,t){var i=function(e){this.cl_pE=e,this.cl_gE=this.cl_EE.bind(this)};i.prototype.cl_AE=function(){this.cl_mE("on")},i.prototype.cl_EE=function(e){var t=e.data.AdEvent.getAdData(),i=t&&t["adError"],n=i&&i.getErrorCode();1009===n&&this.cl_pE.ads.skipLinearAdMode()},i.prototype.cl_mE=function(e){this.cl_pE[e]("adslog",this.cl_gE)},i.prototype.cl_X_=function(){this.cl_mE("off")},e.exports=i},163:function(e,t,i){var n=i(4).Logger,r="ended",s=function(e,t){this.cl_Fn=new n(e+".patches.ended"),this.cl_pE=t,this.cl_yE=this.cl_pE.trigger,this.cl_SE=this.cl_ht.bind(this),this.cl_vE=!1};s.prototype.cl_AE=function(){this.cl_pE.trigger=this.cl_SE},s.prototype.cl_ht=function(e){return this.cl_vE&&e===r?void this.cl_Fn.debug("The `ended` event occurred. Skip triggering the event because an ad break is active."):void this.cl_yE.apply(this.cl_pE,arguments)},s.prototype.cl_hE=function(){this.cl_vE=!0},s.prototype.cl_fE=function(){this.cl_vE=!1,this.cl_pE.ended()&&this.cl_pE.trigger(r)},s.prototype.cl_X_=function(){this.cl_pE.trigger=this.cl_yE},e.exports=s},164:function(e,t){var i="clpp-preroll-ad-pod",n="clpp-ad-pod",r="clpp-single-video",s="play",o=function(e,t){this.cl_pE=e,this.cl_dE=t,this.cl_TE=this.cl_CE.bind(this),this.cl_bE=!1};o.prototype.cl_AE=function(){this.cl_dE&&this.cl_pE.addClass(r),this.cl_pE.one(s,this.cl_TE),this.cl_pE.addClass(i)},o.prototype.cl_IE=function(){this.cl_bE=!0,this.cl_pE.removeClass(i)},o.prototype.cl_hE=function(){this.cl_pE.addClass(n)},o.prototype.cl_fE=function(){this.cl_pE.removeClass(n)},o.prototype.cl_CE=function(){this.cl_bE||this.cl_pE.pause()},o.prototype.cl_X_=function(){this.cl_pE.off(s,this.cl_TE)},e.exports=o},165:function(e,t,i){var n=i(1),r=i(14),s=function(e){r.call(this),this.cl_pE=e,this.cl_RE=!1,this.cl_PE=!1,this.cl_NE=!1,this.cl_bE=!1,this.cl_LE=!1,this.cl_vE=!1,this.cl_DE=this.cl_OE.bind(this),this.cl_TE=this.cl_CE.bind(this),this.cl_wE=this.cl_kE.bind(this),this.cl_ME=this.cl_UE.bind(this),this.cl_xE=this.cl_FE.bind(this),this.cl_BE=this.cl_VE.bind(this),this.cl_YE=this.cl_hE.bind(this),this.cl_KE=this.cl_fE.bind(this)};s.prototype=new r,s.prototype.constructor=s,s.EVENTS={INIT:"init",CONTENT_START:"contentstart",CONTENT_END:"contentend",CONTENT_DETACH:"contentdetach",CONTENT_ATTACH:"contentattach"},s.prototype.cl_af=function(){this.cl_mE("on"),this.trigger(s.EVENTS.INIT)},s.prototype.cl_X_=function(){this.cl_mE("off")},s.prototype.cl_mE=function(e){this.cl_pE[e]("adsready",this.cl_DE),this.cl_pE[e]("adserror",this.cl_xE),this.cl_pE[e]("adtimeout",this.cl_xE),this.cl_pE[e]("adskip",this.cl_xE),this.cl_pE[e]("nopreroll",this.cl_wE),this.cl_pE[e]("play",this.cl_TE),this.cl_pE[e]("adend",this.cl_ME),this.cl_pE[e]("ended",this.cl_BE)},s.prototype.cl_OE=function(){var e=n.w.google.ima.AdEvent.Type;this.cl_pE.ima.addEventListener(e.CONTENT_PAUSE_REQUESTED,this.cl_YE),this.cl_pE.ima.addEventListener(e.CONTENT_RESUME_REQUESTED,this.cl_KE)},s.prototype.cl_CE=function(){this.cl_RE||(this.cl_RE=!0,(this.cl_NE||this.cl_PE)&&this.cl_IE())},s.prototype.cl_kE=function(){this.cl_NE||(this.cl_NE=!0,this.cl_RE&&this.cl_IE())},s.prototype.cl_UE=function(){this.cl_IE()},s.prototype.cl_FE=function(){this.cl_PE||(this.cl_PE=!0,this.cl_RE&&this.cl_IE())},s.prototype.cl_IE=function(){this.cl_bE||(this.cl_bE=!0,this.cl_LE=!1,this.trigger(s.EVENTS.CONTENT_START))},s.prototype.cl_VE=function(){this.cl_LE||this.cl_vE||(this.cl_LE=!0,this.cl_bE=!1,this.cl_RE=!1,this.cl_NE=!0,this.cl_PE=!1,this.trigger(s.EVENTS.CONTENT_END))},s.prototype.cl_hE=function(){this.cl_vE||(this.cl_vE=!0,this.trigger(s.EVENTS.CONTENT_DETACH))},s.prototype.cl_fE=function(){this.cl_vE&&(this.cl_vE=!1,this.trigger(s.EVENTS.CONTENT_ATTACH))},e.exports=s},166:function(e,t,i){var n=i(3).merge,r=i(4).Logger,s=i(14),o=i(165),a=i(161),c=i(164),u=i(162),l=i(170),_=i(169),d=i(163),h=i(168),f=s.EVENTS.ANALYTICS,p=s.EVENTS.ADS,g=1e4,E="clpp.player.plugins.ima",A=function(e,t,i,n,s){this.cl_Fn=new r(E),this.cl_pE=e,this.cl_GE=t,this.cl_kl=i,this.cl_Ft=n,this.cl_HE=new o(e),this.cl_dE=s,this.cl_jE=new a(e,s),this.cl_WE=new c(e,s),this.cl_QE=new u(e),this.cl_qE=new l(e),this.cl_zE=new _(e),s?this.cl_XE=new h:this.cl_XE=new d(E,e)};A.prototype.cl_JE={autoPlayAdBreaks:!0,adsRenderingSettings:{enablePreloading:!0,restoreCustomPlaybackStateOnAdBreakComplete:!1,loadVideoTimeout:g},contribAdsSettings:{timeout:g,prerollTimeout:g,postrollTimeout:g}},A.prototype.cl_af=function(){this.cl_pE.currentSources||(this.cl_pE.currentSources=function(){});var e=this.cl_kl>0?{adsRenderingSettings:{playAdsAfterTime:this.cl_kl},contribAdsSettings:{prerollTimeout:0}}:{};this.cl_pE.ima(n(this.cl_JE,this.cl_GE,e)),this.cl_Ft.trigger(f.IMA_READY,this.cl_pE.ima),this.cl_HE.on(o.EVENTS.INIT,this.cl_AE,this),this.cl_HE.on(o.EVENTS.CONTENT_START,this.cl_IE,this),this.cl_HE.on(o.EVENTS.CONTENT_END,this.cl_VE,this),this.cl_HE.on(o.EVENTS.CONTENT_ATTACH,this.cl_fE,this),this.cl_HE.on(o.EVENTS.CONTENT_DETACH,this.cl_hE,this),this.cl_HE.cl_af()},A.prototype.cl_AE=function(){this.cl_XE.cl_AE(),this.cl_WE.cl_AE(),this.cl_QE.cl_AE()},A.prototype.cl_IE=function(){this.cl_Fn.info("Content start"),this.cl_WE.cl_IE()},A.prototype.cl_VE=function(){this.cl_Fn.info("Content end")},A.prototype.cl_hE=function(){this.cl_Fn.info("Detaching content");var e=this.cl_pE.tech_,t=e.currentTime();this.cl_Ft.trigger(f.VIDEO_STOP),this.cl_pE.cl_oo=!0,this.cl_XE.cl_hE(),this.cl_jE.cl_hE(),this.cl_WE.cl_hE(),this.cl_qE.cl_hE(),this.cl_dE&&e.cl_Cr&&e.cl_Cr(),this.cl_Ft.trigger(p.CONTENT_DETACHED,{cl_pn:t})},A.prototype.cl_fE=function(){this.cl_Fn.info("Attaching content"),this.cl_jE.cl_fE(),this.cl_WE.cl_fE(),this.cl_qE.cl_fE();var e=this.cl_pE.tech_;this.cl_dE&&e.cl_ga?e.cl_ga().then(function(){this.cl_XE.cl_fE(),this.cl_zE.cl_fE(),this.cl_Ft.trigger(p.CONTENT_ATTACHED)}.bind(this)):(this.cl_XE.cl_fE(),this.cl_zE.cl_fE(),this.cl_Ft.trigger(p.CONTENT_ATTACHED)),this.cl_pE.cl_oo=!1},A.prototype.cl_X_=function(){this.cl_XE.cl_X_(),this.cl_QE.cl_X_(),this.cl_WE.cl_X_(),this.cl_HE.offAll(),this.cl_HE.cl_X_(),this.cl_pE.ima.controller.reset()},e.exports=A},167:function(e,t,i){var n=i(1),r=i(14),s=i(2),o=i(166),a=i(7),c=r.EVENTS.ANALYTICS,u=function(e,t){this.cl_ZE=e,this.cl_$E=e.types,this.cl_Ft=t,this.cl_eA=this.cl_tA.bind(this)};u.prototype.cl_Pi=function(){return n.w.google?(this.cl_ZE.addInterceptor(this.cl_$E.VJS_PLAYER_CREATED,this.cl_eA),void this.cl_Ft.on(c.FORCE_DESTROY,this.cl_iA,this)):(setTimeout(function(){this.cl_Ft.trigger(c.IMA_FAILED_AD_BLOCKER)}.bind(this),0),console.error("Google ima NOT loaded"))},u.prototype.cl_X_=function(){this.cl_ZE.removeInterceptor(this.cl_$E.VJS_PLAYER_CREATED,this.cl_eA),this.cl_Ft.off(c.FORCE_DESTROY,this.cl_iA,this),this.cl_iA()},u.prototype.cl_tA=function(e,t,i){this.cl_iA(),this.cl_nA(t,i,e.cl_Ft)},u.prototype.cl_nA=function(e,t,i){var n=a.isChromecast(),r=n?"chromecast":"plugins",c=(t[r]||{})[s.plugins.clpp_ima];c&&(this.cl_rA=new o(e,c,t.startTime,i,a.cl_Ie()||a.cl_Le()||n),this.cl_rA.cl_af())},u.prototype.cl_iA=function(){this.cl_rA&&(this.cl_rA.cl_X_(),this.cl_rA=null)},e.exports=u},168:function(e,t){var i=function(){},n=i;n.prototype.cl_AE=i,n.prototype.cl_hE=i,n.prototype.cl_fE=i,n.prototype.cl_X_=i,e.exports=n},169:function(e,t){var i=function(e){this.cl_pE=e};i.prototype.cl_fE=function(){var e=this.cl_pE;e.paused()&&!e.ended()&&e.play()},e.exports=i},170:function(e,t){var i="vjs-seeking",n=function(e){this.cl_pE=e,this.cl_sA=this.cl_Sh.bind(this)};n.prototype.cl_hE=function(){this.cl_pE.removeClass(i),this.cl_mE("on")},n.prototype.cl_fE=function(){this.cl_mE("off")},n.prototype.cl_mE=function(e){this.cl_pE[e]("seeking",this.cl_sA)},n.prototype.cl_Sh=function(){this.cl_pE.removeClass(i)},e.exports=n}})})}})});